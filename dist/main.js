(()=>{"use strict";var e={141:(e,t,n)=>{n.d(t,{Z:()=>a});var r=n(81),o=n.n(r),i=n(645),s=n.n(i)()(o());s.push([e.id,'/* Add space around the hr to make clicking it easier */\n\n.ProseMirror-example-setup-style hr {\n  padding: 2px 10px;\n  border: none;\n  margin: 1em 0;\n}\n\n.ProseMirror-example-setup-style hr:after {\n  content: "";\n  display: block;\n  height: 1px;\n  background-color: silver;\n  line-height: 2px;\n}\n\n.ProseMirror ul, .ProseMirror ol {\n  padding-left: 30px;\n}\n\n.ProseMirror blockquote {\n  padding-left: 1em;\n  border-left: 3px solid #eee;\n  margin-left: 0; margin-right: 0;\n}\n\n.ProseMirror-example-setup-style img {\n  cursor: default;\n}\n\n.ProseMirror-prompt {\n  background: white;\n  padding: 5px 10px 5px 15px;\n  border: 1px solid silver;\n  position: fixed;\n  border-radius: 3px;\n  z-index: 11;\n  box-shadow: -.5px 2px 5px rgba(0, 0, 0, .2);\n}\n\n.ProseMirror-prompt h5 {\n  margin: 0;\n  font-weight: normal;\n  font-size: 100%;\n  color: #444;\n}\n\n.ProseMirror-prompt input[type="text"],\n.ProseMirror-prompt textarea {\n  background: #eee;\n  border: none;\n  outline: none;\n}\n\n.ProseMirror-prompt input[type="text"] {\n  padding: 0 4px;\n}\n\n.ProseMirror-prompt-close {\n  position: absolute;\n  left: 2px; top: 1px;\n  color: #666;\n  border: none; background: transparent; padding: 0;\n}\n\n.ProseMirror-prompt-close:after {\n  content: "✕";\n  font-size: 12px;\n}\n\n.ProseMirror-invalid {\n  background: #ffc;\n  border: 1px solid #cc7;\n  border-radius: 4px;\n  padding: 5px 10px;\n  position: absolute;\n  min-width: 10em;\n}\n\n.ProseMirror-prompt-buttons {\n  margin-top: 5px;\n  display: none;\n}\n',""]);const a=s},210:(e,t,n)=>{n.d(t,{Z:()=>a});var r=n(81),o=n.n(r),i=n(645),s=n.n(i)()(o());s.push([e.id,'.ProseMirror-textblock-dropdown {\n  min-width: 3em;\n}\n\n.ProseMirror-menu {\n  margin: 0 -4px;\n  line-height: 1;\n}\n\n.ProseMirror-tooltip .ProseMirror-menu {\n  width: -webkit-fit-content;\n  width: fit-content;\n  white-space: pre;\n}\n\n.ProseMirror-menuitem {\n  margin-right: 3px;\n  display: inline-block;\n}\n\n.ProseMirror-menuseparator {\n  border-right: 1px solid #ddd;\n  margin-right: 3px;\n}\n\n.ProseMirror-menu-dropdown, .ProseMirror-menu-dropdown-menu {\n  font-size: 90%;\n  white-space: nowrap;\n}\n\n.ProseMirror-menu-dropdown {\n  vertical-align: 1px;\n  cursor: pointer;\n  position: relative;\n  padding-right: 15px;\n}\n\n.ProseMirror-menu-dropdown-wrap {\n  padding: 1px 0 1px 4px;\n  display: inline-block;\n  position: relative;\n}\n\n.ProseMirror-menu-dropdown:after {\n  content: "";\n  border-left: 4px solid transparent;\n  border-right: 4px solid transparent;\n  border-top: 4px solid currentColor;\n  opacity: .6;\n  position: absolute;\n  right: 4px;\n  top: calc(50% - 2px);\n}\n\n.ProseMirror-menu-dropdown-menu, .ProseMirror-menu-submenu {\n  position: absolute;\n  background: white;\n  color: #666;\n  border: 1px solid #aaa;\n  padding: 2px;\n}\n\n.ProseMirror-menu-dropdown-menu {\n  z-index: 15;\n  min-width: 6em;\n}\n\n.ProseMirror-menu-dropdown-item {\n  cursor: pointer;\n  padding: 2px 8px 2px 4px;\n}\n\n.ProseMirror-menu-dropdown-item:hover {\n  background: #f2f2f2;\n}\n\n.ProseMirror-menu-submenu-wrap {\n  position: relative;\n  margin-right: -4px;\n}\n\n.ProseMirror-menu-submenu-label:after {\n  content: "";\n  border-top: 4px solid transparent;\n  border-bottom: 4px solid transparent;\n  border-left: 4px solid currentColor;\n  opacity: .6;\n  position: absolute;\n  right: 4px;\n  top: calc(50% - 4px);\n}\n\n.ProseMirror-menu-submenu {\n  display: none;\n  min-width: 4em;\n  left: 100%;\n  top: -3px;\n}\n\n.ProseMirror-menu-active {\n  background: #eee;\n  border-radius: 4px;\n}\n\n.ProseMirror-menu-disabled {\n  opacity: .3;\n}\n\n.ProseMirror-menu-submenu-wrap:hover .ProseMirror-menu-submenu, .ProseMirror-menu-submenu-wrap-active .ProseMirror-menu-submenu {\n  display: block;\n}\n\n.ProseMirror-menubar {\n  border-top-left-radius: inherit;\n  border-top-right-radius: inherit;\n  position: relative;\n  min-height: 1em;\n  color: #666;\n  padding: 1px 6px;\n  top: 0; left: 0; right: 0;\n  border-bottom: 1px solid silver;\n  background: white;\n  z-index: 10;\n  -moz-box-sizing: border-box;\n  box-sizing: border-box;\n  overflow: visible;\n}\n\n.ProseMirror-icon {\n  display: inline-block;\n  line-height: .8;\n  vertical-align: -2px; /* Compensate for padding */\n  padding: 2px 8px;\n  cursor: pointer;\n}\n\n.ProseMirror-menu-disabled.ProseMirror-icon {\n  cursor: default;\n}\n\n.ProseMirror-icon svg {\n  fill: currentColor;\n  height: 1em;\n}\n\n.ProseMirror-icon span {\n  vertical-align: text-top;\n}\n',""]);const a=s},363:(e,t,n)=>{n.d(t,{Z:()=>a});var r=n(81),o=n.n(r),i=n(645),s=n.n(i)()(o());s.push([e.id,'.ProseMirror {\n  position: relative;\n}\n\n.ProseMirror {\n  word-wrap: break-word;\n  white-space: pre-wrap;\n  white-space: break-spaces;\n  -webkit-font-variant-ligatures: none;\n  font-variant-ligatures: none;\n  font-feature-settings: "liga" 0; /* the above doesn\'t seem to work in Edge */\n}\n\n.ProseMirror pre {\n  white-space: pre-wrap;\n}\n\n.ProseMirror li {\n  position: relative;\n}\n\n.ProseMirror-hideselection *::selection { background: transparent; }\n.ProseMirror-hideselection *::-moz-selection { background: transparent; }\n.ProseMirror-hideselection { caret-color: transparent; }\n\n.ProseMirror-selectednode {\n  outline: 2px solid #8cf;\n}\n\n/* Make sure li selections wrap around markers */\n\nli.ProseMirror-selectednode {\n  outline: none;\n}\n\nli.ProseMirror-selectednode:after {\n  content: "";\n  position: absolute;\n  left: -32px;\n  right: -2px; top: -2px; bottom: -2px;\n  border: 2px solid #8cf;\n  pointer-events: none;\n}\n\n/* Protect against generic img rules */\n\nimg.ProseMirror-separator {\n  display: inline !important;\n  border: none !important;\n  margin: 0 !important;\n}\n',""]);const a=s},645:e=>{e.exports=function(e){var t=[];return t.toString=function(){return this.map((function(t){var n="",r=void 0!==t[5];return t[4]&&(n+="@supports (".concat(t[4],") {")),t[2]&&(n+="@media ".concat(t[2]," {")),r&&(n+="@layer".concat(t[5].length>0?" ".concat(t[5]):""," {")),n+=e(t),r&&(n+="}"),t[2]&&(n+="}"),t[4]&&(n+="}"),n})).join("")},t.i=function(e,n,r,o,i){"string"==typeof e&&(e=[[null,e,void 0]]);var s={};if(r)for(var a=0;a<this.length;a++){var l=this[a][0];null!=l&&(s[l]=!0)}for(var c=0;c<e.length;c++){var u=[].concat(e[c]);r&&s[u[0]]||(void 0!==i&&(void 0===u[5]||(u[1]="@layer".concat(u[5].length>0?" ".concat(u[5]):""," {").concat(u[1],"}")),u[5]=i),n&&(u[2]?(u[1]="@media ".concat(u[2]," {").concat(u[1],"}"),u[2]=n):u[2]=n),o&&(u[4]?(u[1]="@supports (".concat(u[4],") {").concat(u[1],"}"),u[4]=o):u[4]="".concat(o)),t.push(u))}},t}},81:e=>{e.exports=function(e){return e[1]}},464:(e,t,n)=>{n.r(t),n.d(t,{default:()=>a});var r=200,o=function(){};o.prototype.append=function(e){return e.length?(e=o.from(e),!this.length&&e||e.length<r&&this.leafAppend(e)||this.length<r&&e.leafPrepend(this)||this.appendInner(e)):this},o.prototype.prepend=function(e){return e.length?o.from(e).append(this):this},o.prototype.appendInner=function(e){return new s(this,e)},o.prototype.slice=function(e,t){return void 0===e&&(e=0),void 0===t&&(t=this.length),e>=t?o.empty:this.sliceInner(Math.max(0,e),Math.min(this.length,t))},o.prototype.get=function(e){if(!(e<0||e>=this.length))return this.getInner(e)},o.prototype.forEach=function(e,t,n){void 0===t&&(t=0),void 0===n&&(n=this.length),t<=n?this.forEachInner(e,t,n,0):this.forEachInvertedInner(e,t,n,0)},o.prototype.map=function(e,t,n){void 0===t&&(t=0),void 0===n&&(n=this.length);var r=[];return this.forEach((function(t,n){return r.push(e(t,n))}),t,n),r},o.from=function(e){return e instanceof o?e:e&&e.length?new i(e):o.empty};var i=function(e){function t(t){e.call(this),this.values=t}e&&(t.__proto__=e),t.prototype=Object.create(e&&e.prototype),t.prototype.constructor=t;var n={length:{configurable:!0},depth:{configurable:!0}};return t.prototype.flatten=function(){return this.values},t.prototype.sliceInner=function(e,n){return 0==e&&n==this.length?this:new t(this.values.slice(e,n))},t.prototype.getInner=function(e){return this.values[e]},t.prototype.forEachInner=function(e,t,n,r){for(var o=t;o<n;o++)if(!1===e(this.values[o],r+o))return!1},t.prototype.forEachInvertedInner=function(e,t,n,r){for(var o=t-1;o>=n;o--)if(!1===e(this.values[o],r+o))return!1},t.prototype.leafAppend=function(e){if(this.length+e.length<=r)return new t(this.values.concat(e.flatten()))},t.prototype.leafPrepend=function(e){if(this.length+e.length<=r)return new t(e.flatten().concat(this.values))},n.length.get=function(){return this.values.length},n.depth.get=function(){return 0},Object.defineProperties(t.prototype,n),t}(o);o.empty=new i([]);var s=function(e){function t(t,n){e.call(this),this.left=t,this.right=n,this.length=t.length+n.length,this.depth=Math.max(t.depth,n.depth)+1}return e&&(t.__proto__=e),t.prototype=Object.create(e&&e.prototype),t.prototype.constructor=t,t.prototype.flatten=function(){return this.left.flatten().concat(this.right.flatten())},t.prototype.getInner=function(e){return e<this.left.length?this.left.get(e):this.right.get(e-this.left.length)},t.prototype.forEachInner=function(e,t,n,r){var o=this.left.length;return!(t<o&&!1===this.left.forEachInner(e,t,Math.min(n,o),r))&&!(n>o&&!1===this.right.forEachInner(e,Math.max(t-o,0),Math.min(this.length,n)-o,r+o))&&void 0},t.prototype.forEachInvertedInner=function(e,t,n,r){var o=this.left.length;return!(t>o&&!1===this.right.forEachInvertedInner(e,t-o,Math.max(n,o)-o,r+o))&&!(n<o&&!1===this.left.forEachInvertedInner(e,Math.min(t,o),n,r))&&void 0},t.prototype.sliceInner=function(e,t){if(0==e&&t==this.length)return this;var n=this.left.length;return t<=n?this.left.slice(e,t):e>=n?this.right.slice(e-n,t-n):this.left.slice(e,n).append(this.right.slice(0,t-n))},t.prototype.leafAppend=function(e){var n=this.right.leafAppend(e);if(n)return new t(this.left,n)},t.prototype.leafPrepend=function(e){var n=this.left.leafPrepend(e);if(n)return new t(n,this.right)},t.prototype.appendInner=function(e){return this.left.depth>=Math.max(this.right.depth,e.depth)+1?new t(this.left,new t(this.right,e)):new t(this,e)},t}(o);const a=o},611:(e,t,n)=>{n.r(t),n.d(t,{default:()=>y});var r=n(379),o=n.n(r),i=n(795),s=n.n(i),a=n(569),l=n.n(a),c=n(565),u=n.n(c),f=n(216),h=n.n(f),d=n(589),p=n.n(d),v=n(141),m={};m.styleTagTransform=p(),m.setAttributes=u(),m.insert=l().bind(null,"head"),m.domAPI=s(),m.insertStyleElement=h(),o()(v.Z,m);const y=v.Z&&v.Z.locals?v.Z.locals:void 0},340:(e,t,n)=>{n.r(t),n.d(t,{default:()=>y});var r=n(379),o=n.n(r),i=n(795),s=n.n(i),a=n(569),l=n.n(a),c=n(565),u=n.n(c),f=n(216),h=n.n(f),d=n(589),p=n.n(d),v=n(210),m={};m.styleTagTransform=p(),m.setAttributes=u(),m.insert=l().bind(null,"head"),m.domAPI=s(),m.insertStyleElement=h(),o()(v.Z,m);const y=v.Z&&v.Z.locals?v.Z.locals:void 0},662:(e,t,n)=>{n.r(t),n.d(t,{default:()=>y});var r=n(379),o=n.n(r),i=n(795),s=n.n(i),a=n(569),l=n.n(a),c=n(565),u=n.n(c),f=n(216),h=n.n(f),d=n(589),p=n.n(d),v=n(363),m={};m.styleTagTransform=p(),m.setAttributes=u(),m.insert=l().bind(null,"head"),m.domAPI=s(),m.insertStyleElement=h(),o()(v.Z,m);const y=v.Z&&v.Z.locals?v.Z.locals:void 0},379:e=>{var t=[];function n(e){for(var n=-1,r=0;r<t.length;r++)if(t[r].identifier===e){n=r;break}return n}function r(e,r){for(var i={},s=[],a=0;a<e.length;a++){var l=e[a],c=r.base?l[0]+r.base:l[0],u=i[c]||0,f="".concat(c," ").concat(u);i[c]=u+1;var h=n(f),d={css:l[1],media:l[2],sourceMap:l[3],supports:l[4],layer:l[5]};if(-1!==h)t[h].references++,t[h].updater(d);else{var p=o(d,r);r.byIndex=a,t.splice(a,0,{identifier:f,updater:p,references:1})}s.push(f)}return s}function o(e,t){var n=t.domAPI(t);return n.update(e),function(t){if(t){if(t.css===e.css&&t.media===e.media&&t.sourceMap===e.sourceMap&&t.supports===e.supports&&t.layer===e.layer)return;n.update(e=t)}else n.remove()}}e.exports=function(e,o){var i=r(e=e||[],o=o||{});return function(e){e=e||[];for(var s=0;s<i.length;s++){var a=n(i[s]);t[a].references--}for(var l=r(e,o),c=0;c<i.length;c++){var u=n(i[c]);0===t[u].references&&(t[u].updater(),t.splice(u,1))}i=l}}},569:e=>{var t={};e.exports=function(e,n){var r=function(e){if(void 0===t[e]){var n=document.querySelector(e);if(window.HTMLIFrameElement&&n instanceof window.HTMLIFrameElement)try{n=n.contentDocument.head}catch(e){n=null}t[e]=n}return t[e]}(e);if(!r)throw new Error("Couldn't find a style target. This probably means that the value for the 'insert' parameter is invalid.");r.appendChild(n)}},216:e=>{e.exports=function(e){var t=document.createElement("style");return e.setAttributes(t,e.attributes),e.insert(t,e.options),t}},565:(e,t,n)=>{e.exports=function(e){var t=n.nc;t&&e.setAttribute("nonce",t)}},795:e=>{e.exports=function(e){var t=e.insertStyleElement(e);return{update:function(n){!function(e,t,n){var r="";n.supports&&(r+="@supports (".concat(n.supports,") {")),n.media&&(r+="@media ".concat(n.media," {"));var o=void 0!==n.layer;o&&(r+="@layer".concat(n.layer.length>0?" ".concat(n.layer):""," {")),r+=n.css,o&&(r+="}"),n.media&&(r+="}"),n.supports&&(r+="}");var i=n.sourceMap;i&&"undefined"!=typeof btoa&&(r+="\n/*# sourceMappingURL=data:application/json;base64,".concat(btoa(unescape(encodeURIComponent(JSON.stringify(i))))," */")),t.styleTagTransform(r,e,t.options)}(t,e,n)},remove:function(){!function(e){if(null===e.parentNode)return!1;e.parentNode.removeChild(e)}(t)}}}},589:e=>{e.exports=function(e,t){if(t.styleSheet)t.styleSheet.cssText=e;else{for(;t.firstChild;)t.removeChild(t.firstChild);t.appendChild(document.createTextNode(e))}}},513:e=>{function t(e,n){if("string"==typeof n)e.appendChild(document.createTextNode(n));else if(null==n);else if(null!=n.nodeType)e.appendChild(n);else{if(!Array.isArray(n))throw new RangeError("Unsupported child node: "+n);for(var r=0;r<n.length;r++)t(e,n[r])}}e.exports=function(){var e=arguments[0];"string"==typeof e&&(e=document.createElement(e));var n=1,r=arguments[1];if(r&&"object"==typeof r&&null==r.nodeType&&!Array.isArray(r)){for(var o in r)if(Object.prototype.hasOwnProperty.call(r,o)){var i=r[o];"string"==typeof i?e.setAttribute(o,i):null!=i&&(e[o]=i)}n++}for(;n<arguments.length;n++)t(e,arguments[n]);return e}},586:e=>{function t(e){this.content=e}t.prototype={constructor:t,find:function(e){for(var t=0;t<this.content.length;t+=2)if(this.content[t]===e)return t;return-1},get:function(e){var t=this.find(e);return-1==t?void 0:this.content[t+1]},update:function(e,n,r){var o=r&&r!=e?this.remove(r):this,i=o.find(e),s=o.content.slice();return-1==i?s.push(r||e,n):(s[i+1]=n,r&&(s[i]=r)),new t(s)},remove:function(e){var n=this.find(e);if(-1==n)return this;var r=this.content.slice();return r.splice(n,2),new t(r)},addToStart:function(e,n){return new t([e,n].concat(this.remove(e).content))},addToEnd:function(e,n){var r=this.remove(e).content.slice();return r.push(e,n),new t(r)},addBefore:function(e,n,r){var o=this.remove(n),i=o.content.slice(),s=o.find(e);return i.splice(-1==s?i.length:s,0,n,r),new t(i)},forEach:function(e){for(var t=0;t<this.content.length;t+=2)e(this.content[t],this.content[t+1])},prepend:function(e){return(e=t.from(e)).size?new t(e.content.concat(this.subtract(e).content)):this},append:function(e){return(e=t.from(e)).size?new t(this.subtract(e).content.concat(e.content)):this},subtract:function(e){var n=this;e=t.from(e);for(var r=0;r<e.content.length;r+=2)n=n.remove(e.content[r]);return n},toObject:function(){var e={};return this.forEach((function(t,n){e[t]=n})),e},get size(){return this.content.length>>1}},t.from=function(e){if(e instanceof t)return e;var n=[];if(e)for(var r in e)n.push(r,e[r]);return new t(n)},e.exports=t},270:(e,t,n)=>{function r(e){return r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},r(e)}Object.defineProperty(t,"__esModule",{value:!0});var o=n(843),i=n(443),s=n(391),a=function(e,t){return!e.selection.empty&&(t&&t(e.tr.deleteSelection().scrollIntoView()),!0)};function l(e,t){var n=e.selection.$cursor;return!n||(t?!t.endOfTextblock("backward",e):n.parentOffset>0)?null:n}var c=function(e,t,n){var r=l(e,n);if(!r)return!1;var a=d(r);if(!a){var c=r.blockRange(),u=c&&o.liftTarget(c);return null!=u&&(t&&t(e.tr.lift(c,u).scrollIntoView()),!0)}var h=a.nodeBefore;if(!h.type.spec.isolating&&C(e,a,t))return!0;if(0==r.parent.content.size&&(f(h,"end")||s.NodeSelection.isSelectable(h))){var p=o.replaceStep(e.doc,r.before(),r.after(),i.Slice.empty);if(p&&p.slice.size<p.to-p.from){if(t){var v=e.tr.step(p);v.setSelection(f(h,"end")?s.Selection.findFrom(v.doc.resolve(v.mapping.map(a.pos,-1)),-1):s.NodeSelection.create(v.doc,a.pos-h.nodeSize)),t(v.scrollIntoView())}return!0}}return!(!h.isAtom||a.depth!=r.depth-1||(t&&t(e.tr.delete(a.pos-h.nodeSize,a.pos).scrollIntoView()),0))};function u(e,t,n){for(var r=t.nodeBefore,a=t.pos-1;!r.isTextblock;a--){if(r.type.spec.isolating)return!1;var l=r.lastChild;if(!l)return!1;r=l}for(var c=t.nodeAfter,u=t.pos+1;!c.isTextblock;u++){if(c.type.spec.isolating)return!1;var f=c.firstChild;if(!f)return!1;c=f}var h=o.replaceStep(e.doc,a,u,i.Slice.empty);if(!h||h.from!=a||h.slice.size>=u-a)return!1;if(n){var d=e.tr.step(h);d.setSelection(s.TextSelection.create(d.doc,a)),n(d.scrollIntoView())}return!0}function f(e,t){for(var n=arguments.length>2&&void 0!==arguments[2]&&arguments[2],r=e;r;r="start"==t?r.firstChild:r.lastChild){if(r.isTextblock)return!0;if(n&&1!=r.childCount)return!1}return!1}var h=function(e,t,n){var r=e.selection,o=r.$head,i=o;if(!r.empty)return!1;if(o.parent.isTextblock){if(n?!n.endOfTextblock("backward",e):o.parentOffset>0)return!1;i=d(o)}var a=i&&i.nodeBefore;return!(!a||!s.NodeSelection.isSelectable(a)||(t&&t(e.tr.setSelection(s.NodeSelection.create(e.doc,i.pos-a.nodeSize)).scrollIntoView()),0))};function d(e){if(!e.parent.type.spec.isolating)for(var t=e.depth-1;t>=0;t--){if(e.index(t)>0)return e.doc.resolve(e.before(t+1));if(e.node(t).type.spec.isolating)break}return null}function p(e,t){var n=e.selection.$cursor;return!n||(t?!t.endOfTextblock("forward",e):n.parentOffset<n.parent.content.size)?null:n}var v=function(e,t,n){var r=p(e,n);if(!r)return!1;var a=y(r);if(!a)return!1;var l=a.nodeAfter;if(C(e,a,t))return!0;if(0==r.parent.content.size&&(f(l,"start")||s.NodeSelection.isSelectable(l))){var c=o.replaceStep(e.doc,r.before(),r.after(),i.Slice.empty);if(c&&c.slice.size<c.to-c.from){if(t){var u=e.tr.step(c);u.setSelection(f(l,"start")?s.Selection.findFrom(u.doc.resolve(u.mapping.map(a.pos)),1):s.NodeSelection.create(u.doc,u.mapping.map(a.pos))),t(u.scrollIntoView())}return!0}}return!(!l.isAtom||a.depth!=r.depth-1||(t&&t(e.tr.delete(a.pos,a.pos+l.nodeSize).scrollIntoView()),0))},m=function(e,t,n){var r=e.selection,o=r.$head,i=o;if(!r.empty)return!1;if(o.parent.isTextblock){if(n?!n.endOfTextblock("forward",e):o.parentOffset<o.parent.content.size)return!1;i=y(o)}var a=i&&i.nodeAfter;return!(!a||!s.NodeSelection.isSelectable(a)||(t&&t(e.tr.setSelection(s.NodeSelection.create(e.doc,i.pos)).scrollIntoView()),0))};function y(e){if(!e.parent.type.spec.isolating)for(var t=e.depth-1;t>=0;t--){var n=e.node(t);if(e.index(t)+1<n.childCount)return e.doc.resolve(e.after(t+1));if(n.type.spec.isolating)break}return null}var g=function(e,t){var n=e.selection,r=n.$head,o=n.$anchor;return!(!r.parent.type.spec.code||!r.sameParent(o)||(t&&t(e.tr.insertText("\n").scrollIntoView()),0))};function k(e){for(var t=0;t<e.edgeCount;t++){var n=e.edge(t).type;if(n.isTextblock&&!n.hasRequiredAttrs())return n}return null}var w=function(e,t){var n=e.selection,r=n.$head,o=n.$anchor;if(!r.parent.type.spec.code||!r.sameParent(o))return!1;var i=r.node(-1),a=r.indexAfter(-1),l=k(i.contentMatchAt(a));if(!l||!i.canReplaceWith(a,a,l))return!1;if(t){var c=r.after(),u=e.tr.replaceWith(c,c,l.createAndFill());u.setSelection(s.Selection.near(u.doc.resolve(c),1)),t(u.scrollIntoView())}return!0},b=function(e,t){var n=e.selection,r=n.$from,o=n.$to;if(n instanceof s.AllSelection||r.parent.inlineContent||o.parent.inlineContent)return!1;var i=k(o.parent.contentMatchAt(o.indexAfter()));if(!i||!i.isTextblock)return!1;if(t){var a=(!r.parentOffset&&o.index()<o.parent.childCount?r:o).pos,l=e.tr.insert(a,i.createAndFill());l.setSelection(s.TextSelection.create(l.doc,a+1)),t(l.scrollIntoView())}return!0},S=function(e,t){var n=e.selection.$cursor;if(!n||n.parent.content.size)return!1;if(n.depth>1&&n.after()!=n.end(-1)){var r=n.before();if(o.canSplit(e.doc,r))return t&&t(e.tr.split(r).scrollIntoView()),!0}var i=n.blockRange(),s=i&&o.liftTarget(i);return null!=s&&(t&&t(e.tr.lift(i,s).scrollIntoView()),!0)};function x(e){return function(t,n){var r=t.selection,i=r.$from,a=r.$to;if(t.selection instanceof s.NodeSelection&&t.selection.node.isBlock)return!(!i.parentOffset||!o.canSplit(t.doc,i.pos)||(n&&n(t.tr.split(i.pos).scrollIntoView()),0));if(!i.parent.isBlock)return!1;if(n){var l=a.parentOffset==a.parent.content.size,c=t.tr;(t.selection instanceof s.TextSelection||t.selection instanceof s.AllSelection)&&c.deleteSelection();var u=0==i.depth?null:k(i.node(-1).contentMatchAt(i.indexAfter(-1))),f=e&&e(a.parent,l),h=f?[f]:l&&u?[{type:u}]:void 0,d=o.canSplit(c.doc,c.mapping.map(i.pos),1,h);if(h||d||!o.canSplit(c.doc,c.mapping.map(i.pos),1,u?[{type:u}]:void 0)||(u&&(h=[{type:u}]),d=!0),d&&(c.split(c.mapping.map(i.pos),1,h),!l&&!i.parentOffset&&i.parent.type!=u)){var p=c.mapping.map(i.before()),v=c.doc.resolve(p);u&&i.node(-1).canReplaceWith(v.index(),v.index()+1,u)&&c.setNodeMarkup(c.mapping.map(i.before()),u)}n(c.scrollIntoView())}return!0}}var M=x(),O=function(e,t){return t&&t(e.tr.setSelection(new s.AllSelection(e.doc))),!0};function C(e,t,n){var r,a,l=t.nodeBefore,c=t.nodeAfter;if(l.type.spec.isolating||c.type.spec.isolating)return!1;if(function(e,t,n){var r=t.nodeBefore,i=t.nodeAfter,s=t.index();return!(!(r&&i&&r.type.compatibleContent(i.type))||(!r.content.size&&t.parent.canReplace(s-1,s)?(n&&n(e.tr.delete(t.pos-r.nodeSize,t.pos).scrollIntoView()),0):!t.parent.canReplace(s,s+1)||!i.isTextblock&&!o.canJoin(e.doc,t.pos)||(n&&n(e.tr.clearIncompatible(t.pos,r.type,r.contentMatchAt(r.childCount)).join(t.pos).scrollIntoView()),0)))}(e,t,n))return!0;var u=t.parent.canReplace(t.index(),t.index()+1);if(u&&(r=(a=l.contentMatchAt(l.childCount)).findWrapping(c.type))&&a.matchType(r[0]||c.type).validEnd){if(n){for(var h=t.pos+c.nodeSize,d=i.Fragment.empty,p=r.length-1;p>=0;p--)d=i.Fragment.from(r[p].create(null,d));d=i.Fragment.from(l.copy(d));var v=e.tr.step(new o.ReplaceAroundStep(t.pos-1,h,t.pos,h,new i.Slice(d,1,0),r.length,!0)),m=h+2*r.length;o.canJoin(v.doc,m)&&v.join(m),n(v.scrollIntoView())}return!0}var y=s.Selection.findFrom(t,1),g=y&&y.$from.blockRange(y.$to),k=g&&o.liftTarget(g);if(null!=k&&k>=t.depth)return n&&n(e.tr.lift(g,k).scrollIntoView()),!0;if(u&&f(c,"start",!0)&&f(l,"end")){for(var w=l,b=[];b.push(w),!w.isTextblock;)w=w.lastChild;for(var S=c,x=1;!S.isTextblock;S=S.firstChild)x++;if(w.canReplace(w.childCount,w.childCount,S.content)){if(n){for(var M=i.Fragment.empty,O=b.length-1;O>=0;O--)M=i.Fragment.from(b[O].copy(M));n(e.tr.step(new o.ReplaceAroundStep(t.pos-b.length,t.pos+c.nodeSize,t.pos+x,t.pos+c.nodeSize-x,new i.Slice(M,b.length,0),0,!0)).scrollIntoView())}return!0}}return!1}function N(e){return function(t,n){for(var r=t.selection,o=e<0?r.$from:r.$to,i=o.depth;o.node(i).isInline;){if(!i)return!1;i--}return!!o.node(i).isTextblock&&(n&&n(t.tr.setSelection(s.TextSelection.create(t.doc,e<0?o.start(i):o.end(i)))),!0)}}var T=N(-1),D=N(1);function E(e,t,n){for(var o=function(r){var o=t[r],i=o.$from,s=o.$to,a=0==i.depth&&e.inlineContent&&e.type.allowsMarkType(n);if(e.nodesBetween(i.pos,s.pos,(function(e){if(a)return!1;a=e.inlineContent&&e.type.allowsMarkType(n)})),a)return{v:!0}},i=0;i<t.length;i++){var s=o(i);if("object"===r(s))return s.v}return!1}function A(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return function(e,n,r){for(var o=0;o<t.length;o++)if(t[o](e,n,r))return!0;return!1}}var P=A(a,c,h),R=A(a,v,m),I={Enter:A(g,b,S,M),"Mod-Enter":w,Backspace:P,"Mod-Backspace":P,"Shift-Backspace":P,Delete:R,"Mod-Delete":R,"Mod-a":O},z={"Ctrl-h":I.Backspace,"Alt-Backspace":I["Mod-Backspace"],"Ctrl-d":I.Delete,"Ctrl-Alt-Backspace":I["Mod-Delete"],"Alt-Delete":I["Mod-Delete"],"Alt-d":I["Mod-Delete"],"Ctrl-a":T,"Ctrl-e":D};for(var F in I)z[F]=I[F];var B=("undefined"!=typeof navigator?/Mac|iP(hone|[oa]d)/.test(navigator.platform):"undefined"!=typeof os&&os.platform&&"darwin"==os.platform())?z:I;t.autoJoin=function(e,t){var n=Array.isArray(t)?function(e){return t.indexOf(e.type.name)>-1}:t;return function(t,r,i){return e(t,r&&function(e,t){return function(n){if(!n.isGeneric)return e(n);for(var r=[],i=0;i<n.mapping.maps.length;i++){for(var s=n.mapping.maps[i],a=0;a<r.length;a++)r[a]=s.map(r[a]);s.forEach((function(e,t,n,o){return r.push(n,o)}))}for(var l=[],c=0;c<r.length;c+=2)for(var u=r[c],f=r[c+1],h=n.doc.resolve(u),d=h.sharedDepth(f),p=h.node(d),v=h.indexAfter(d),m=h.after(d+1);m<=f;++v){var y=p.maybeChild(v);if(!y)break;if(v&&-1==l.indexOf(m)){var g=p.child(v-1);g.type==y.type&&t(g,y)&&l.push(m)}m+=y.nodeSize}l.sort((function(e,t){return e-t}));for(var k=l.length-1;k>=0;k--)o.canJoin(n.doc,l[k])&&n.join(l[k]);e(n)}}(r,n),i)}},t.baseKeymap=B,t.chainCommands=A,t.createParagraphNear=b,t.deleteSelection=a,t.exitCode=w,t.joinBackward=c,t.joinDown=function(e,t){var n,r=e.selection;if(r instanceof s.NodeSelection){if(r.node.isTextblock||!o.canJoin(e.doc,r.to))return!1;n=r.to}else if(null==(n=o.joinPoint(e.doc,r.to,1)))return!1;return t&&t(e.tr.join(n).scrollIntoView()),!0},t.joinForward=v,t.joinTextblockBackward=function(e,t,n){var r=l(e,n);if(!r)return!1;var o=d(r);return!!o&&u(e,o,t)},t.joinTextblockForward=function(e,t,n){var r=p(e,n);if(!r)return!1;var o=y(r);return!!o&&u(e,o,t)},t.joinUp=function(e,t){var n,r=e.selection,i=r instanceof s.NodeSelection;if(i){if(r.node.isTextblock||!o.canJoin(e.doc,r.from))return!1;n=r.from}else if(null==(n=o.joinPoint(e.doc,r.from,-1)))return!1;if(t){var a=e.tr.join(n);i&&a.setSelection(s.NodeSelection.create(a.doc,n-e.doc.resolve(n).nodeBefore.nodeSize)),t(a.scrollIntoView())}return!0},t.lift=function(e,t){var n=e.selection,r=n.$from,i=n.$to,s=r.blockRange(i),a=s&&o.liftTarget(s);return null!=a&&(t&&t(e.tr.lift(s,a).scrollIntoView()),!0)},t.liftEmptyBlock=S,t.macBaseKeymap=z,t.newlineInCode=g,t.pcBaseKeymap=I,t.selectAll=O,t.selectNodeBackward=h,t.selectNodeForward=m,t.selectParentNode=function(e,t){var n,r=e.selection,o=r.$from,i=r.to,a=o.sharedDepth(i);return 0!=a&&(n=o.before(a),t&&t(e.tr.setSelection(s.NodeSelection.create(e.doc,n))),!0)},t.selectTextblockEnd=D,t.selectTextblockStart=T,t.setBlockType=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;return function(n,r){for(var o=!1,i=0;i<n.selection.ranges.length&&!o;i++){var s=n.selection.ranges[i],a=s.$from.pos,l=s.$to.pos;n.doc.nodesBetween(a,l,(function(r,i){if(o)return!1;if(r.isTextblock&&!r.hasMarkup(e,t))if(r.type==e)o=!0;else{var s=n.doc.resolve(i),a=s.index();o=s.parent.canReplaceWith(a,a+1,e)}}))}if(!o)return!1;if(r){for(var c=n.tr,u=0;u<n.selection.ranges.length;u++){var f=n.selection.ranges[u],h=f.$from.pos,d=f.$to.pos;c.setBlockType(h,d,e,t)}r(c.scrollIntoView())}return!0}},t.splitBlock=M,t.splitBlockAs=x,t.splitBlockKeepMarks=function(e,t){return M(e,t&&function(n){var r=e.storedMarks||e.selection.$to.parentOffset&&e.selection.$from.marks();r&&n.ensureMarks(r),t(n)})},t.toggleMark=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;return function(n,r){var o=n.selection,i=o.empty,s=o.$cursor,a=o.ranges;if(i&&!s||!E(n.doc,a,e))return!1;if(r)if(s)e.isInSet(n.storedMarks||s.marks())?r(n.tr.removeStoredMark(e)):r(n.tr.addStoredMark(e.create(t)));else{for(var l=!1,c=n.tr,u=0;!l&&u<a.length;u++){var f=a[u],h=f.$from,d=f.$to;l=n.doc.rangeHasMark(h.pos,d.pos,e)}for(var p=0;p<a.length;p++){var v=a[p],m=v.$from,y=v.$to;if(l)c.removeMark(m.pos,y.pos,e);else{var g=m.pos,k=y.pos,w=m.nodeAfter,b=y.nodeBefore,S=w&&w.isText?/^\s*/.exec(w.text)[0].length:0,x=b&&b.isText?/\s*$/.exec(b.text)[0].length:0;g+S<k&&(g+=S,k-=x),c.addMark(g,k,e.create(t))}}r(c.scrollIntoView())}return!0}},t.wrapIn=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;return function(n,r){var i=n.selection,s=i.$from,a=i.$to,l=s.blockRange(a),c=l&&o.findWrapping(l,e,t);return!!c&&(r&&r(n.tr.wrap(l,c).scrollIntoView()),!0)}}},588:(e,t,n)=>{function r(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}Object.defineProperty(t,"__esModule",{value:!0});var o=n(391),i=n(843),s=function(){function e(t,n){var r=this;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.editorView=t,this.cursorPos=null,this.element=null,this.timeout=-1,this.width=n.width||1,this.color=n.color||"black",this.class=n.class,this.handlers=["dragover","dragend","drop","dragleave"].map((function(e){var n=function(t){r[e](t)};return t.dom.addEventListener(e,n),{name:e,handler:n}}))}var t,n;return t=e,(n=[{key:"destroy",value:function(){var e=this;this.handlers.forEach((function(t){var n=t.name,r=t.handler;return e.editorView.dom.removeEventListener(n,r)}))}},{key:"update",value:function(e,t){null!=this.cursorPos&&t.doc!=e.state.doc&&(this.cursorPos>e.state.doc.content.size?this.setCursor(null):this.updateOverlay())}},{key:"setCursor",value:function(e){e!=this.cursorPos&&(this.cursorPos=e,null==e?(this.element.parentNode.removeChild(this.element),this.element=null):this.updateOverlay())}},{key:"updateOverlay",value:function(){var e,t=this.editorView.state.doc.resolve(this.cursorPos);if(!t.parent.inlineContent){var n=t.nodeBefore,r=t.nodeAfter;if(n||r){var o=this.editorView.nodeDOM(this.cursorPos-(n?n.nodeSize:0));if(o){var i=o.getBoundingClientRect(),s=n?i.bottom:i.top;n&&r&&(s=(s+this.editorView.nodeDOM(this.cursorPos).getBoundingClientRect().top)/2),e={left:i.left,right:i.right,top:s-this.width/2,bottom:s+this.width/2}}}}if(!e){var a=this.editorView.coordsAtPos(this.cursorPos);e={left:a.left-this.width/2,right:a.left+this.width/2,top:a.top,bottom:a.bottom}}var l,c,u=this.editorView.dom.offsetParent;if(this.element||(this.element=u.appendChild(document.createElement("div")),this.class&&(this.element.className=this.class),this.element.style.cssText="position: absolute; z-index: 50; pointer-events: none; background-color: "+this.color),!u||u==document.body&&"static"==getComputedStyle(u).position)l=-pageXOffset,c=-pageYOffset;else{var f=u.getBoundingClientRect();l=f.left-u.scrollLeft,c=f.top-u.scrollTop}this.element.style.left=e.left-l+"px",this.element.style.top=e.top-c+"px",this.element.style.width=e.right-e.left+"px",this.element.style.height=e.bottom-e.top+"px"}},{key:"scheduleRemoval",value:function(e){var t=this;clearTimeout(this.timeout),this.timeout=setTimeout((function(){return t.setCursor(null)}),e)}},{key:"dragover",value:function(e){if(this.editorView.editable){var t=this.editorView.posAtCoords({left:e.clientX,top:e.clientY}),n=t&&t.inside>=0&&this.editorView.state.doc.nodeAt(t.inside),r=n&&n.type.spec.disableDropCursor,o="function"==typeof r?r(this.editorView,t,e):r;if(t&&!o){var s=t.pos;if(this.editorView.dragging&&this.editorView.dragging.slice&&null==(s=i.dropPoint(this.editorView.state.doc,s,this.editorView.dragging.slice)))return this.setCursor(null);this.setCursor(s),this.scheduleRemoval(5e3)}}}},{key:"dragend",value:function(){this.scheduleRemoval(20)}},{key:"drop",value:function(){this.scheduleRemoval(20)}},{key:"dragleave",value:function(e){e.target!=this.editorView.dom&&this.editorView.dom.contains(e.relatedTarget)||this.setCursor(null)}}])&&r(t.prototype,n),Object.defineProperty(t,"prototype",{writable:!1}),e}();t.dropCursor=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return new o.Plugin({view:function(t){return new s(t,e)}})}},568:(e,t,n)=>{function r(e){return r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},r(e)}function o(e,t){return o=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e},o(e,t)}function i(e,t){if(t&&("object"===r(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}function s(e){return s=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)},s(e)}function a(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function l(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function c(e,t,n){return t&&l(e.prototype,t),n&&l(e,n),Object.defineProperty(e,"prototype",{writable:!1}),e}Object.defineProperty(t,"__esModule",{value:!0});var u=n(354),f=n(638),h=n(270),d=n(391),p=n(588),v=n(634),m=n(371),y=n(32),g=n(665),k="ProseMirror-prompt";function w(e){var t=document.body.appendChild(document.createElement("div"));t.className=k;var n=function(e){t.contains(e.target)||r()};setTimeout((function(){return window.addEventListener("mousedown",n)}),50);var r=function(){window.removeEventListener("mousedown",n),t.parentNode&&t.parentNode.removeChild(t)},o=[];for(var i in e.fields)o.push(e.fields[i].render());var s=document.createElement("button");s.type="submit",s.className=k+"-submit",s.textContent="OK";var a=document.createElement("button");a.type="button",a.className=k+"-cancel",a.textContent="Cancel",a.addEventListener("click",r);var l=t.appendChild(document.createElement("form"));e.title&&(l.appendChild(document.createElement("h5")).textContent=e.title),o.forEach((function(e){l.appendChild(document.createElement("div")).appendChild(e)}));var c=l.appendChild(document.createElement("div"));c.className=k+"-buttons",c.appendChild(s),c.appendChild(document.createTextNode(" ")),c.appendChild(a);var u=t.getBoundingClientRect();t.style.top=(window.innerHeight-u.height)/2+"px",t.style.left=(window.innerWidth-u.width)/2+"px";var f=function(){var t=function(e,t){var n=Object.create(null),r=0;for(var o in e){var i=e[o],s=t[r++],a=i.read(s),l=i.validate(a);if(l)return b(s,l),null;n[o]=i.clean(a)}return n}(e.fields,o);t&&(r(),e.callback(t))};l.addEventListener("submit",(function(e){e.preventDefault(),f()})),l.addEventListener("keydown",(function(e){27==e.keyCode?(e.preventDefault(),r()):13!=e.keyCode||e.ctrlKey||e.metaKey||e.shiftKey?9==e.keyCode&&window.setTimeout((function(){t.contains(document.activeElement)||r()}),500):(e.preventDefault(),f())}));var h=l.elements[0];h&&h.focus()}function b(e,t){var n=e.parentNode,r=n.appendChild(document.createElement("div"));r.style.left=e.offsetLeft+e.offsetWidth+2+"px",r.style.top=e.offsetTop-5+"px",r.className="ProseMirror-invalid",r.textContent=t,setTimeout((function(){return n.removeChild(r)}),1500)}var S=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&o(e,t)}(l,e);var t,n,r=(t=l,n=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}(),function(){var e,r=s(t);if(n){var o=s(this).constructor;e=Reflect.construct(r,arguments,o)}else e=r.apply(this,arguments);return i(this,e)});function l(){return a(this,l),r.apply(this,arguments)}return c(l,[{key:"render",value:function(){var e=document.createElement("input");return e.type="text",e.placeholder=this.options.label,e.value=this.options.value||"",e.autocomplete="off",e}}]),l}(function(){function e(t){a(this,e),this.options=t}return c(e,[{key:"read",value:function(e){return e.value}},{key:"validateType",value:function(e){return null}},{key:"validate",value:function(e){return!e&&this.options.required?"Required field":this.validateType(e)||(this.options.validate?this.options.validate(e):null)}},{key:"clean",value:function(e){return this.options.clean?this.options.clean(e):e}}]),e}());function x(e,t){for(var n=e.selection.$from,r=n.depth;r>=0;r--){var o=n.index(r);if(n.node(r).canReplaceWith(o,o,t))return!0}return!1}function M(e,t){var n={label:t.title,run:e};for(var r in t)n[r]=t[r];return t.enable||t.select||(n[t.enable?"enable":"select"]=function(t){return e(t)}),new m.MenuItem(n)}function O(e,t){var n=e.selection,r=n.from,o=n.$from,i=n.to;return n.empty?!!t.isInSet(e.storedMarks||o.marks()):e.doc.rangeHasMark(r,i,t)}function C(e,t){var n={active:function(t){return O(t,e)}};for(var r in t)n[r]=t[r];return M(h.toggleMark(e),n)}function N(e,t){return M(y.wrapInList(e,t.attrs),t)}function T(e){var t,n,r,o,i={};if((t=e.marks.strong)&&(i.toggleStrong=C(t,{title:"Toggle strong style",icon:m.icons.strong})),(t=e.marks.em)&&(i.toggleEm=C(t,{title:"Toggle emphasis",icon:m.icons.em})),(t=e.marks.code)&&(i.toggleCode=C(t,{title:"Toggle code font",icon:m.icons.code})),(t=e.marks.link)&&(i.toggleLink=(n=t,new m.MenuItem({title:"Add or remove link",icon:m.icons.link,active:function(e){return O(e,n)},enable:function(e){return!e.selection.empty},run:function(e,t,r){if(O(e,n))return h.toggleMark(n)(e,t),!0;w({title:"Create a link",fields:{href:new S({label:"Link target",required:!0}),title:new S({label:"Title"})},callback:function(e){h.toggleMark(n,e)(r.state,r.dispatch),r.focus()}})}}))),(r=e.nodes.image)&&(i.insertImage=(o=r,new m.MenuItem({title:"Insert image",label:"Image",enable:function(e){return x(e,o)},run:function(e,t,n){var r=e.selection,i=r.from,s=r.to,a=null;e.selection instanceof d.NodeSelection&&e.selection.node.type==o&&(a=e.selection.node.attrs),w({title:"Insert image",fields:{src:new S({label:"Location",required:!0,value:a&&a.src}),title:new S({label:"Title",value:a&&a.title}),alt:new S({label:"Description",value:a?a.alt:e.doc.textBetween(i,s," ")})},callback:function(e){n.dispatch(n.state.tr.replaceSelectionWith(o.createAndFill(e))),n.focus()}})}}))),(r=e.nodes.bullet_list)&&(i.wrapBulletList=N(r,{title:"Wrap in bullet list",icon:m.icons.bulletList})),(r=e.nodes.ordered_list)&&(i.wrapOrderedList=N(r,{title:"Wrap in ordered list",icon:m.icons.orderedList})),(r=e.nodes.blockquote)&&(i.wrapBlockQuote=m.wrapItem(r,{title:"Wrap in block quote",icon:m.icons.blockquote})),(r=e.nodes.paragraph)&&(i.makeParagraph=m.blockTypeItem(r,{title:"Change to paragraph",label:"Plain"})),(r=e.nodes.code_block)&&(i.makeCodeBlock=m.blockTypeItem(r,{title:"Change to code block",label:"Code"})),r=e.nodes.heading)for(var s=1;s<=10;s++)i["makeHead"+s]=m.blockTypeItem(r,{title:"Change to heading "+s,label:"Level "+s,attrs:{level:s}});if(r=e.nodes.horizontal_rule){var a=r;i.insertHorizontalRule=new m.MenuItem({title:"Insert horizontal rule",label:"Horizontal rule",enable:function(e){return x(e,a)},run:function(e,t){t(e.tr.replaceSelectionWith(a.create()))}})}var l=function(e){return e.filter((function(e){return e}))};return i.insertMenu=new m.Dropdown(l([i.insertImage,i.insertHorizontalRule]),{label:"Insert"}),i.typeMenu=new m.Dropdown(l([i.makeParagraph,i.makeCodeBlock,i.makeHead1&&new m.DropdownSubmenu(l([i.makeHead1,i.makeHead2,i.makeHead3,i.makeHead4,i.makeHead5,i.makeHead6]),{label:"Heading"})]),{label:"Type..."}),i.inlineMenu=[l([i.toggleStrong,i.toggleEm,i.toggleCode,i.toggleLink])],i.blockMenu=[l([i.wrapBulletList,i.wrapOrderedList,i.wrapBlockQuote,m.joinUpItem,m.liftItem,m.selectParentNodeItem])],i.fullMenu=i.inlineMenu.concat([[i.insertMenu,i.typeMenu]],[[m.undoItem,m.redoItem]],i.blockMenu),i}var D="undefined"!=typeof navigator&&/Mac|iP(hone|[oa]d)/.test(navigator.platform);function E(e,t){var n,r={};function o(e,n){if(t){var o=t[e];if(!1===o)return;o&&(e=o)}r[e]=n}if(o("Mod-z",f.undo),o("Shift-Mod-z",f.redo),o("Backspace",g.undoInputRule),D||o("Mod-y",f.redo),o("Alt-ArrowUp",h.joinUp),o("Alt-ArrowDown",h.joinDown),o("Mod-BracketLeft",h.lift),o("Escape",h.selectParentNode),(n=e.marks.strong)&&(o("Mod-b",h.toggleMark(n)),o("Mod-B",h.toggleMark(n))),(n=e.marks.em)&&(o("Mod-i",h.toggleMark(n)),o("Mod-I",h.toggleMark(n))),(n=e.marks.code)&&o("Mod-`",h.toggleMark(n)),(n=e.nodes.bullet_list)&&o("Shift-Ctrl-8",y.wrapInList(n)),(n=e.nodes.ordered_list)&&o("Shift-Ctrl-9",y.wrapInList(n)),(n=e.nodes.blockquote)&&o("Ctrl->",h.wrapIn(n)),n=e.nodes.hard_break){var i=n,s=h.chainCommands(h.exitCode,(function(e,t){return t&&t(e.tr.replaceSelectionWith(i.create()).scrollIntoView()),!0}));o("Mod-Enter",s),o("Shift-Enter",s),D&&o("Ctrl-Enter",s)}if((n=e.nodes.list_item)&&(o("Enter",y.splitListItem(n)),o("Mod-[",y.liftListItem(n)),o("Mod-]",y.sinkListItem(n))),(n=e.nodes.paragraph)&&o("Shift-Ctrl-0",h.setBlockType(n)),(n=e.nodes.code_block)&&o("Shift-Ctrl-\\",h.setBlockType(n)),n=e.nodes.heading)for(var a=1;a<=6;a++)o("Shift-Ctrl-"+a,h.setBlockType(n,{level:a}));if(n=e.nodes.horizontal_rule){var l=n;o("Mod-_",(function(e,t){return t&&t(e.tr.replaceSelectionWith(l.create()).scrollIntoView()),!0}))}return r}function A(e){var t,n,r=g.smartQuotes.concat(g.ellipsis,g.emDash);return(t=e.nodes.blockquote)&&r.push((n=t,g.wrappingInputRule(/^\s*>\s$/,n))),(t=e.nodes.ordered_list)&&r.push(function(e){return g.wrappingInputRule(/^(\d+)\.\s$/,e,(function(e){return{order:+e[1]}}),(function(e,t){return t.childCount+t.attrs.order==+e[1]}))}(t)),(t=e.nodes.bullet_list)&&r.push(function(e){return g.wrappingInputRule(/^\s*([-+*])\s$/,e)}(t)),(t=e.nodes.code_block)&&r.push(function(e){return g.textblockTypeInputRule(/^```$/,e)}(t)),(t=e.nodes.heading)&&r.push(function(e,t){return g.textblockTypeInputRule(new RegExp("^(#{1,6})\\s$"),e,(function(e){return{level:e[1].length}}))}(t)),g.inputRules({rules:r})}t.buildInputRules=A,t.buildKeymap=E,t.buildMenuItems=T,t.exampleSetup=function(e){var t=[A(e.schema),u.keymap(E(e.schema,e.mapKeys)),u.keymap(h.baseKeymap),p.dropCursor(),v.gapCursor()];return!1!==e.menuBar&&t.push(m.menuBar({floating:!1!==e.floatingMenu,content:e.menuContent||T(e.schema).fullMenu})),!1!==e.history&&t.push(f.history()),t.concat(new d.Plugin({props:{attributes:{class:"ProseMirror-example-setup-style"}}}))}},634:(e,t,n)=>{function r(e){return r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},r(e)}function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function i(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function s(e,t,n){return t&&i(e.prototype,t),n&&i(e,n),Object.defineProperty(e,"prototype",{writable:!1}),e}function a(e,t){return a=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e},a(e,t)}function l(e,t){if(t&&("object"===r(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}function c(e){return c=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)},c(e)}Object.defineProperty(t,"__esModule",{value:!0});var u=n(354),f=n(391),h=n(443),d=n(222),p=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&a(e,t)}(i,e);var t,n,r=(t=i,n=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}(),function(){var e,r=c(t);if(n){var o=c(this).constructor;e=Reflect.construct(r,arguments,o)}else e=r.apply(this,arguments);return l(this,e)});function i(e){return o(this,i),r.call(this,e,e)}return s(i,[{key:"map",value:function(e,t){var n=e.resolve(t.map(this.head));return i.valid(n)?new i(n):f.Selection.near(n)}},{key:"content",value:function(){return h.Slice.empty}},{key:"eq",value:function(e){return e instanceof i&&e.head==this.head}},{key:"toJSON",value:function(){return{type:"gapcursor",pos:this.head}}},{key:"getBookmark",value:function(){return new v(this.anchor)}}],[{key:"fromJSON",value:function(e,t){if("number"!=typeof t.pos)throw new RangeError("Invalid input for GapCursor.fromJSON");return new i(e.resolve(t.pos))}},{key:"valid",value:function(e){var t=e.parent;if(t.isTextblock||!function(e){for(var t=e.depth;t>=0;t--){var n=e.index(t),r=e.node(t);if(0!=n)for(var o=r.child(n-1);;o=o.lastChild){if(0==o.childCount&&!o.inlineContent||o.isAtom||o.type.spec.isolating)return!0;if(o.inlineContent)return!1}else if(r.type.spec.isolating)return!0}return!0}(e)||!function(e){for(var t=e.depth;t>=0;t--){var n=e.indexAfter(t),r=e.node(t);if(n!=r.childCount)for(var o=r.child(n);;o=o.firstChild){if(0==o.childCount&&!o.inlineContent||o.isAtom||o.type.spec.isolating)return!0;if(o.inlineContent)return!1}else if(r.type.spec.isolating)return!0}return!0}(e))return!1;var n=t.type.spec.allowGapCursor;if(null!=n)return n;var r=t.contentMatchAt(e.index()).defaultType;return r&&r.isTextblock}},{key:"findGapCursorFrom",value:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]&&arguments[2];e:for(;;){if(!n&&i.valid(e))return e;for(var r=e.pos,o=null,s=e.depth;;s--){var a=e.node(s);if(t>0?e.indexAfter(s)<a.childCount:e.index(s)>0){o=a.child(t>0?e.indexAfter(s):e.index(s)-1);break}if(0==s)return null;r+=t;var l=e.doc.resolve(r);if(i.valid(l))return l}for(;;){var c=t>0?o.firstChild:o.lastChild;if(!c){if(o.isAtom&&!o.isText&&!f.NodeSelection.isSelectable(o)){e=e.doc.resolve(r+o.nodeSize*t),n=!1;continue e}break}o=c,r+=t;var u=e.doc.resolve(r);if(i.valid(u))return u}return null}}}]),i}(f.Selection);p.prototype.visible=!1,p.findFrom=p.findGapCursorFrom,f.Selection.jsonID("gapcursor",p);var v=function(){function e(t){o(this,e),this.pos=t}return s(e,[{key:"map",value:function(t){return new e(t.map(this.pos))}},{key:"resolve",value:function(e){var t=e.resolve(this.pos);return p.valid(t)?new p(t):f.Selection.near(t)}}]),e}(),m=u.keydownHandler({ArrowLeft:y("horiz",-1),ArrowRight:y("horiz",1),ArrowUp:y("vert",-1),ArrowDown:y("vert",1)});function y(e,t){var n="vert"==e?t>0?"down":"up":t>0?"right":"left";return function(e,r,o){var i=e.selection,s=t>0?i.$to:i.$from,a=i.empty;if(i instanceof f.TextSelection){if(!o.endOfTextblock(n)||0==s.depth)return!1;a=!1,s=e.doc.resolve(t>0?s.after():s.before())}var l=p.findGapCursorFrom(s,t,a);return!!l&&(r&&r(e.tr.setSelection(new p(l))),!0)}}function g(e,t,n){if(!e||!e.editable)return!1;var r=e.state.doc.resolve(t);if(!p.valid(r))return!1;var o=e.posAtCoords({left:n.clientX,top:n.clientY});return!(o&&o.inside>-1&&f.NodeSelection.isSelectable(e.state.doc.nodeAt(o.inside))||(e.dispatch(e.state.tr.setSelection(new p(r))),0))}function k(e,t){if("insertCompositionText"!=t.inputType||!(e.state.selection instanceof p))return!1;var n=e.state.selection.$from,r=n.parent.contentMatchAt(n.index()).findWrapping(e.state.schema.nodes.text);if(!r)return!1;for(var o=h.Fragment.empty,i=r.length-1;i>=0;i--)o=h.Fragment.from(r[i].createAndFill(null,o));var s=e.state.tr.replace(n.pos,n.pos,new h.Slice(o,0,0));return s.setSelection(f.TextSelection.near(s.doc.resolve(n.pos+1))),e.dispatch(s),!1}function w(e){if(!(e.selection instanceof p))return null;var t=document.createElement("div");return t.className="ProseMirror-gapcursor",d.DecorationSet.create(e.doc,[d.Decoration.widget(e.selection.head,t,{key:"gapcursor"})])}t.GapCursor=p,t.gapCursor=function(){return new f.Plugin({props:{decorations:w,createSelectionBetween:function(e,t,n){return t.pos==n.pos&&p.valid(n)?new p(n):null},handleClick:g,handleKeyDown:m,handleDOMEvents:{beforeinput:k}}})}},638:(e,t,n)=>{function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function o(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function i(e,t,n){return t&&o(e.prototype,t),n&&o(e,n),Object.defineProperty(e,"prototype",{writable:!1}),e}function s(e){return s="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},s(e)}Object.defineProperty(t,"__esModule",{value:!0});var a,l=n(464),c=n(843),u=n(391),f=(a=l)&&"object"===s(a)&&"default"in a?a:{default:a},h=function(){function e(t,n){r(this,e),this.items=t,this.eventCount=n}return i(e,[{key:"popEvent",value:function(t,n){var r=this;if(0==this.eventCount)return null;for(var o,i,s=this.items.length;;s--)if(this.items.get(s-1).selection){--s;break}n&&(o=this.remapping(s,this.items.length),i=o.maps.length);var a,l,c=t.tr,u=[],f=[];return this.items.forEach((function(t,n){if(!t.step)return o||(o=r.remapping(s,n+1),i=o.maps.length),i--,void f.push(t);if(o){f.push(new d(t.map));var h,p=t.step.map(o.slice(i));p&&c.maybeStep(p).doc&&(h=c.mapping.maps[c.mapping.maps.length-1],u.push(new d(h,void 0,void 0,u.length+f.length))),i--,h&&o.appendMap(h,i)}else c.maybeStep(t.step);return t.selection?(a=o?t.selection.map(o.slice(i)):t.selection,l=new e(r.items.slice(0,s).append(f.reverse().concat(u)),r.eventCount-1),!1):void 0}),this.items.length,0),{remaining:l,transform:c,selection:a}}},{key:"addTransform",value:function(t,n,r,o){for(var i=[],s=this.eventCount,a=this.items,l=!o&&a.length?a.get(a.length-1):null,c=0;c<t.steps.length;c++){var u,f=t.steps[c].invert(t.docs[c]),h=new d(t.mapping.maps[c],f,n);(u=l&&l.merge(h))&&(h=u,c?i.pop():a=a.slice(0,a.length-1)),i.push(h),n&&(s++,n=void 0),o||(l=h)}var p,m,y,g=s-r.depth;return g>v&&(m=g,(p=a).forEach((function(e,t){if(e.selection&&0==m--)return y=t,!1})),a=p.slice(y),s-=g),new e(a.append(i),s)}},{key:"remapping",value:function(e,t){var n=new c.Mapping;return this.items.forEach((function(t,r){var o=null!=t.mirrorOffset&&r-t.mirrorOffset>=e?n.maps.length-t.mirrorOffset:void 0;n.appendMap(t.map,o)}),e,t),n}},{key:"addMaps",value:function(t){return 0==this.eventCount?this:new e(this.items.append(t.map((function(e){return new d(e)}))),this.eventCount)}},{key:"rebased",value:function(t,n){if(!this.eventCount)return this;var r=[],o=Math.max(0,this.items.length-n),i=t.mapping,s=t.steps.length,a=this.eventCount;this.items.forEach((function(e){e.selection&&a--}),o);var l=n;this.items.forEach((function(e){var n=i.getMirror(--l);if(null!=n){s=Math.min(s,n);var o=i.maps[n];if(e.step){var c=t.steps[n].invert(t.docs[n]),u=e.selection&&e.selection.map(i.slice(l+1,n));u&&a++,r.push(new d(o,c,u))}else r.push(new d(o))}}),o);for(var c=[],u=n;u<s;u++)c.push(new d(i.maps[u]));var f=new e(this.items.slice(0,o).append(c).append(r),a);return f.emptyItemCount()>500&&(f=f.compress(this.items.length-r.length)),f}},{key:"emptyItemCount",value:function(){var e=0;return this.items.forEach((function(t){t.step||e++})),e}},{key:"compress",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.items.length,n=this.remapping(0,t),r=n.maps.length,o=[],i=0;return this.items.forEach((function(e,s){if(s>=t)o.push(e),e.selection&&i++;else if(e.step){var a=e.step.map(n.slice(r)),l=a&&a.getMap();if(r--,l&&n.appendMap(l,r),a){var c=e.selection&&e.selection.map(n.slice(r));c&&i++;var u,f=new d(l.invert(),a,c),h=o.length-1;(u=o.length&&o[h].merge(f))?o[h]=u:o.push(f)}}else e.map&&r--}),this.items.length,0),new e(f.default.from(o.reverse()),i)}}]),e}();h.empty=new h(f.default.empty,0);var d=function(){function e(t,n,o,i){r(this,e),this.map=t,this.step=n,this.selection=o,this.mirrorOffset=i}return i(e,[{key:"merge",value:function(t){if(this.step&&t.step&&!t.selection){var n=t.step.merge(this.step);if(n)return new e(n.getMap().invert(),n,this.selection)}}}]),e}(),p=i((function e(t,n,o,i){r(this,e),this.done=t,this.undone=n,this.prevRanges=o,this.prevTime=i})),v=20;function m(e,t,n,r){var o,i=n.getMeta(x);if(i)return i.historyState;n.getMeta(M)&&(e=new p(e.done,e.undone,null,0));var s=n.getMeta("appendedTransaction");if(0==n.steps.length)return e;if(s&&s.getMeta(x))return s.getMeta(x).redo?new p(e.done.addTransform(n,void 0,r,S(t)),e.undone,y(n.mapping.maps[n.steps.length-1]),e.prevTime):new p(e.done,e.undone.addTransform(n,void 0,r,S(t)),null,e.prevTime);if(!1===n.getMeta("addToHistory")||s&&!1===s.getMeta("addToHistory"))return(o=n.getMeta("rebased"))?new p(e.done.rebased(n,o),e.undone.rebased(n,o),g(e.prevRanges,n.mapping),e.prevTime):new p(e.done.addMaps(n.mapping.maps),e.undone.addMaps(n.mapping.maps),g(e.prevRanges,n.mapping),e.prevTime);var a=0==e.prevTime||!s&&(e.prevTime<(n.time||0)-r.newGroupDelay||!function(e,t){if(!t)return!1;if(!e.docChanged)return!0;var n=!1;return e.mapping.maps[0].forEach((function(e,r){for(var o=0;o<t.length;o+=2)e<=t[o+1]&&r>=t[o]&&(n=!0)})),n}(n,e.prevRanges)),l=s?g(e.prevRanges,n.mapping):y(n.mapping.maps[n.steps.length-1]);return new p(e.done.addTransform(n,a?t.selection.getBookmark():void 0,r,S(t)),h.empty,l,n.time)}function y(e){var t=[];return e.forEach((function(e,n,r,o){return t.push(r,o)})),t}function g(e,t){if(!e)return null;for(var n=[],r=0;r<e.length;r+=2){var o=t.map(e[r],1),i=t.map(e[r+1],-1);o<=i&&n.push(o,i)}return n}function k(e,t,n,r){var o=S(t),i=x.get(t).spec.config,s=(r?e.undone:e.done).popEvent(t,o);if(s){var a=s.selection.resolve(s.transform.doc),l=(r?e.done:e.undone).addTransform(s.transform,t.selection.getBookmark(),i,o),c=new p(r?l:s.remaining,r?s.remaining:l,null,0);n(s.transform.setSelection(a).setMeta(x,{redo:r,historyState:c}).scrollIntoView())}}var w=!1,b=null;function S(e){var t=e.plugins;if(b!=t){w=!1,b=t;for(var n=0;n<t.length;n++)if(t[n].spec.historyPreserveItems){w=!0;break}}return w}var x=new u.PluginKey("history"),M=new u.PluginKey("closeHistory"),O=function(e,t){var n=x.getState(e);return!(!n||0==n.done.eventCount||(t&&k(n,e,t,!1),0))},C=function(e,t){var n=x.getState(e);return!(!n||0==n.undone.eventCount||(t&&k(n,e,t,!0),0))};t.closeHistory=function(e){return e.setMeta(M,!0)},t.history=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return e={depth:e.depth||100,newGroupDelay:e.newGroupDelay||500},new u.Plugin({key:x,state:{init:function(){return new p(h.empty,h.empty,null,0)},apply:function(t,n,r){return m(n,r,t,e)}},config:e,props:{handleDOMEvents:{beforeinput:function(e,t){var n=t.inputType,r="historyUndo"==n?O:"historyRedo"==n?C:null;return!!r&&(t.preventDefault(),r(e.state,e.dispatch))}}}})},t.redo=C,t.redoDepth=function(e){var t=x.getState(e);return t?t.undone.eventCount:0},t.undo=O,t.undoDepth=function(e){var t=x.getState(e);return t?t.done.eventCount:0}},665:(e,t,n)=>{Object.defineProperty(t,"__esModule",{value:!0});var r,o=n(391),i=n(843),s=(r=function e(t,n){var r;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.match=t,this.match=t,this.handler="string"==typeof n?(r=n,function(e,t,n,o){var i=r;if(t[1]){var s=t[0].lastIndexOf(t[1]);i+=t[0].slice(s+t[1].length);var a=(n+=s)-o;a>0&&(i=t[0].slice(s-a,s)+i,n=o)}return e.tr.insertText(i,n,o)}):n},Object.defineProperty(r,"prototype",{writable:!1}),r);function a(e,t,n,r,o,i){if(e.composing)return!1;var s=e.state,a=s.doc.resolve(t);if(a.parent.type.spec.code)return!1;for(var l=a.parent.textBetween(Math.max(0,a.parentOffset-500),a.parentOffset,null,"￼")+r,c=0;c<o.length;c++){var u=o[c].match.exec(l),f=u&&o[c].handler(s,u,t-(u[0].length-r.length),n);if(f)return e.dispatch(f.setMeta(i,{transform:f,from:t,to:n,text:r})),!0}return!1}var l=new s(/--$/,"—"),c=new s(/\.\.\.$/,"…"),u=new s(/(?:^|[\s\{\[\(\<'"\u2018\u201C])(")$/,"“"),f=new s(/"$/,"”"),h=new s(/(?:^|[\s\{\[\(\<'"\u2018\u201C])(')$/,"‘"),d=new s(/'$/,"’"),p=[u,f,h,d];t.InputRule=s,t.closeDoubleQuote=f,t.closeSingleQuote=d,t.ellipsis=c,t.emDash=l,t.inputRules=function(e){var t=e.rules,n=new o.Plugin({state:{init:function(){return null},apply:function(e,t){return e.getMeta(this)||(e.selectionSet||e.docChanged?null:t)}},props:{handleTextInput:function(e,r,o,i){return a(e,r,o,i,t,n)},handleDOMEvents:{compositionend:function(e){setTimeout((function(){var r=e.state.selection.$cursor;r&&a(e,r.pos,r.pos,"",t,n)}))}}},isInputRules:!0});return n},t.openDoubleQuote=u,t.openSingleQuote=h,t.smartQuotes=p,t.textblockTypeInputRule=function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;return new s(e,(function(e,r,o,i){var s=e.doc.resolve(o),a=n instanceof Function?n(r):n;return s.node(-1).canReplaceWith(s.index(-1),s.indexAfter(-1),t)?e.tr.delete(o,i).setBlockType(o,o,t,a):null}))},t.undoInputRule=function(e,t){for(var n=e.plugins,r=0;r<n.length;r++){var o=n[r],i=void 0;if(o.spec.isInputRules&&(i=o.getState(e))){if(t){for(var s=e.tr,a=i.transform,l=a.steps.length-1;l>=0;l--)s.step(a.steps[l].invert(a.docs[l]));if(i.text){var c=s.doc.resolve(i.from).marks();s.replaceWith(i.from,i.to,e.schema.text(i.text,c))}else s.delete(i.from,i.to);t(s)}return!0}}return!1},t.wrappingInputRule=function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null,r=arguments.length>3?arguments[3]:void 0;return new s(e,(function(e,o,s,a){var l=n instanceof Function?n(o):n,c=e.tr.delete(s,a),u=c.doc.resolve(s).blockRange(),f=u&&i.findWrapping(u,t,l);if(!f)return null;c.wrap(u,f);var h=c.doc.resolve(s-1).nodeBefore;return h&&h.type==t&&i.canJoin(c.doc,s-1)&&(!r||r(o,h))&&c.join(s-1),c}))}},354:(e,t,n)=>{Object.defineProperty(t,"__esModule",{value:!0});var r=n(691),o=n(391),i="undefined"!=typeof navigator&&/Mac|iP(hone|[oa]d)/.test(navigator.platform);function s(e){var t,n,r,o,s=e.split(/-(?!$)/),a=s[s.length-1];"Space"==a&&(a=" ");for(var l=0;l<s.length-1;l++){var c=s[l];if(/^(cmd|meta|m)$/i.test(c))o=!0;else if(/^a(lt)?$/i.test(c))t=!0;else if(/^(c|ctrl|control)$/i.test(c))n=!0;else if(/^s(hift)?$/i.test(c))r=!0;else{if(!/^mod$/i.test(c))throw new Error("Unrecognized modifier name: "+c);i?o=!0:n=!0}}return t&&(a="Alt-"+a),n&&(a="Ctrl-"+a),o&&(a="Meta-"+a),r&&(a="Shift-"+a),a}function a(e,t,n){return t.altKey&&(e="Alt-"+e),t.ctrlKey&&(e="Ctrl-"+e),t.metaKey&&(e="Meta-"+e),!1!==n&&t.shiftKey&&(e="Shift-"+e),e}function l(e){var t=function(e){var t=Object.create(null);for(var n in e)t[s(n)]=e[n];return t}(e);return function(e,n){var o,i=r.keyName(n),s=1==i.length&&" "!=i,l=t[a(i,n,!s)];if(l&&l(e.state,e.dispatch,e))return!0;if(s&&(n.shiftKey||n.altKey||n.metaKey||i.charCodeAt(0)>127)&&(o=r.base[n.keyCode])&&o!=i){var c=t[a(o,n,!0)];if(c&&c(e.state,e.dispatch,e))return!0}else if(s&&n.shiftKey){var u=t[a(i,n,!0)];if(u&&u(e.state,e.dispatch,e))return!0}return!1}}t.keydownHandler=l,t.keymap=function(e){return new o.Plugin({props:{handleKeyDown:l(e)}})}},371:(e,t,n)=>{function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function o(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function i(e,t,n){return t&&o(e.prototype,t),n&&o(e,n),Object.defineProperty(e,"prototype",{writable:!1}),e}function s(e){return s="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},s(e)}Object.defineProperty(t,"__esModule",{value:!0});var a,l=n(513),c=n(270),u=n(638),f=n(391),h=(a=l)&&"object"===s(a)&&"default"in a?a:{default:a},d="http://www.w3.org/2000/svg",p="ProseMirror-icon";var v="ProseMirror-menu",m=function(){function e(t){r(this,e),this.spec=t}return i(e,[{key:"render",value:function(e){var t=this.spec,n=t.render?t.render(e):t.icon?function(e){var t=document.createElement("div");if(t.className=p,e.path){var n=e.path,r=e.width,o=e.height,i="pm-icon-"+function(e){for(var t=0,n=0;n<e.length;n++)t=(t<<5)-t+e.charCodeAt(n)|0;return t}(n).toString(16);document.getElementById(i)||function(e,t){var n=document.getElementById(p+"-collection");n||((n=document.createElementNS(d,"svg")).id=p+"-collection",n.style.display="none",document.body.insertBefore(n,document.body.firstChild));var r=document.createElementNS(d,"symbol");r.id=e,r.setAttribute("viewBox","0 0 "+t.width+" "+t.height),r.appendChild(document.createElementNS(d,"path")).setAttribute("d",t.path),n.appendChild(r)}(i,e);var s=t.appendChild(document.createElementNS(d,"svg"));s.style.width=r/o+"em",s.appendChild(document.createElementNS(d,"use")).setAttributeNS("http://www.w3.org/1999/xlink","href",/([^#]*)/.exec(document.location.toString())[1]+"#"+i)}else if(e.dom)t.appendChild(e.dom.cloneNode(!0));else{var a=e.text,l=e.css;t.appendChild(document.createElement("span")).textContent=a||"",l&&(t.firstChild.style.cssText=l)}return t}(t.icon):t.label?h.default("div",null,y(e,t.label)):null;if(!n)throw new RangeError("MenuItem without icon or label property");if(t.title){var r="function"==typeof t.title?t.title(e.state):t.title;n.setAttribute("title",y(e,r))}return t.class&&n.classList.add(t.class),t.css&&(n.style.cssText+=t.css),n.addEventListener("mousedown",(function(r){r.preventDefault(),n.classList.contains(v+"-disabled")||t.run(e.state,e.dispatch,e,r)})),{dom:n,update:function(e){if(t.select){var r=t.select(e);if(n.style.display=r?"":"none",!r)return!1}var o=!0;if(t.enable&&(o=t.enable(e)||!1,P(n,v+"-disabled",!o)),t.active){var i=o&&t.active(e)||!1;P(n,v+"-active",i)}return!0}}}}]),e}();function y(e,t){return e._props.translate?e._props.translate(t):t}var g={time:0,node:null};function k(e){g.time=Date.now(),g.node=e.target}function w(e){return Date.now()-100<g.time&&g.node&&e.contains(g.node)}var b=function(){function e(t){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};r(this,e),this.options=n,this.options=n||{},this.content=Array.isArray(t)?t:[t]}return i(e,[{key:"render",value:function(e){var t=this,n=S(this.content,e),r=h.default("div",{class:v+"-dropdown "+(this.options.class||""),style:this.options.css},y(e,this.options.label||""));this.options.title&&r.setAttribute("title",y(e,this.options.title));var o=h.default("div",{class:v+"-dropdown-wrap"},r),i=null,s=null,a=function(){i&&i.close()&&(i=null,window.removeEventListener("mousedown",s))};return r.addEventListener("mousedown",(function(e){e.preventDefault(),k(e),i?a():(i=t.expand(o,n.dom),window.addEventListener("mousedown",s=function(){w(o)||a()}))})),{dom:o,update:function(e){var t=n.update(e);return o.style.display=t?"":"none",t}}}},{key:"expand",value:function(e,t){var n=h.default("div",{class:v+"-dropdown-menu "+(this.options.class||"")},t),r=!1;return e.appendChild(n),{close:function(){if(!r)return r=!0,e.removeChild(n),!0},node:n}}}]),e}();function S(e,t){for(var n=[],r=[],o=0;o<e.length;o++){var i=e[o].render(t),s=i.dom,a=i.update;n.push(h.default("div",{class:v+"-dropdown-item"},s)),r.push(a)}return{dom:n,update:x(r,n)}}function x(e,t){return function(n){for(var r=!1,o=0;o<e.length;o++){var i=e[o](n);t[o].style.display=i?"":"none",i&&(r=!0)}return r}}var M=function(){function e(t){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};r(this,e),this.options=n,this.content=Array.isArray(t)?t:[t]}return i(e,[{key:"render",value:function(e){var t=S(this.content,e),n=h.default("div",{class:v+"-submenu-label"},y(e,this.options.label||"")),r=h.default("div",{class:v+"-submenu-wrap"},n,h.default("div",{class:v+"-submenu"},t.dom)),o=null;return n.addEventListener("mousedown",(function(e){e.preventDefault(),k(e),P(r,v+"-submenu-wrap-active",!1),o||window.addEventListener("mousedown",o=function(){w(r)||(r.classList.remove(v+"-submenu-wrap-active"),window.removeEventListener("mousedown",o),o=null)})})),{dom:r,update:function(e){var n=t.update(e);return r.style.display=n?"":"none",n}}}}]),e}();function O(e,t){for(var n=document.createDocumentFragment(),r=[],o=[],i=0;i<t.length;i++){for(var s=t[i],a=[],l=[],c=0;c<s.length;c++){var u=s[c].render(e),f=u.dom,d=u.update,p=h.default("span",{class:v+"item"},f);n.appendChild(p),l.push(p),a.push(d)}a.length&&(r.push(x(a,l)),i<t.length-1&&o.push(n.appendChild(h.default("span",{class:v+"separator"}))))}return{dom:n,update:function(e){for(var t=!1,n=!1,i=0;i<r.length;i++){var s=r[i](e);i&&(o[i-1].style.display=n&&s?"":"none"),n=s,s&&(t=!0)}return t}}}var C={join:{width:800,height:900,path:"M0 75h800v125h-800z M0 825h800v-125h-800z M250 400h100v-100h100v100h100v100h-100v100h-100v-100h-100z"},lift:{width:1024,height:1024,path:"M219 310v329q0 7-5 12t-12 5q-8 0-13-5l-164-164q-5-5-5-13t5-13l164-164q5-5 13-5 7 0 12 5t5 12zM1024 749v109q0 7-5 12t-12 5h-987q-7 0-12-5t-5-12v-109q0-7 5-12t12-5h987q7 0 12 5t5 12zM1024 530v109q0 7-5 12t-12 5h-621q-7 0-12-5t-5-12v-109q0-7 5-12t12-5h621q7 0 12 5t5 12zM1024 310v109q0 7-5 12t-12 5h-621q-7 0-12-5t-5-12v-109q0-7 5-12t12-5h621q7 0 12 5t5 12zM1024 91v109q0 7-5 12t-12 5h-987q-7 0-12-5t-5-12v-109q0-7 5-12t12-5h987q7 0 12 5t5 12z"},selectParentNode:{text:"⬚",css:"font-weight: bold"},undo:{width:1024,height:1024,path:"M761 1024c113-206 132-520-313-509v253l-384-384 384-384v248c534-13 594 472 313 775z"},redo:{width:1024,height:1024,path:"M576 248v-248l384 384-384 384v-253c-446-10-427 303-313 509-280-303-221-789 313-775z"},strong:{width:805,height:1024,path:"M317 869q42 18 80 18 214 0 214-191 0-65-23-102-15-25-35-42t-38-26-46-14-48-6-54-1q-41 0-57 5 0 30-0 90t-0 90q0 4-0 38t-0 55 2 47 6 38zM309 442q24 4 62 4 46 0 81-7t62-25 42-51 14-81q0-40-16-70t-45-46-61-24-70-8q-28 0-74 7 0 28 2 86t2 86q0 15-0 45t-0 45q0 26 0 39zM0 950l1-53q8-2 48-9t60-15q4-6 7-15t4-19 3-18 1-21 0-19v-37q0-561-12-585-2-4-12-8t-25-6-28-4-27-2-17-1l-2-47q56-1 194-6t213-5q13 0 39 0t38 0q40 0 78 7t73 24 61 40 42 59 16 78q0 29-9 54t-22 41-36 32-41 25-48 22q88 20 146 76t58 141q0 57-20 102t-53 74-78 48-93 27-100 8q-25 0-75-1t-75-1q-60 0-175 6t-132 6z"},em:{width:585,height:1024,path:"M0 949l9-48q3-1 46-12t63-21q16-20 23-57 0-4 35-165t65-310 29-169v-14q-13-7-31-10t-39-4-33-3l10-58q18 1 68 3t85 4 68 1q27 0 56-1t69-4 56-3q-2 22-10 50-17 5-58 16t-62 19q-4 10-8 24t-5 22-4 26-3 24q-15 84-50 239t-44 203q-1 5-7 33t-11 51-9 47-3 32l0 10q9 2 105 17-1 25-9 56-6 0-18 0t-18 0q-16 0-49-5t-49-5q-78-1-117-1-29 0-81 5t-69 6z"},code:{width:896,height:1024,path:"M608 192l-96 96 224 224-224 224 96 96 288-320-288-320zM288 192l-288 320 288 320 96-96-224-224 224-224-96-96z"},link:{width:951,height:1024,path:"M832 694q0-22-16-38l-118-118q-16-16-38-16-24 0-41 18 1 1 10 10t12 12 8 10 7 14 2 15q0 22-16 38t-38 16q-8 0-15-2t-14-7-10-8-12-12-10-10q-18 17-18 41 0 22 16 38l117 118q15 15 38 15 22 0 38-14l84-83q16-16 16-38zM430 292q0-22-16-38l-117-118q-16-16-38-16-22 0-38 15l-84 83q-16 16-16 38 0 22 16 38l118 118q15 15 38 15 24 0 41-17-1-1-10-10t-12-12-8-10-7-14-2-15q0-22 16-38t38-16q8 0 15 2t14 7 10 8 12 12 10 10q18-17 18-41zM941 694q0 68-48 116l-84 83q-47 47-116 47-69 0-116-48l-117-118q-47-47-47-116 0-70 50-119l-50-50q-49 50-118 50-68 0-116-48l-118-118q-48-48-48-116t48-116l84-83q47-47 116-47 69 0 116 48l117 118q47 47 47 116 0 70-50 119l50 50q49-50 118-50 68 0 116 48l118 118q48 48 48 116z"},bulletList:{width:768,height:896,path:"M0 512h128v-128h-128v128zM0 256h128v-128h-128v128zM0 768h128v-128h-128v128zM256 512h512v-128h-512v128zM256 256h512v-128h-512v128zM256 768h512v-128h-512v128z"},orderedList:{width:768,height:896,path:"M320 512h448v-128h-448v128zM320 768h448v-128h-448v128zM320 128v128h448v-128h-448zM79 384h78v-256h-36l-85 23v50l43-2v185zM189 590c0-36-12-78-96-78-33 0-64 6-83 16l1 66c21-10 42-15 67-15s32 11 32 28c0 26-30 58-110 112v50h192v-67l-91 2c49-30 87-66 87-113l1-1z"},blockquote:{width:640,height:896,path:"M0 448v256h256v-256h-128c0 0 0-128 128-128v-128c0 0-256 0-256 256zM640 320v-128c0 0-256 0-256 256v256h256v-256h-128c0 0 0-128 128-128z"}},N=new m({title:"Join with above block",run:c.joinUp,select:function(e){return c.joinUp(e)},icon:C.join}),T=new m({title:"Lift out of enclosing block",run:c.lift,select:function(e){return c.lift(e)},icon:C.lift}),D=new m({title:"Select parent node",run:c.selectParentNode,select:function(e){return c.selectParentNode(e)},icon:C.selectParentNode}),E=new m({title:"Undo last change",run:u.undo,enable:function(e){return u.undo(e)},icon:C.undo}),A=new m({title:"Redo last undone change",run:u.redo,enable:function(e){return u.redo(e)},icon:C.redo});function P(e,t,n){n?e.classList.add(t):e.classList.remove(t)}var R="ProseMirror-menubar",I=function(){function e(t,n){var o=this;r(this,e),this.editorView=t,this.options=n,this.spacer=null,this.maxHeight=0,this.widthForMaxHeight=0,this.floating=!1,this.scrollHandler=null,this.wrapper=h.default("div",{class:R+"-wrapper"}),this.menu=this.wrapper.appendChild(h.default("div",{class:R})),this.menu.className=R,t.dom.parentNode&&t.dom.parentNode.replaceChild(this.wrapper,t.dom),this.wrapper.appendChild(t.dom);var i=O(this.editorView,this.options.content),s=i.dom,a=i.update;if(this.contentUpdate=a,this.menu.appendChild(s),this.update(),n.floating&&!function(){if("undefined"==typeof navigator)return!1;var e=navigator.userAgent;return!/Edge\/\d/.test(e)&&/AppleWebKit/.test(e)&&/Mobile\/\w+/.test(e)}()){this.updateFloat();var l=function(e){for(var t=[window],n=e.parentNode;n;n=n.parentNode)t.push(n);return t}(this.wrapper);this.scrollHandler=function(e){var t=o.editorView.root;(t.body||t).contains(o.wrapper)?o.updateFloat(e.target.getBoundingClientRect?e.target:void 0):l.forEach((function(e){return e.removeEventListener("scroll",o.scrollHandler)}))},l.forEach((function(e){return e.addEventListener("scroll",o.scrollHandler)}))}}return i(e,[{key:"update",value:function(){this.contentUpdate(this.editorView.state),this.floating?this.updateScrollCursor():(this.menu.offsetWidth!=this.widthForMaxHeight&&(this.widthForMaxHeight=this.menu.offsetWidth,this.maxHeight=0),this.menu.offsetHeight>this.maxHeight&&(this.maxHeight=this.menu.offsetHeight,this.menu.style.minHeight=this.maxHeight+"px"))}},{key:"updateScrollCursor",value:function(){var e=this.editorView.root.getSelection();if(e.focusNode){var t=e.getRangeAt(0).getClientRects(),n=t[function(e){return e.anchorNode==e.focusNode?e.anchorOffset>e.focusOffset:e.anchorNode.compareDocumentPosition(e.focusNode)==Node.DOCUMENT_POSITION_FOLLOWING}(e)?0:t.length-1];if(n){var r=this.menu.getBoundingClientRect();if(n.top<r.bottom&&n.bottom>r.top){var o=function(e){for(var t=e.parentNode;t;t=t.parentNode)if(t.scrollHeight>t.clientHeight)return t}(this.wrapper);o&&(o.scrollTop-=r.bottom-n.top)}}}}},{key:"updateFloat",value:function(e){var t=this.wrapper,n=t.getBoundingClientRect(),r=e?Math.max(0,e.getBoundingClientRect().top):0;if(this.floating)if(n.top>=r||n.bottom<this.menu.offsetHeight+10)this.floating=!1,this.menu.style.position=this.menu.style.left=this.menu.style.top=this.menu.style.width="",this.menu.style.display="",this.spacer.parentNode.removeChild(this.spacer),this.spacer=null;else{var o=(t.offsetWidth-t.clientWidth)/2;this.menu.style.left=n.left+o+"px",this.menu.style.display=n.top>window.innerHeight?"none":"",e&&(this.menu.style.top=r+"px")}else if(n.top<r&&n.bottom>=this.menu.offsetHeight+10){this.floating=!0;var i=this.menu.getBoundingClientRect();this.menu.style.left=i.left+"px",this.menu.style.width=i.width+"px",e&&(this.menu.style.top=r+"px"),this.menu.style.position="fixed",this.spacer=h.default("div",{class:R+"-spacer",style:"height: ".concat(i.height,"px")}),t.insertBefore(this.spacer,this.menu)}}},{key:"destroy",value:function(){this.wrapper.parentNode&&this.wrapper.parentNode.replaceChild(this.editorView.dom,this.wrapper)}}]),e}();t.Dropdown=b,t.DropdownSubmenu=M,t.MenuItem=m,t.blockTypeItem=function(e,t){var n=c.setBlockType(e,t.attrs),r={run:n,enable:function(e){return n(e)},active:function(n){var r=n.selection,o=r.$from,i=r.to,s=r.node;return s?s.hasMarkup(e,t.attrs):i<=o.end()&&o.parent.hasMarkup(e,t.attrs)}};for(var o in t)r[o]=t[o];return new m(r)},t.icons=C,t.joinUpItem=N,t.liftItem=T,t.menuBar=function(e){return new f.Plugin({view:function(t){return new I(t,e)}})},t.redoItem=A,t.renderGrouped=O,t.selectParentNodeItem=D,t.undoItem=E,t.wrapItem=function(e,t){var n={run:function(n,r){return c.wrapIn(e,t.attrs)(n,r)},select:function(n){return c.wrapIn(e,t.attrs)(n)}};for(var r in t)n[r]=t[r];return new m(n)}},443:(e,t,n)=>{function r(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function o(){return o="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,n){var r=i(e,t);if(r){var o=Object.getOwnPropertyDescriptor(r,t);return o.get?o.get.call(arguments.length<3?e:n):o.value}},o.apply(this,arguments)}function i(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=d(e)););return e}function s(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&h(e,t)}function a(e){var t=f();return function(){var n,r=d(e);if(t){var o=d(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return l(this,n)}}function l(e,t){if(t&&("object"===y(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}function c(e){var t="function"==typeof Map?new Map:void 0;return c=function(e){if(null===e||(n=e,-1===Function.toString.call(n).indexOf("[native code]")))return e;var n;if("function"!=typeof e)throw new TypeError("Super expression must either be null or a function");if(void 0!==t){if(t.has(e))return t.get(e);t.set(e,r)}function r(){return u(e,arguments,d(this).constructor)}return r.prototype=Object.create(e.prototype,{constructor:{value:r,enumerable:!1,writable:!0,configurable:!0}}),h(r,e)},c(e)}function u(e,t,n){return u=f()?Reflect.construct:function(e,t,n){var r=[null];r.push.apply(r,t);var o=new(Function.bind.apply(e,r));return n&&h(o,n.prototype),o},u.apply(null,arguments)}function f(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}function h(e,t){return h=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e},h(e,t)}function d(e){return d=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)},d(e)}function p(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function v(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function m(e,t,n){return t&&v(e.prototype,t),n&&v(e,n),Object.defineProperty(e,"prototype",{writable:!1}),e}function y(e){return y="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},y(e)}Object.defineProperty(t,"__esModule",{value:!0});var g,k=(g=n(586))&&"object"===y(g)&&"default"in g?g:{default:g};function w(e,t,n){for(var r=0;;r++){if(r==e.childCount||r==t.childCount)return e.childCount==t.childCount?null:n;var o=e.child(r),i=t.child(r);if(o!=i){if(!o.sameMarkup(i))return n;if(o.isText&&o.text!=i.text){for(var s=0;o.text[s]==i.text[s];s++)n++;return n}if(o.content.size||i.content.size){var a=w(o.content,i.content,n+1);if(null!=a)return a}n+=o.nodeSize}else n+=o.nodeSize}}function b(e,t,n,r){for(var o=e.childCount,i=t.childCount;;){if(0==o||0==i)return o==i?null:{a:n,b:r};var s=e.child(--o),a=t.child(--i),l=s.nodeSize;if(s!=a){if(!s.sameMarkup(a))return{a:n,b:r};if(s.isText&&s.text!=a.text){for(var c=0,u=Math.min(s.text.length,a.text.length);c<u&&s.text[s.text.length-c-1]==a.text[a.text.length-c-1];)c++,n--,r--;return{a:n,b:r}}if(s.content.size||a.content.size){var f=b(s.content,a.content,n-1,r-1);if(f)return f}n-=l,r-=l}else n-=l,r-=l}}var S=function(){function e(t,n){if(p(this,e),this.content=t,this.size=n||0,null==n)for(var r=0;r<t.length;r++)this.size+=t[r].nodeSize}return m(e,[{key:"nodesBetween",value:function(e,t,n){for(var r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0,o=arguments.length>4?arguments[4]:void 0,i=0,s=0;s<t;i++){var a=this.content[i],l=s+a.nodeSize;if(l>e&&!1!==n(a,r+s,o||null,i)&&a.content.size){var c=s+1;a.nodesBetween(Math.max(0,e-c),Math.min(a.content.size,t-c),n,r+c)}s=l}}},{key:"descendants",value:function(e){this.nodesBetween(0,this.size,e)}},{key:"textBetween",value:function(e,t,n,r){var o="",i=!0;return this.nodesBetween(e,t,(function(s,a){s.isText?(o+=s.text.slice(Math.max(e,a)-a,t-a),i=!n):s.isLeaf?(r?o+="function"==typeof r?r(s):r:s.type.spec.leafText&&(o+=s.type.spec.leafText(s)),i=!n):!i&&s.isBlock&&(o+=n,i=!0)}),0),o}},{key:"append",value:function(t){if(!t.size)return this;if(!this.size)return t;var n=this.lastChild,r=t.firstChild,o=this.content.slice(),i=0;for(n.isText&&n.sameMarkup(r)&&(o[o.length-1]=n.withText(n.text+r.text),i=1);i<t.content.length;i++)o.push(t.content[i]);return new e(o,this.size+t.size)}},{key:"cut",value:function(t){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this.size;if(0==t&&n==this.size)return this;var r=[],o=0;if(n>t)for(var i=0,s=0;s<n;i++){var a=this.content[i],l=s+a.nodeSize;l>t&&((s<t||l>n)&&(a=a.isText?a.cut(Math.max(0,t-s),Math.min(a.text.length,n-s)):a.cut(Math.max(0,t-s-1),Math.min(a.content.size,n-s-1))),r.push(a),o+=a.nodeSize),s=l}return new e(r,o)}},{key:"cutByIndex",value:function(t,n){return t==n?e.empty:0==t&&n==this.content.length?this:new e(this.content.slice(t,n))}},{key:"replaceChild",value:function(t,n){var r=this.content[t];if(r==n)return this;var o=this.content.slice(),i=this.size+n.nodeSize-r.nodeSize;return o[t]=n,new e(o,i)}},{key:"addToStart",value:function(t){return new e([t].concat(this.content),this.size+t.nodeSize)}},{key:"addToEnd",value:function(t){return new e(this.content.concat(t),this.size+t.nodeSize)}},{key:"eq",value:function(e){if(this.content.length!=e.content.length)return!1;for(var t=0;t<this.content.length;t++)if(!this.content[t].eq(e.content[t]))return!1;return!0}},{key:"firstChild",get:function(){return this.content.length?this.content[0]:null}},{key:"lastChild",get:function(){return this.content.length?this.content[this.content.length-1]:null}},{key:"childCount",get:function(){return this.content.length}},{key:"child",value:function(e){var t=this.content[e];if(!t)throw new RangeError("Index "+e+" out of range for "+this);return t}},{key:"maybeChild",value:function(e){return this.content[e]||null}},{key:"forEach",value:function(e){for(var t=0,n=0;t<this.content.length;t++){var r=this.content[t];e(r,n,t),n+=r.nodeSize}}},{key:"findDiffStart",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;return w(this,e,t)}},{key:"findDiffEnd",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this.size,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:e.size;return b(this,e,t,n)}},{key:"findIndex",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:-1;if(0==e)return M(0,e);if(e==this.size)return M(this.content.length,e);if(e>this.size||e<0)throw new RangeError("Position ".concat(e," outside of fragment (").concat(this,")"));for(var n=0,r=0;;n++){var o=this.child(n),i=r+o.nodeSize;if(i>=e)return i==e||t>0?M(n+1,i):M(n,r);r=i}}},{key:"toString",value:function(){return"<"+this.toStringInner()+">"}},{key:"toStringInner",value:function(){return this.content.join(", ")}},{key:"toJSON",value:function(){return this.content.length?this.content.map((function(e){return e.toJSON()})):null}}],[{key:"fromJSON",value:function(t,n){if(!n)return e.empty;if(!Array.isArray(n))throw new RangeError("Invalid input for Fragment.fromJSON");return new e(n.map(t.nodeFromJSON))}},{key:"fromArray",value:function(t){if(!t.length)return e.empty;for(var n,r=0,o=0;o<t.length;o++){var i=t[o];r+=i.nodeSize,o&&i.isText&&t[o-1].sameMarkup(i)?(n||(n=t.slice(0,o)),n[n.length-1]=i.withText(n[n.length-1].text+i.text)):n&&n.push(i)}return new e(n||t,r)}},{key:"from",value:function(t){if(!t)return e.empty;if(t instanceof e)return t;if(Array.isArray(t))return this.fromArray(t);if(t.attrs)return new e([t],t.nodeSize);throw new RangeError("Can not convert "+t+" to a Fragment"+(t.nodesBetween?" (looks like multiple versions of prosemirror-model were loaded)":""))}}]),e}();S.empty=new S([],0);var x={index:0,offset:0};function M(e,t){return x.index=e,x.offset=t,x}function O(e,t){if(e===t)return!0;if(!e||"object"!=y(e)||!t||"object"!=y(t))return!1;var n=Array.isArray(e);if(Array.isArray(t)!=n)return!1;if(n){if(e.length!=t.length)return!1;for(var r=0;r<e.length;r++)if(!O(e[r],t[r]))return!1}else{for(var o in e)if(!(o in t)||!O(e[o],t[o]))return!1;for(var i in t)if(!(i in e))return!1}return!0}var C=function(){function e(t,n){p(this,e),this.type=t,this.attrs=n}return m(e,[{key:"addToSet",value:function(e){for(var t,n=!1,r=0;r<e.length;r++){var o=e[r];if(this.eq(o))return e;if(this.type.excludes(o.type))t||(t=e.slice(0,r));else{if(o.type.excludes(this.type))return e;!n&&o.type.rank>this.type.rank&&(t||(t=e.slice(0,r)),t.push(this),n=!0),t&&t.push(o)}}return t||(t=e.slice()),n||t.push(this),t}},{key:"removeFromSet",value:function(e){for(var t=0;t<e.length;t++)if(this.eq(e[t]))return e.slice(0,t).concat(e.slice(t+1));return e}},{key:"isInSet",value:function(e){for(var t=0;t<e.length;t++)if(this.eq(e[t]))return!0;return!1}},{key:"eq",value:function(e){return this==e||this.type==e.type&&O(this.attrs,e.attrs)}},{key:"toJSON",value:function(){var e={type:this.type.name};for(var t in this.attrs){e.attrs=this.attrs;break}return e}}],[{key:"fromJSON",value:function(e,t){if(!t)throw new RangeError("Invalid input for Mark.fromJSON");var n=e.marks[t.type];if(!n)throw new RangeError("There is no mark type ".concat(t.type," in this schema"));return n.create(t.attrs)}},{key:"sameSet",value:function(e,t){if(e==t)return!0;if(e.length!=t.length)return!1;for(var n=0;n<e.length;n++)if(!e[n].eq(t[n]))return!1;return!0}},{key:"setFrom",value:function(t){if(!t||Array.isArray(t)&&0==t.length)return e.none;if(t instanceof e)return[t];var n=t.slice();return n.sort((function(e,t){return e.type.rank-t.type.rank})),n}}]),e}();C.none=[];var N=function(e){s(n,e);var t=a(n);function n(){return p(this,n),t.apply(this,arguments)}return m(n)}(c(Error)),T=function(){function e(t,n,r){p(this,e),this.content=t,this.openStart=n,this.openEnd=r}return m(e,[{key:"size",get:function(){return this.content.size-this.openStart-this.openEnd}},{key:"insertAt",value:function(t,n){var r=E(this.content,t+this.openStart,n);return r&&new e(r,this.openStart,this.openEnd)}},{key:"removeBetween",value:function(t,n){return new e(D(this.content,t+this.openStart,n+this.openStart),this.openStart,this.openEnd)}},{key:"eq",value:function(e){return this.content.eq(e.content)&&this.openStart==e.openStart&&this.openEnd==e.openEnd}},{key:"toString",value:function(){return this.content+"("+this.openStart+","+this.openEnd+")"}},{key:"toJSON",value:function(){if(!this.content.size)return null;var e={content:this.content.toJSON()};return this.openStart>0&&(e.openStart=this.openStart),this.openEnd>0&&(e.openEnd=this.openEnd),e}}],[{key:"fromJSON",value:function(t,n){if(!n)return e.empty;var r=n.openStart||0,o=n.openEnd||0;if("number"!=typeof r||"number"!=typeof o)throw new RangeError("Invalid input for Slice.fromJSON");return new e(S.fromJSON(t,n.content),r,o)}},{key:"maxOpen",value:function(t){for(var n=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],r=0,o=0,i=t.firstChild;i&&!i.isLeaf&&(n||!i.type.spec.isolating);i=i.firstChild)r++;for(var s=t.lastChild;s&&!s.isLeaf&&(n||!s.type.spec.isolating);s=s.lastChild)o++;return new e(t,r,o)}}]),e}();function D(e,t,n){var r=e.findIndex(t),o=r.index,i=r.offset,s=e.maybeChild(o),a=e.findIndex(n),l=a.index,c=a.offset;if(i==t||s.isText){if(c!=n&&!e.child(l).isText)throw new RangeError("Removing non-flat range");return e.cut(0,t).append(e.cut(n))}if(o!=l)throw new RangeError("Removing non-flat range");return e.replaceChild(o,s.copy(D(s.content,t-i-1,n-i-1)))}function E(e,t,n,r){var o=e.findIndex(t),i=o.index,s=o.offset,a=e.maybeChild(i);if(s==t||a.isText)return r&&!r.canReplace(i,i,n)?null:e.cut(0,t).append(n).append(e.cut(t));var l=E(a.content,t-s-1,n);return l&&e.replaceChild(i,a.copy(l))}function A(e,t,n){if(n.openStart>e.depth)throw new N("Inserted content deeper than insertion position");if(e.depth-n.openStart!=t.depth-n.openEnd)throw new N("Inconsistent open depths");return P(e,t,n,0)}function P(e,t,n,r){var o=e.index(r),i=e.node(r);if(o==t.index(r)&&r<e.depth-n.openStart){var s=P(e,t,n,r+1);return i.copy(i.content.replaceChild(o,s))}if(n.content.size){if(n.openStart||n.openEnd||e.depth!=r||t.depth!=r){var a=function(e,t){for(var n=t.depth-e.openStart,r=t.node(n).copy(e.content),o=n-1;o>=0;o--)r=t.node(o).copy(S.from(r));return{start:r.resolveNoCache(e.openStart+n),end:r.resolveNoCache(r.content.size-e.openEnd-n)}}(n,e);return B(i,V(e,a.start,a.end,t,r))}var l=e.parent,c=l.content;return B(l,c.cut(0,e.parentOffset).append(n.content).append(c.cut(t.parentOffset)))}return B(i,j(e,t,r))}function R(e,t){if(!t.type.compatibleContent(e.type))throw new N("Cannot join "+t.type.name+" onto "+e.type.name)}function I(e,t,n){var r=e.node(n);return R(r,t.node(n)),r}function z(e,t){var n=t.length-1;n>=0&&e.isText&&e.sameMarkup(t[n])?t[n]=e.withText(t[n].text+e.text):t.push(e)}function F(e,t,n,r){var o=(t||e).node(n),i=0,s=t?t.index(n):o.childCount;e&&(i=e.index(n),e.depth>n?i++:e.textOffset&&(z(e.nodeAfter,r),i++));for(var a=i;a<s;a++)z(o.child(a),r);t&&t.depth==n&&t.textOffset&&z(t.nodeBefore,r)}function B(e,t){return e.type.checkContent(t),e.copy(t)}function V(e,t,n,r,o){var i=e.depth>o&&I(e,t,o+1),s=r.depth>o&&I(n,r,o+1),a=[];return F(null,e,o,a),i&&s&&t.index(o)==n.index(o)?(R(i,s),z(B(i,V(e,t,n,r,o+1)),a)):(i&&z(B(i,j(e,t,o+1)),a),F(t,n,o,a),s&&z(B(s,j(n,r,o+1)),a)),F(r,null,o,a),new S(a)}function j(e,t,n){var r=[];return F(null,e,n,r),e.depth>n&&z(B(I(e,t,n+1),j(e,t,n+1)),r),F(t,null,n,r),new S(r)}T.empty=new T(S.empty,0,0);var $=function(){function e(t,n,r){p(this,e),this.pos=t,this.path=n,this.parentOffset=r,this.depth=n.length/3-1}return m(e,[{key:"resolveDepth",value:function(e){return null==e?this.depth:e<0?this.depth+e:e}},{key:"parent",get:function(){return this.node(this.depth)}},{key:"doc",get:function(){return this.node(0)}},{key:"node",value:function(e){return this.path[3*this.resolveDepth(e)]}},{key:"index",value:function(e){return this.path[3*this.resolveDepth(e)+1]}},{key:"indexAfter",value:function(e){return e=this.resolveDepth(e),this.index(e)+(e!=this.depth||this.textOffset?1:0)}},{key:"start",value:function(e){return 0==(e=this.resolveDepth(e))?0:this.path[3*e-1]+1}},{key:"end",value:function(e){return e=this.resolveDepth(e),this.start(e)+this.node(e).content.size}},{key:"before",value:function(e){if(!(e=this.resolveDepth(e)))throw new RangeError("There is no position before the top-level node");return e==this.depth+1?this.pos:this.path[3*e-1]}},{key:"after",value:function(e){if(!(e=this.resolveDepth(e)))throw new RangeError("There is no position after the top-level node");return e==this.depth+1?this.pos:this.path[3*e-1]+this.path[3*e].nodeSize}},{key:"textOffset",get:function(){return this.pos-this.path[this.path.length-1]}},{key:"nodeAfter",get:function(){var e=this.parent,t=this.index(this.depth);if(t==e.childCount)return null;var n=this.pos-this.path[this.path.length-1],r=e.child(t);return n?e.child(t).cut(n):r}},{key:"nodeBefore",get:function(){var e=this.index(this.depth),t=this.pos-this.path[this.path.length-1];return t?this.parent.child(e).cut(0,t):0==e?null:this.parent.child(e-1)}},{key:"posAtIndex",value:function(e,t){t=this.resolveDepth(t);for(var n=this.path[3*t],r=0==t?0:this.path[3*t-1]+1,o=0;o<e;o++)r+=n.child(o).nodeSize;return r}},{key:"marks",value:function(){var e=this.parent,t=this.index();if(0==e.content.size)return C.none;if(this.textOffset)return e.child(t).marks;var n=e.maybeChild(t-1),r=e.maybeChild(t);if(!n){var o=n;n=r,r=o}for(var i=n.marks,s=0;s<i.length;s++)!1!==i[s].type.spec.inclusive||r&&i[s].isInSet(r.marks)||(i=i[s--].removeFromSet(i));return i}},{key:"marksAcross",value:function(e){var t=this.parent.maybeChild(this.index());if(!t||!t.isInline)return null;for(var n=t.marks,r=e.parent.maybeChild(e.index()),o=0;o<n.length;o++)!1!==n[o].type.spec.inclusive||r&&n[o].isInSet(r.marks)||(n=n[o--].removeFromSet(n));return n}},{key:"sharedDepth",value:function(e){for(var t=this.depth;t>0;t--)if(this.start(t)<=e&&this.end(t)>=e)return t;return 0}},{key:"blockRange",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this,t=arguments.length>1?arguments[1]:void 0;if(e.pos<this.pos)return e.blockRange(this);for(var n=this.depth-(this.parent.inlineContent||this.pos==e.pos?1:0);n>=0;n--)if(e.pos<=this.end(n)&&(!t||t(this.node(n))))return new J(this,e,n);return null}},{key:"sameParent",value:function(e){return this.pos-this.parentOffset==e.pos-e.parentOffset}},{key:"max",value:function(e){return e.pos>this.pos?e:this}},{key:"min",value:function(e){return e.pos<this.pos?e:this}},{key:"toString",value:function(){for(var e="",t=1;t<=this.depth;t++)e+=(e?"/":"")+this.node(t).type.name+"_"+this.index(t-1);return e+":"+this.parentOffset}}],[{key:"resolve",value:function(t,n){if(!(n>=0&&n<=t.content.size))throw new RangeError("Position "+n+" out of range");for(var r=[],o=0,i=n,s=t;;){var a=s.content.findIndex(i),l=a.index,c=a.offset,u=i-c;if(r.push(s,l,o+c),!u)break;if((s=s.child(l)).isText)break;i=u-1,o+=c+1}return new e(n,r,i)}},{key:"resolveCached",value:function(t,n){for(var r=0;r<q.length;r++){var o=q[r];if(o.pos==n&&o.doc==t)return o}var i=q[_]=e.resolve(t,n);return _=(_+1)%L,i}}]),e}(),q=[],_=0,L=12,J=function(){function e(t,n,r){p(this,e),this.$from=t,this.$to=n,this.depth=r}return m(e,[{key:"start",get:function(){return this.$from.before(this.depth+1)}},{key:"end",get:function(){return this.$to.after(this.depth+1)}},{key:"parent",get:function(){return this.$from.node(this.depth)}},{key:"startIndex",get:function(){return this.$from.index(this.depth)}},{key:"endIndex",get:function(){return this.$to.indexAfter(this.depth)}}]),e}(),W=Object.create(null),K=function(){function e(t,n,r){var o=arguments.length>3&&void 0!==arguments[3]?arguments[3]:C.none;p(this,e),this.type=t,this.attrs=n,this.marks=o,this.content=r||S.empty}return m(e,[{key:"nodeSize",get:function(){return this.isLeaf?1:2+this.content.size}},{key:"childCount",get:function(){return this.content.childCount}},{key:"child",value:function(e){return this.content.child(e)}},{key:"maybeChild",value:function(e){return this.content.maybeChild(e)}},{key:"forEach",value:function(e){this.content.forEach(e)}},{key:"nodesBetween",value:function(e,t,n){var r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0;this.content.nodesBetween(e,t,n,r,this)}},{key:"descendants",value:function(e){this.nodesBetween(0,this.content.size,e)}},{key:"textContent",get:function(){return this.isLeaf&&this.type.spec.leafText?this.type.spec.leafText(this):this.textBetween(0,this.content.size,"")}},{key:"textBetween",value:function(e,t,n,r){return this.content.textBetween(e,t,n,r)}},{key:"firstChild",get:function(){return this.content.firstChild}},{key:"lastChild",get:function(){return this.content.lastChild}},{key:"eq",value:function(e){return this==e||this.sameMarkup(e)&&this.content.eq(e.content)}},{key:"sameMarkup",value:function(e){return this.hasMarkup(e.type,e.attrs,e.marks)}},{key:"hasMarkup",value:function(e,t,n){return this.type==e&&O(this.attrs,t||e.defaultAttrs||W)&&C.sameSet(this.marks,n||C.none)}},{key:"copy",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;return t==this.content?this:new e(this.type,this.attrs,t,this.marks)}},{key:"mark",value:function(t){return t==this.marks?this:new e(this.type,this.attrs,this.content,t)}},{key:"cut",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this.content.size;return 0==e&&t==this.content.size?this:this.copy(this.content.cut(e,t))}},{key:"slice",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this.content.size,n=arguments.length>2&&void 0!==arguments[2]&&arguments[2];if(e==t)return T.empty;var r=this.resolve(e),o=this.resolve(t),i=n?0:r.sharedDepth(t),s=r.start(i),a=r.node(i),l=a.content.cut(r.pos-s,o.pos-s);return new T(l,r.depth-i,o.depth-i)}},{key:"replace",value:function(e,t,n){return A(this.resolve(e),this.resolve(t),n)}},{key:"nodeAt",value:function(e){for(var t=this;;){var n=t.content.findIndex(e),r=n.index,o=n.offset;if(!(t=t.maybeChild(r)))return null;if(o==e||t.isText)return t;e-=o+1}}},{key:"childAfter",value:function(e){var t=this.content.findIndex(e),n=t.index,r=t.offset;return{node:this.content.maybeChild(n),index:n,offset:r}}},{key:"childBefore",value:function(e){if(0==e)return{node:null,index:0,offset:0};var t=this.content.findIndex(e),n=t.index,r=t.offset;if(r<e)return{node:this.content.child(n),index:n,offset:r};var o=this.content.child(n-1);return{node:o,index:n-1,offset:r-o.nodeSize}}},{key:"resolve",value:function(e){return $.resolveCached(this,e)}},{key:"resolveNoCache",value:function(e){return $.resolve(this,e)}},{key:"rangeHasMark",value:function(e,t,n){var r=!1;return t>e&&this.nodesBetween(e,t,(function(e){return n.isInSet(e.marks)&&(r=!0),!r})),r}},{key:"isBlock",get:function(){return this.type.isBlock}},{key:"isTextblock",get:function(){return this.type.isTextblock}},{key:"inlineContent",get:function(){return this.type.inlineContent}},{key:"isInline",get:function(){return this.type.isInline}},{key:"isText",get:function(){return this.type.isText}},{key:"isLeaf",get:function(){return this.type.isLeaf}},{key:"isAtom",get:function(){return this.type.isAtom}},{key:"toString",value:function(){if(this.type.spec.toDebugString)return this.type.spec.toDebugString(this);var e=this.type.name;return this.content.size&&(e+="("+this.content.toStringInner()+")"),U(this.marks,e)}},{key:"contentMatchAt",value:function(e){var t=this.type.contentMatch.matchFragment(this.content,0,e);if(!t)throw new Error("Called contentMatchAt on a node with invalid content");return t}},{key:"canReplace",value:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:S.empty,r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0,o=arguments.length>4&&void 0!==arguments[4]?arguments[4]:n.childCount,i=this.contentMatchAt(e).matchFragment(n,r,o),s=i&&i.matchFragment(this.content,t);if(!s||!s.validEnd)return!1;for(var a=r;a<o;a++)if(!this.type.allowsMarks(n.child(a).marks))return!1;return!0}},{key:"canReplaceWith",value:function(e,t,n,r){if(r&&!this.type.allowsMarks(r))return!1;var o=this.contentMatchAt(e).matchType(n),i=o&&o.matchFragment(this.content,t);return!!i&&i.validEnd}},{key:"canAppend",value:function(e){return e.content.size?this.canReplace(this.childCount,this.childCount,e.content):this.type.compatibleContent(e.type)}},{key:"check",value:function(){this.type.checkContent(this.content);for(var e=C.none,t=0;t<this.marks.length;t++)e=this.marks[t].addToSet(e);if(!C.sameSet(e,this.marks))throw new RangeError("Invalid collection of marks for node ".concat(this.type.name,": ").concat(this.marks.map((function(e){return e.type.name}))));this.content.forEach((function(e){return e.check()}))}},{key:"toJSON",value:function(){var e={type:this.type.name};for(var t in this.attrs){e.attrs=this.attrs;break}return this.content.size&&(e.content=this.content.toJSON()),this.marks.length&&(e.marks=this.marks.map((function(e){return e.toJSON()}))),e}}],[{key:"fromJSON",value:function(e,t){if(!t)throw new RangeError("Invalid input for Node.fromJSON");var n=null;if(t.marks){if(!Array.isArray(t.marks))throw new RangeError("Invalid mark data for Node.fromJSON");n=t.marks.map(e.markFromJSON)}if("text"==t.type){if("string"!=typeof t.text)throw new RangeError("Invalid text node in JSON");return e.text(t.text,n)}var r=S.fromJSON(e,t.content);return e.nodeType(t.type).create(t.attrs,r,n)}}]),e}();K.prototype.text=void 0;var H=function(e){s(n,e);var t=a(n);function n(e,r,o,i){var s;if(p(this,n),s=t.call(this,e,r,null,i),!o)throw new RangeError("Empty text nodes are not allowed");return s.text=o,s}return m(n,[{key:"toString",value:function(){return this.type.spec.toDebugString?this.type.spec.toDebugString(this):U(this.marks,JSON.stringify(this.text))}},{key:"textContent",get:function(){return this.text}},{key:"textBetween",value:function(e,t){return this.text.slice(e,t)}},{key:"nodeSize",get:function(){return this.text.length}},{key:"mark",value:function(e){return e==this.marks?this:new n(this.type,this.attrs,this.text,e)}},{key:"withText",value:function(e){return e==this.text?this:new n(this.type,this.attrs,e,this.marks)}},{key:"cut",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this.text.length;return 0==e&&t==this.text.length?this:this.withText(this.text.slice(e,t))}},{key:"eq",value:function(e){return this.sameMarkup(e)&&this.text==e.text}},{key:"toJSON",value:function(){var e=o(d(n.prototype),"toJSON",this).call(this);return e.text=this.text,e}}]),n}(K);function U(e,t){for(var n=e.length-1;n>=0;n--)t=e[n].type.name+"("+t+")";return t}var G=function(){function e(t){p(this,e),this.validEnd=t,this.next=[],this.wrapCache=[]}return m(e,[{key:"matchType",value:function(e){for(var t=0;t<this.next.length;t++)if(this.next[t].type==e)return this.next[t].next;return null}},{key:"matchFragment",value:function(e){for(var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:e.childCount,r=this,o=t;r&&o<n;o++)r=r.matchType(e.child(o).type);return r}},{key:"inlineContent",get:function(){return 0!=this.next.length&&this.next[0].type.isInline}},{key:"defaultType",get:function(){for(var e=0;e<this.next.length;e++){var t=this.next[e].type;if(!t.isText&&!t.hasRequiredAttrs())return t}return null}},{key:"compatible",value:function(e){for(var t=0;t<this.next.length;t++)for(var n=0;n<e.next.length;n++)if(this.next[t].type==e.next[n].type)return!0;return!1}},{key:"fillBefore",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,r=[this];function o(i,s){var a=i.matchFragment(e,n);if(a&&(!t||a.validEnd))return S.from(s.map((function(e){return e.createAndFill()})));for(var l=0;l<i.next.length;l++){var c=i.next[l],u=c.type,f=c.next;if(!u.isText&&!u.hasRequiredAttrs()&&-1==r.indexOf(f)){r.push(f);var h=o(f,s.concat(u));if(h)return h}}return null}return o(this,[])}},{key:"findWrapping",value:function(e){for(var t=0;t<this.wrapCache.length;t+=2)if(this.wrapCache[t]==e)return this.wrapCache[t+1];var n=this.computeWrapping(e);return this.wrapCache.push(e,n),n}},{key:"computeWrapping",value:function(e){for(var t=Object.create(null),n=[{match:this,type:null,via:null}];n.length;){var r=n.shift(),o=r.match;if(o.matchType(e)){for(var i=[],s=r;s.type;s=s.via)i.push(s.type);return i.reverse()}for(var a=0;a<o.next.length;a++){var l=o.next[a],c=l.type,u=l.next;c.isLeaf||c.hasRequiredAttrs()||c.name in t||r.type&&!u.validEnd||(n.push({match:c.contentMatch,type:c,via:r}),t[c.name]=!0)}}return null}},{key:"edgeCount",get:function(){return this.next.length}},{key:"edge",value:function(e){if(e>=this.next.length)throw new RangeError("There's no ".concat(e,"th edge in this content match"));return this.next[e]}},{key:"toString",value:function(){var e=[];return function t(n){e.push(n);for(var r=0;r<n.next.length;r++)-1==e.indexOf(n.next[r].next)&&t(n.next[r].next)}(this),e.map((function(t,n){for(var r=n+(t.validEnd?"*":" ")+" ",o=0;o<t.next.length;o++)r+=(o?", ":"")+t.next[o].type.name+"->"+e.indexOf(t.next[o].next);return r})).join("\n")}}],[{key:"parse",value:function(t,n){var r=new Z(t,n);if(null==r.next)return e.empty;var o=Q(r);r.next&&r.err("Unexpected trailing text");var i=oe(function(e){var t=[[]];return o(function e(t,i){if("choice"==t.type)return t.exprs.reduce((function(t,n){return t.concat(e(n,i))}),[]);if("seq"!=t.type){if("star"==t.type){var s=n();return r(i,s),o(e(t.expr,s),s),[r(s)]}if("plus"==t.type){var a=n();return o(e(t.expr,i),a),o(e(t.expr,a),a),[r(a)]}if("opt"==t.type)return[r(i)].concat(e(t.expr,i));if("range"==t.type){for(var l=i,c=0;c<t.min;c++){var u=n();o(e(t.expr,l),u),l=u}if(-1==t.max)o(e(t.expr,l),l);else for(var f=t.min;f<t.max;f++){var h=n();r(l,h),o(e(t.expr,l),h),l=h}return[r(l)]}if("name"==t.type)return[r(i,void 0,t.value)];throw new Error("Unknown expr type")}for(var d=0;;d++){var p=e(t.exprs[d],i);if(d==t.exprs.length-1)return p;o(p,i=n())}}(e,0),n()),t;function n(){return t.push([])-1}function r(e,n,r){var o={term:r,to:n};return t[e].push(o),o}function o(e,t){e.forEach((function(e){return e.to=t}))}}(o));return function(e,t){for(var n=0,r=[e];n<r.length;n++){for(var o=r[n],i=!o.validEnd,s=[],a=0;a<o.next.length;a++){var l=o.next[a],c=l.type,u=l.next;s.push(c.name),!i||c.isText||c.hasRequiredAttrs()||(i=!1),-1==r.indexOf(u)&&r.push(u)}i&&t.err("Only non-generatable nodes ("+s.join(", ")+") in a required position (see https://prosemirror.net/docs/guide/#generatable)")}}(i,r),i}}]),e}();G.empty=new G(!0);var Z=function(){function e(t,n){p(this,e),this.string=t,this.nodeTypes=n,this.inline=null,this.pos=0,this.tokens=t.split(/\s*(?=\b|\W|$)/),""==this.tokens[this.tokens.length-1]&&this.tokens.pop(),""==this.tokens[0]&&this.tokens.shift()}return m(e,[{key:"next",get:function(){return this.tokens[this.pos]}},{key:"eat",value:function(e){return this.next==e&&(this.pos++||!0)}},{key:"err",value:function(e){throw new SyntaxError(e+" (in content expression '"+this.string+"')")}}]),e}();function Q(e){var t=[];do{t.push(X(e))}while(e.eat("|"));return 1==t.length?t[0]:{type:"choice",exprs:t}}function X(e){var t=[];do{t.push(Y(e))}while(e.next&&")"!=e.next&&"|"!=e.next);return 1==t.length?t[0]:{type:"seq",exprs:t}}function Y(e){for(var t=function(e){if(e.eat("(")){var t=Q(e);return e.eat(")")||e.err("Missing closing paren"),t}if(!/\W/.test(e.next)){var n=function(e,t){var n=e.nodeTypes,r=n[t];if(r)return[r];var o=[];for(var i in n){var s=n[i];s.groups.indexOf(t)>-1&&o.push(s)}return 0==o.length&&e.err("No node type or group '"+t+"' found"),o}(e,e.next).map((function(t){return null==e.inline?e.inline=t.isInline:e.inline!=t.isInline&&e.err("Mixing inline and block content"),{type:"name",value:t}}));return e.pos++,1==n.length?n[0]:{type:"choice",exprs:n}}e.err("Unexpected token '"+e.next+"'")}(e);;)if(e.eat("+"))t={type:"plus",expr:t};else if(e.eat("*"))t={type:"star",expr:t};else if(e.eat("?"))t={type:"opt",expr:t};else{if(!e.eat("{"))break;t=te(e,t)}return t}function ee(e){/\D/.test(e.next)&&e.err("Expected number, got '"+e.next+"'");var t=Number(e.next);return e.pos++,t}function te(e,t){var n=ee(e),r=n;return e.eat(",")&&(r="}"!=e.next?ee(e):-1),e.eat("}")||e.err("Unclosed braced range"),{type:"range",min:n,max:r,expr:t}}function ne(e,t){return t-e}function re(e,t){var n=[];return function t(r){var o=e[r];if(1==o.length&&!o[0].term)return t(o[0].to);n.push(r);for(var i=0;i<o.length;i++){var s=o[i],a=s.term,l=s.to;a||-1!=n.indexOf(l)||t(l)}}(t),n.sort(ne)}function oe(e){var t=Object.create(null);return function n(r){var o=[];r.forEach((function(t){e[t].forEach((function(t){var n=t.term,r=t.to;if(n){for(var i,s=0;s<o.length;s++)o[s][0]==n&&(i=o[s][1]);re(e,r).forEach((function(e){i||o.push([n,i=[]]),-1==i.indexOf(e)&&i.push(e)}))}}))}));for(var i=t[r.join(",")]=new G(r.indexOf(e.length-1)>-1),s=0;s<o.length;s++){var a=o[s][1].sort(ne);i.next.push({type:o[s][0],next:t[a.join(",")]||n(a)})}return i}(re(e,0))}function ie(e){var t=Object.create(null);for(var n in e){var r=e[n];if(!r.hasDefault)return null;t[n]=r.default}return t}function se(e,t){var n=Object.create(null);for(var r in e){var o=t&&t[r];if(void 0===o){var i=e[r];if(!i.hasDefault)throw new RangeError("No value supplied for attribute "+r);o=i.default}n[r]=o}return n}function ae(e){var t=Object.create(null);if(e)for(var n in e)t[n]=new ce(e[n]);return t}var le=function(){function e(t,n,r){p(this,e),this.name=t,this.schema=n,this.spec=r,this.markSet=null,this.groups=r.group?r.group.split(" "):[],this.attrs=ae(r.attrs),this.defaultAttrs=ie(this.attrs),this.contentMatch=null,this.inlineContent=null,this.isBlock=!(r.inline||"text"==t),this.isText="text"==t}return m(e,[{key:"isInline",get:function(){return!this.isBlock}},{key:"isTextblock",get:function(){return this.isBlock&&this.inlineContent}},{key:"isLeaf",get:function(){return this.contentMatch==G.empty}},{key:"isAtom",get:function(){return this.isLeaf||!!this.spec.atom}},{key:"whitespace",get:function(){return this.spec.whitespace||(this.spec.code?"pre":"normal")}},{key:"hasRequiredAttrs",value:function(){for(var e in this.attrs)if(this.attrs[e].isRequired)return!0;return!1}},{key:"compatibleContent",value:function(e){return this==e||this.contentMatch.compatible(e.contentMatch)}},{key:"computeAttrs",value:function(e){return!e&&this.defaultAttrs?this.defaultAttrs:se(this.attrs,e)}},{key:"create",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,t=arguments.length>1?arguments[1]:void 0,n=arguments.length>2?arguments[2]:void 0;if(this.isText)throw new Error("NodeType.create can't construct text nodes");return new K(this,this.computeAttrs(e),S.from(t),C.setFrom(n))}},{key:"createChecked",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,t=arguments.length>1?arguments[1]:void 0,n=arguments.length>2?arguments[2]:void 0;return t=S.from(t),this.checkContent(t),new K(this,this.computeAttrs(e),t,C.setFrom(n))}},{key:"createAndFill",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,t=arguments.length>1?arguments[1]:void 0,n=arguments.length>2?arguments[2]:void 0;if(e=this.computeAttrs(e),(t=S.from(t)).size){var r=this.contentMatch.fillBefore(t);if(!r)return null;t=r.append(t)}var o=this.contentMatch.matchFragment(t),i=o&&o.fillBefore(S.empty,!0);return i?new K(this,e,t.append(i),C.setFrom(n)):null}},{key:"validContent",value:function(e){var t=this.contentMatch.matchFragment(e);if(!t||!t.validEnd)return!1;for(var n=0;n<e.childCount;n++)if(!this.allowsMarks(e.child(n).marks))return!1;return!0}},{key:"checkContent",value:function(e){if(!this.validContent(e))throw new RangeError("Invalid content for node ".concat(this.name,": ").concat(e.toString().slice(0,50)))}},{key:"allowsMarkType",value:function(e){return null==this.markSet||this.markSet.indexOf(e)>-1}},{key:"allowsMarks",value:function(e){if(null==this.markSet)return!0;for(var t=0;t<e.length;t++)if(!this.allowsMarkType(e[t].type))return!1;return!0}},{key:"allowedMarks",value:function(e){if(null==this.markSet)return e;for(var t,n=0;n<e.length;n++)this.allowsMarkType(e[n].type)?t&&t.push(e[n]):t||(t=e.slice(0,n));return t?t.length?t:C.none:e}}],[{key:"compile",value:function(t,n){var r=Object.create(null);t.forEach((function(t,o){return r[t]=new e(t,n,o)}));var o=n.spec.topNode||"doc";if(!r[o])throw new RangeError("Schema is missing its top node type ('"+o+"')");if(!r.text)throw new RangeError("Every schema needs a 'text' type");for(var i in r.text.attrs)throw new RangeError("The text node type should not have attributes");return r}}]),e}(),ce=function(){function e(t){p(this,e),this.hasDefault=Object.prototype.hasOwnProperty.call(t,"default"),this.default=t.default}return m(e,[{key:"isRequired",get:function(){return!this.hasDefault}}]),e}(),ue=function(){function e(t,n,r,o){p(this,e),this.name=t,this.rank=n,this.schema=r,this.spec=o,this.attrs=ae(o.attrs),this.excluded=null;var i=ie(this.attrs);this.instance=i?new C(this,i):null}return m(e,[{key:"create",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;return!e&&this.instance?this.instance:new C(this,se(this.attrs,e))}},{key:"removeFromSet",value:function(e){for(var t=0;t<e.length;t++)e[t].type==this&&(e=e.slice(0,t).concat(e.slice(t+1)),t--);return e}},{key:"isInSet",value:function(e){for(var t=0;t<e.length;t++)if(e[t].type==this)return e[t]}},{key:"excludes",value:function(e){return this.excluded.indexOf(e)>-1}}],[{key:"compile",value:function(t,n){var r=Object.create(null),o=0;return t.forEach((function(t,i){return r[t]=new e(t,o++,n,i)})),r}}]),e}(),fe=function(){function e(t){p(this,e),this.cached=Object.create(null);var n=this.spec={};for(var r in t)n[r]=t[r];n.nodes=k.default.from(t.nodes),n.marks=k.default.from(t.marks||{}),this.nodes=le.compile(this.spec.nodes,this),this.marks=ue.compile(this.spec.marks,this);var o=Object.create(null);for(var i in this.nodes){if(i in this.marks)throw new RangeError(i+" can not be both a node and a mark");var s=this.nodes[i],a=s.spec.content||"",l=s.spec.marks;s.contentMatch=o[a]||(o[a]=G.parse(a,this.nodes)),s.inlineContent=s.contentMatch.inlineContent,s.markSet="_"==l?null:l?he(this,l.split(" ")):""!=l&&s.inlineContent?null:[]}for(var c in this.marks){var u=this.marks[c],f=u.spec.excludes;u.excluded=null==f?[u]:""==f?[]:he(this,f.split(" "))}this.nodeFromJSON=this.nodeFromJSON.bind(this),this.markFromJSON=this.markFromJSON.bind(this),this.topNodeType=this.nodes[this.spec.topNode||"doc"],this.cached.wrappings=Object.create(null)}return m(e,[{key:"node",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,n=arguments.length>2?arguments[2]:void 0,r=arguments.length>3?arguments[3]:void 0;if("string"==typeof e)e=this.nodeType(e);else{if(!(e instanceof le))throw new RangeError("Invalid node type: "+e);if(e.schema!=this)throw new RangeError("Node type from different schema used ("+e.name+")")}return e.createChecked(t,n,r)}},{key:"text",value:function(e,t){var n=this.nodes.text;return new H(n,n.defaultAttrs,e,C.setFrom(t))}},{key:"mark",value:function(e,t){return"string"==typeof e&&(e=this.marks[e]),e.create(t)}},{key:"nodeFromJSON",value:function(e){return K.fromJSON(this,e)}},{key:"markFromJSON",value:function(e){return C.fromJSON(this,e)}},{key:"nodeType",value:function(e){var t=this.nodes[e];if(!t)throw new RangeError("Unknown node type: "+e);return t}}]),e}();function he(e,t){for(var n=[],r=0;r<t.length;r++){var o=t[r],i=e.marks[o],s=i;if(i)n.push(i);else for(var a in e.marks){var l=e.marks[a];("_"==o||l.spec.group&&l.spec.group.split(" ").indexOf(o)>-1)&&n.push(s=l)}if(!s)throw new SyntaxError("Unknown mark type: '"+t[r]+"'")}return n}var de=function(){function e(t,n){var r=this;p(this,e),this.schema=t,this.rules=n,this.tags=[],this.styles=[],n.forEach((function(e){e.tag?r.tags.push(e):e.style&&r.styles.push(e)})),this.normalizeLists=!this.tags.some((function(e){if(!/^(ul|ol)\b/.test(e.tag)||!e.node)return!1;var n=t.nodes[e.node];return n.contentMatch.matchType(n)}))}return m(e,[{key:"parse",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=new ke(this,t,!1);return n.addAll(e,t.from,t.to),n.finish()}},{key:"parseSlice",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=new ke(this,t,!0);return n.addAll(e,t.from,t.to),T.maxOpen(n.finish())}},{key:"matchTag",value:function(e,t,n){for(var r=n?this.tags.indexOf(n)+1:0;r<this.tags.length;r++){var o=this.tags[r];if(we(e,o.tag)&&(void 0===o.namespace||e.namespaceURI==o.namespace)&&(!o.context||t.matchesContext(o.context))){if(o.getAttrs){var i=o.getAttrs(e);if(!1===i)continue;o.attrs=i||void 0}return o}}}},{key:"matchStyle",value:function(e,t,n,r){for(var o=r?this.styles.indexOf(r)+1:0;o<this.styles.length;o++){var i=this.styles[o],s=i.style;if(!(0!=s.indexOf(e)||i.context&&!n.matchesContext(i.context)||s.length>e.length&&(61!=s.charCodeAt(e.length)||s.slice(e.length+1)!=t))){if(i.getAttrs){var a=i.getAttrs(t);if(!1===a)continue;i.attrs=a||void 0}return i}}}}],[{key:"schemaRules",value:function(e){var t=[];function n(e){for(var n=null==e.priority?50:e.priority,r=0;r<t.length;r++){var o=t[r];if((null==o.priority?50:o.priority)<n)break}t.splice(r,0,e)}var r=function(t){var r=e.marks[t].spec.parseDOM;r&&r.forEach((function(e){n(e=be(e)),e.mark||e.ignore||e.clearMark||(e.mark=t)}))};for(var o in e.marks)r(o);var i=function(t){var r=e.nodes[t].spec.parseDOM;r&&r.forEach((function(e){n(e=be(e)),e.node||e.ignore||e.mark||(e.node=t)}))};for(var s in e.nodes)i(s);return t}},{key:"fromSchema",value:function(t){return t.cached.domParser||(t.cached.domParser=new e(t,e.schemaRules(t)))}}]),e}(),pe={address:!0,article:!0,aside:!0,blockquote:!0,canvas:!0,dd:!0,div:!0,dl:!0,fieldset:!0,figcaption:!0,figure:!0,footer:!0,form:!0,h1:!0,h2:!0,h3:!0,h4:!0,h5:!0,h6:!0,header:!0,hgroup:!0,hr:!0,li:!0,noscript:!0,ol:!0,output:!0,p:!0,pre:!0,section:!0,table:!0,tfoot:!0,ul:!0},ve={head:!0,noscript:!0,object:!0,script:!0,style:!0,title:!0},me={ol:!0,ul:!0};function ye(e,t,n){return null!=t?(t?1:0)|("full"===t?2:0):e&&"pre"==e.whitespace?3:-5&n}var ge=function(){function e(t,n,r,o,i,s,a){p(this,e),this.type=t,this.attrs=n,this.marks=r,this.pendingMarks=o,this.solid=i,this.options=a,this.content=[],this.activeMarks=C.none,this.stashMarks=[],this.match=s||(4&a?null:t.contentMatch)}return m(e,[{key:"findWrapping",value:function(e){if(!this.match){if(!this.type)return[];var t=this.type.contentMatch.fillBefore(S.from(e));if(!t){var n,r=this.type.contentMatch;return(n=r.findWrapping(e.type))?(this.match=r,n):null}this.match=this.type.contentMatch.matchFragment(t)}return this.match.findWrapping(e.type)}},{key:"finish",value:function(e){if(!(1&this.options)){var t,n=this.content[this.content.length-1];if(n&&n.isText&&(t=/[ \t\r\n\u000c]+$/.exec(n.text))){var r=n;n.text.length==t[0].length?this.content.pop():this.content[this.content.length-1]=r.withText(r.text.slice(0,r.text.length-t[0].length))}}var o=S.from(this.content);return!e&&this.match&&(o=o.append(this.match.fillBefore(S.empty,!0))),this.type?this.type.create(this.attrs,o,this.marks):o}},{key:"popFromStashMark",value:function(e){for(var t=this.stashMarks.length-1;t>=0;t--)if(e.eq(this.stashMarks[t]))return this.stashMarks.splice(t,1)[0]}},{key:"applyPending",value:function(e){for(var t=0,n=this.pendingMarks;t<n.length;t++){var r=n[t];(this.type?this.type.allowsMarkType(r.type):Se(r.type,e))&&!r.isInSet(this.activeMarks)&&(this.activeMarks=r.addToSet(this.activeMarks),this.pendingMarks=r.removeFromSet(this.pendingMarks))}}},{key:"inlineContext",value:function(e){return this.type?this.type.inlineContent:this.content.length?this.content[0].isInline:e.parentNode&&!pe.hasOwnProperty(e.parentNode.nodeName.toLowerCase())}}]),e}(),ke=function(){function e(t,n,r){p(this,e),this.parser=t,this.options=n,this.isOpen=r,this.open=0;var o,i=n.topNode,s=ye(null,n.preserveWhitespace,0)|(r?4:0);o=i?new ge(i.type,i.attrs,C.none,C.none,!0,n.topMatch||i.type.contentMatch,s):new ge(r?null:t.schema.topNodeType,null,C.none,C.none,!0,null,s),this.nodes=[o],this.find=n.findPositions,this.needsBlock=!1}return m(e,[{key:"top",get:function(){return this.nodes[this.open]}},{key:"addDOM",value:function(e){if(3==e.nodeType)this.addTextNode(e);else if(1==e.nodeType){var t=e.getAttribute("style");if(t){var n=this.readStyles(function(e){for(var t,n=/\s*([\w-]+)\s*:\s*([^;]+)/g,r=[];t=n.exec(e);)r.push(t[1],t[2].trim());return r}(t));if(!n)return;for(var o=function(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var n=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=n){var r,o,i=[],s=!0,a=!1;try{for(n=n.call(e);!(s=(r=n.next()).done)&&(i.push(r.value),!t||i.length!==t);s=!0);}catch(e){a=!0,o=e}finally{try{s||null==n.return||n.return()}finally{if(a)throw o}}return i}}(e,t)||function(e,t){if(e){if("string"==typeof e)return r(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?r(e,t):void 0}}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}(n,2),i=o[0],s=o[1],a=this.top,l=0;l<s.length;l++)this.removePendingMark(s[l],a);for(var c=0;c<i.length;c++)this.addPendingMark(i[c]);this.addElement(e);for(var u=0;u<i.length;u++)this.removePendingMark(i[u],a);for(var f=0;f<s.length;f++)this.addPendingMark(s[f])}else this.addElement(e)}}},{key:"addTextNode",value:function(e){var t=e.nodeValue,n=this.top;if(2&n.options||n.inlineContext(e)||/[^ \t\r\n\u000c]/.test(t)){if(1&n.options)t=2&n.options?t.replace(/\r\n?/g,"\n"):t.replace(/\r?\n|\r/g," ");else if(t=t.replace(/[ \t\r\n\u000c]+/g," "),/^[ \t\r\n\u000c]/.test(t)&&this.open==this.nodes.length-1){var r=n.content[n.content.length-1],o=e.previousSibling;(!r||o&&"BR"==o.nodeName||r.isText&&/[ \t\r\n\u000c]$/.test(r.text))&&(t=t.slice(1))}t&&this.insertNode(this.parser.schema.text(t)),this.findInText(e)}else this.findInside(e)}},{key:"addElement",value:function(e,t){var n,r=e.nodeName.toLowerCase();me.hasOwnProperty(r)&&this.parser.normalizeLists&&function(e){for(var t=e.firstChild,n=null;t;t=t.nextSibling){var r=1==t.nodeType?t.nodeName.toLowerCase():null;r&&me.hasOwnProperty(r)&&n?(n.appendChild(t),t=n):"li"==r?n=t:r&&(n=null)}}(e);var o=this.options.ruleFromNode&&this.options.ruleFromNode(e)||(n=this.parser.matchTag(e,this,t));if(o?o.ignore:ve.hasOwnProperty(r))this.findInside(e),this.ignoreFallback(e);else if(!o||o.skip||o.closeParent){o&&o.closeParent?this.open=Math.max(0,this.open-1):o&&o.skip.nodeType&&(e=o.skip);var i,s=this.top,a=this.needsBlock;if(pe.hasOwnProperty(r))s.content.length&&s.content[0].isInline&&this.open&&(this.open--,s=this.top),i=!0,s.type||(this.needsBlock=!0);else if(!e.firstChild)return void this.leafFallback(e);this.addAll(e),i&&this.sync(s),this.needsBlock=a}else this.addElementByRule(e,o,!1===o.consuming?n:void 0)}},{key:"leafFallback",value:function(e){"BR"==e.nodeName&&this.top.type&&this.top.type.inlineContent&&this.addTextNode(e.ownerDocument.createTextNode("\n"))}},{key:"ignoreFallback",value:function(e){"BR"!=e.nodeName||this.top.type&&this.top.type.inlineContent||this.findPlace(this.parser.schema.text("-"))}},{key:"readStyles",value:function(e){var t=this,n=C.none,r=C.none;e:for(var o=0;o<e.length;o+=2)for(var i=function(i){var a=t.parser.matchStyle(e[o],e[o+1],t,i);return a?a.ignore?(s=i,{v:null}):(a.clearMark?t.top.pendingMarks.forEach((function(e){a.clearMark(e)&&(r=e.addToSet(r))})):n=t.parser.schema.marks[a.mark].create(a.attrs).addToSet(n),!1!==a.consuming?(s=i,"break"):void(s=i=a)):(s=i,"continue|style")},s=void 0;;){var a=i(s);if("continue|style"===a)continue e;if("break"===a)break;if("object"===y(a))return a.v}return[n,r]}},{key:"addElementByRule",value:function(e,t,n){var r,o,i,s=this;t.node?(o=this.parser.schema.nodes[t.node]).isLeaf?this.insertNode(o.create(t.attrs))||this.leafFallback(e):r=this.enter(o,t.attrs||null,t.preserveWhitespace):(i=this.parser.schema.marks[t.mark].create(t.attrs),this.addPendingMark(i));var a=this.top;if(o&&o.isLeaf)this.findInside(e);else if(n)this.addElement(e,n);else if(t.getContent)this.findInside(e),t.getContent(e,this.parser.schema).forEach((function(e){return s.insertNode(e)}));else{var l=e;"string"==typeof t.contentElement?l=e.querySelector(t.contentElement):"function"==typeof t.contentElement?l=t.contentElement(e):t.contentElement&&(l=t.contentElement),this.findAround(e,l,!0),this.addAll(l)}r&&this.sync(a)&&this.open--,i&&this.removePendingMark(i,a)}},{key:"addAll",value:function(e,t,n){for(var r=t||0,o=t?e.childNodes[t]:e.firstChild,i=null==n?null:e.childNodes[n];o!=i;o=o.nextSibling,++r)this.findAtPoint(e,r),this.addDOM(o);this.findAtPoint(e,r)}},{key:"findPlace",value:function(e){for(var t,n,r=this.open;r>=0;r--){var o=this.nodes[r],i=o.findWrapping(e);if(i&&(!t||t.length>i.length)&&(t=i,n=o,!i.length))break;if(o.solid)break}if(!t)return!1;this.sync(n);for(var s=0;s<t.length;s++)this.enterInner(t[s],null,!1);return!0}},{key:"insertNode",value:function(e){if(e.isInline&&this.needsBlock&&!this.top.type){var t=this.textblockFromContext();t&&this.enterInner(t)}if(this.findPlace(e)){this.closeExtra();var n=this.top;n.applyPending(e.type),n.match&&(n.match=n.match.matchType(e.type));for(var r=n.activeMarks,o=0;o<e.marks.length;o++)n.type&&!n.type.allowsMarkType(e.marks[o].type)||(r=e.marks[o].addToSet(r));return n.content.push(e.mark(r)),!0}return!1}},{key:"enter",value:function(e,t,n){var r=this.findPlace(e.create(t));return r&&this.enterInner(e,t,!0,n),r}},{key:"enterInner",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,n=arguments.length>2&&void 0!==arguments[2]&&arguments[2],r=arguments.length>3?arguments[3]:void 0;this.closeExtra();var o=this.top;o.applyPending(e),o.match=o.match&&o.match.matchType(e);var i=ye(e,r,o.options);4&o.options&&0==o.content.length&&(i|=4),this.nodes.push(new ge(e,t,o.activeMarks,o.pendingMarks,n,null,i)),this.open++}},{key:"closeExtra",value:function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0],t=this.nodes.length-1;if(t>this.open){for(;t>this.open;t--)this.nodes[t-1].content.push(this.nodes[t].finish(e));this.nodes.length=this.open+1}}},{key:"finish",value:function(){return this.open=0,this.closeExtra(this.isOpen),this.nodes[0].finish(this.isOpen||this.options.topOpen)}},{key:"sync",value:function(e){for(var t=this.open;t>=0;t--)if(this.nodes[t]==e)return this.open=t,!0;return!1}},{key:"currentPos",get:function(){this.closeExtra();for(var e=0,t=this.open;t>=0;t--){for(var n=this.nodes[t].content,r=n.length-1;r>=0;r--)e+=n[r].nodeSize;t&&e++}return e}},{key:"findAtPoint",value:function(e,t){if(this.find)for(var n=0;n<this.find.length;n++)this.find[n].node==e&&this.find[n].offset==t&&(this.find[n].pos=this.currentPos)}},{key:"findInside",value:function(e){if(this.find)for(var t=0;t<this.find.length;t++)null==this.find[t].pos&&1==e.nodeType&&e.contains(this.find[t].node)&&(this.find[t].pos=this.currentPos)}},{key:"findAround",value:function(e,t,n){if(e!=t&&this.find)for(var r=0;r<this.find.length;r++)null==this.find[r].pos&&1==e.nodeType&&e.contains(this.find[r].node)&&t.compareDocumentPosition(this.find[r].node)&(n?2:4)&&(this.find[r].pos=this.currentPos)}},{key:"findInText",value:function(e){if(this.find)for(var t=0;t<this.find.length;t++)this.find[t].node==e&&(this.find[t].pos=this.currentPos-(e.nodeValue.length-this.find[t].offset))}},{key:"matchesContext",value:function(e){var t=this;if(e.indexOf("|")>-1)return e.split(/\s*\|\s*/).some(this.matchesContext,this);var n=e.split("/"),r=this.options.context,o=!(this.isOpen||r&&r.parent.type!=this.nodes[0].type),i=-(r?r.depth+1:0)+(o?0:1);return function e(s,a){for(;s>=0;s--){var l=n[s];if(""==l){if(s==n.length-1||0==s)continue;for(;a>=i;a--)if(e(s-1,a))return!0;return!1}var c=a>0||0==a&&o?t.nodes[a].type:r&&a>=i?r.node(a-i).type:null;if(!c||c.name!=l&&-1==c.groups.indexOf(l))return!1;a--}return!0}(n.length-1,this.open)}},{key:"textblockFromContext",value:function(){var e=this.options.context;if(e)for(var t=e.depth;t>=0;t--){var n=e.node(t).contentMatchAt(e.indexAfter(t)).defaultType;if(n&&n.isTextblock&&n.defaultAttrs)return n}for(var r in this.parser.schema.nodes){var o=this.parser.schema.nodes[r];if(o.isTextblock&&o.defaultAttrs)return o}}},{key:"addPendingMark",value:function(e){var t=function(e,t){for(var n=0;n<t.length;n++)if(e.eq(t[n]))return t[n]}(e,this.top.pendingMarks);t&&this.top.stashMarks.push(t),this.top.pendingMarks=e.addToSet(this.top.pendingMarks)}},{key:"removePendingMark",value:function(e,t){for(var n=this.open;n>=0;n--){var r=this.nodes[n];if(r.pendingMarks.lastIndexOf(e)>-1)r.pendingMarks=e.removeFromSet(r.pendingMarks);else{r.activeMarks=e.removeFromSet(r.activeMarks);var o=r.popFromStashMark(e);o&&r.type&&r.type.allowsMarkType(o.type)&&(r.activeMarks=o.addToSet(r.activeMarks))}if(r==t)break}}}]),e}();function we(e,t){return(e.matches||e.msMatchesSelector||e.webkitMatchesSelector||e.mozMatchesSelector).call(e,t)}function be(e){var t={};for(var n in e)t[n]=e[n];return t}function Se(e,t){var n=t.schema.nodes,r=function(r){var o=n[r];if(!o.allowsMarkType(e))return"continue";var i=[];return function e(n){i.push(n);for(var r=0;r<n.edgeCount;r++){var o=n.edge(r),s=o.type,a=o.next;if(s==t)return!0;if(i.indexOf(a)<0&&e(a))return!0}}(o.contentMatch)?{v:!0}:void 0};for(var o in n){var i=r(o);if("continue"!==i&&"object"===y(i))return i.v}}var xe=function(){function e(t,n){p(this,e),this.nodes=t,this.marks=n}return m(e,[{key:"serializeFragment",value:function(e){var t=this,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},r=arguments.length>2?arguments[2]:void 0;r||(r=Oe(n).createDocumentFragment());var o=r,i=[];return e.forEach((function(e){if(i.length||e.marks.length){for(var r=0,s=0;r<i.length&&s<e.marks.length;){var a=e.marks[s];if(t.marks[a.type.name]){if(!a.eq(i[r][0])||!1===a.type.spec.spanning)break;r++,s++}else s++}for(;r<i.length;)o=i.pop()[1];for(;s<e.marks.length;){var l=e.marks[s++],c=t.serializeMark(l,e.isInline,n);c&&(i.push([l,o]),o.appendChild(c.dom),o=c.contentDOM||c.dom)}}o.appendChild(t.serializeNodeInner(e,n))})),r}},{key:"serializeNodeInner",value:function(t,n){var r=e.renderSpec(Oe(n),this.nodes[t.type.name](t)),o=r.dom,i=r.contentDOM;if(i){if(t.isLeaf)throw new RangeError("Content hole not allowed in a leaf node spec");this.serializeFragment(t.content,n,i)}return o}},{key:"serializeNode",value:function(e){for(var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=this.serializeNodeInner(e,t),r=e.marks.length-1;r>=0;r--){var o=this.serializeMark(e.marks[r],e.isInline,t);o&&((o.contentDOM||o.dom).appendChild(n),n=o.dom)}return n}},{key:"serializeMark",value:function(t,n){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},o=this.marks[t.type.name];return o&&e.renderSpec(Oe(r),o(t,n))}}],[{key:"renderSpec",value:function(t,n){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;if("string"==typeof n)return{dom:t.createTextNode(n)};if(null!=n.nodeType)return{dom:n};if(n.dom&&null!=n.dom.nodeType)return n;var o,i=n[0],s=i.indexOf(" ");s>0&&(r=i.slice(0,s),i=i.slice(s+1));var a=r?t.createElementNS(r,i):t.createElement(i),l=n[1],c=1;if(l&&"object"==y(l)&&null==l.nodeType&&!Array.isArray(l))for(var u in c=2,l)if(null!=l[u]){var f=u.indexOf(" ");f>0?a.setAttributeNS(u.slice(0,f),u.slice(f+1),l[u]):a.setAttribute(u,l[u])}for(var h=c;h<n.length;h++){var d=n[h];if(0===d){if(h<n.length-1||h>c)throw new RangeError("Content hole must be the only child of its parent node");return{dom:a,contentDOM:a}}var p=e.renderSpec(t,d,r),v=p.dom,m=p.contentDOM;if(a.appendChild(v),m){if(o)throw new RangeError("Multiple content holes");o=m}}return{dom:a,contentDOM:o}}},{key:"fromSchema",value:function(t){return t.cached.domSerializer||(t.cached.domSerializer=new e(this.nodesFromSchema(t),this.marksFromSchema(t)))}},{key:"nodesFromSchema",value:function(e){var t=Me(e.nodes);return t.text||(t.text=function(e){return e.text}),t}},{key:"marksFromSchema",value:function(e){return Me(e.marks)}}]),e}();function Me(e){var t={};for(var n in e){var r=e[n].spec.toDOM;r&&(t[n]=r)}return t}function Oe(e){return e.document||window.document}t.ContentMatch=G,t.DOMParser=de,t.DOMSerializer=xe,t.Fragment=S,t.Mark=C,t.MarkType=ue,t.Node=K,t.NodeRange=J,t.NodeType=le,t.ReplaceError=N,t.ResolvedPos=$,t.Schema=fe,t.Slice=T},190:(e,t,n)=>{Object.defineProperty(t,"__esModule",{value:!0});var r=n(443),o=["p",0],i=["blockquote",0],s=["hr"],a=["pre",["code",0]],l=["br"],c={doc:{content:"block+"},paragraph:{content:"inline*",group:"block",parseDOM:[{tag:"p"}],toDOM:function(){return o}},blockquote:{content:"block+",group:"block",defining:!0,parseDOM:[{tag:"blockquote"}],toDOM:function(){return i}},horizontal_rule:{group:"block",parseDOM:[{tag:"hr"}],toDOM:function(){return s}},heading:{attrs:{level:{default:1}},content:"inline*",group:"block",defining:!0,parseDOM:[{tag:"h1",attrs:{level:1}},{tag:"h2",attrs:{level:2}},{tag:"h3",attrs:{level:3}},{tag:"h4",attrs:{level:4}},{tag:"h5",attrs:{level:5}},{tag:"h6",attrs:{level:6}}],toDOM:function(e){return["h"+e.attrs.level,0]}},code_block:{content:"text*",marks:"",group:"block",code:!0,defining:!0,parseDOM:[{tag:"pre",preserveWhitespace:"full"}],toDOM:function(){return a}},text:{group:"inline"},image:{inline:!0,attrs:{src:{},alt:{default:null},title:{default:null}},group:"inline",draggable:!0,parseDOM:[{tag:"img[src]",getAttrs:function(e){return{src:e.getAttribute("src"),title:e.getAttribute("title"),alt:e.getAttribute("alt")}}}],toDOM:function(e){var t=e.attrs;return["img",{src:t.src,alt:t.alt,title:t.title}]}},hard_break:{inline:!0,group:"inline",selectable:!1,parseDOM:[{tag:"br"}],toDOM:function(){return l}}},u=["em",0],f=["strong",0],h=["code",0],d={link:{attrs:{href:{},title:{default:null}},inclusive:!1,parseDOM:[{tag:"a[href]",getAttrs:function(e){return{href:e.getAttribute("href"),title:e.getAttribute("title")}}}],toDOM:function(e){var t=e.attrs;return["a",{href:t.href,title:t.title},0]}},em:{parseDOM:[{tag:"i"},{tag:"em"},{style:"font-style=italic"},{style:"font-style=normal",clearMark:function(e){return"em"==e.type.name}}],toDOM:function(){return u}},strong:{parseDOM:[{tag:"strong"},{tag:"b",getAttrs:function(e){return"normal"!=e.style.fontWeight&&null}},{style:"font-weight=400",clearMark:function(e){return"strong"==e.type.name}},{style:"font-weight",getAttrs:function(e){return/^(bold(er)?|[5-9]\d{2,})$/.test(e)&&null}}],toDOM:function(){return f}},code:{parseDOM:[{tag:"code"}],toDOM:function(){return h}}},p=new r.Schema({nodes:c,marks:d});t.marks=d,t.nodes=c,t.schema=p},32:(e,t,n)=>{Object.defineProperty(t,"__esModule",{value:!0});var r=n(843),o=n(443),i=n(391),s=["ol",0],a=["ul",0],l=["li",0],c={attrs:{order:{default:1}},parseDOM:[{tag:"ol",getAttrs:function(e){return{order:e.hasAttribute("start")?+e.getAttribute("start"):1}}}],toDOM:function(e){return 1==e.attrs.order?s:["ol",{start:e.attrs.order},0]}},u={parseDOM:[{tag:"ul"}],toDOM:function(){return a}},f={parseDOM:[{tag:"li"}],toDOM:function(){return l},defining:!0};function h(e,t){var n={};for(var r in e)n[r]=e[r];for(var o in t)n[o]=t[o];return n}function d(e,t,n,i,s){for(var a=o.Fragment.empty,l=n.length-1;l>=0;l--)a=o.Fragment.from(n[l].type.create(n[l].attrs,a));e.step(new r.ReplaceAroundStep(t.start-(i?2:0),t.end,t.start,t.end,new o.Slice(a,0,0),n.length,!0));for(var c=0,u=0;u<n.length;u++)n[u].type==s&&(c=u+1);for(var f=n.length-c,h=t.start+n.length-(i?2:0),d=t.parent,p=t.startIndex,v=t.endIndex,m=!0;p<v;p++,m=!1)!m&&r.canSplit(e.doc,h,f)&&(e.split(h,f),h+=2*f),h+=d.child(p).nodeSize;return e}t.addListNodes=function(e,t,n){return e.append({ordered_list:h(c,{content:"list_item+",group:n}),bullet_list:h(u,{content:"list_item+",group:n}),list_item:h(f,{content:t})})},t.bulletList=u,t.liftListItem=function(e){return function(t,n){var i=t.selection,s=i.$from,a=i.$to,l=s.blockRange(a,(function(t){return t.childCount>0&&t.firstChild.type==e}));return!!l&&(!n||(s.node(l.depth-1).type==e?function(e,t,n,i){var s=e.tr,a=i.end,l=i.$to.end(i.depth);a<l&&(s.step(new r.ReplaceAroundStep(a-1,l,a,l,new o.Slice(o.Fragment.from(n.create(null,i.parent.copy())),1,0),1,!0)),i=new o.NodeRange(s.doc.resolve(i.$from.pos),s.doc.resolve(l),i.depth));var c=r.liftTarget(i);if(null==c)return!1;s.lift(i,c);var u=s.mapping.map(a,-1)-1;return r.canJoin(s.doc,u)&&s.join(u),t(s.scrollIntoView()),!0}(t,n,e,l):function(e,t,n){for(var i=e.tr,s=n.parent,a=n.end,l=n.endIndex-1,c=n.startIndex;l>c;l--)a-=s.child(l).nodeSize,i.delete(a-1,a+1);var u=i.doc.resolve(n.start),f=u.nodeAfter;if(i.mapping.map(n.end)!=n.start+u.nodeAfter.nodeSize)return!1;var h=0==n.startIndex,d=n.endIndex==s.childCount,p=u.node(-1),v=u.index(-1);if(!p.canReplace(v+(h?0:1),v+1,f.content.append(d?o.Fragment.empty:o.Fragment.from(s))))return!1;var m=u.pos,y=m+f.nodeSize;return i.step(new r.ReplaceAroundStep(m-(h?1:0),y+(d?1:0),m+1,y-1,new o.Slice((h?o.Fragment.empty:o.Fragment.from(s.copy(o.Fragment.empty))).append(d?o.Fragment.empty:o.Fragment.from(s.copy(o.Fragment.empty))),h?0:1,d?0:1),h?0:1)),t(i.scrollIntoView()),!0}(t,n,l)))}},t.listItem=f,t.orderedList=c,t.sinkListItem=function(e){return function(t,n){var i=t.selection,s=i.$from,a=i.$to,l=s.blockRange(a,(function(t){return t.childCount>0&&t.firstChild.type==e}));if(!l)return!1;var c=l.startIndex;if(0==c)return!1;var u=l.parent,f=u.child(c-1);if(f.type!=e)return!1;if(n){var h=f.lastChild&&f.lastChild.type==u.type,d=o.Fragment.from(h?e.create():null),p=new o.Slice(o.Fragment.from(e.create(null,o.Fragment.from(u.type.create(null,d)))),h?3:1,0),v=l.start,m=l.end;n(t.tr.step(new r.ReplaceAroundStep(v-(h?3:1),m,v,m,p,1,!0)).scrollIntoView())}return!0}},t.splitListItem=function(e){return function(t,n){var s=t.selection,a=s.$from,l=s.$to,c=s.node;if(c&&c.isBlock||a.depth<2||!a.sameParent(l))return!1;var u=a.node(-1);if(u.type!=e)return!1;if(0==a.parent.content.size&&a.node(-1).childCount==a.indexAfter(-1)){if(3==a.depth||a.node(-3).type!=e||a.index(-2)!=a.node(-2).childCount-1)return!1;if(n){for(var f=o.Fragment.empty,h=a.index(-1)?1:a.index(-2)?2:3,d=a.depth-h;d>=a.depth-3;d--)f=o.Fragment.from(a.node(d).copy(f));var p=a.indexAfter(-1)<a.node(-2).childCount?1:a.indexAfter(-2)<a.node(-3).childCount?2:3;f=f.append(o.Fragment.from(e.createAndFill()));var v=a.before(a.depth-(h-1)),m=t.tr.replace(v,a.after(-p),new o.Slice(f,4-h,0)),y=-1;m.doc.nodesBetween(v,m.doc.content.size,(function(e,t){if(y>-1)return!1;e.isTextblock&&0==e.content.size&&(y=t+1)})),y>-1&&m.setSelection(i.Selection.near(m.doc.resolve(y))),n(m.scrollIntoView())}return!0}var g=l.pos==a.end()?u.contentMatchAt(0).defaultType:null,k=t.tr.delete(a.pos,l.pos),w=g?[null,{type:g}]:void 0;return!!r.canSplit(k.doc,a.pos,2,w)&&(n&&n(k.split(a.pos,2,w).scrollIntoView()),!0)}},t.wrapInList=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;return function(n,i){var s=n.selection,a=s.$from,l=s.$to,c=a.blockRange(l),u=!1,f=c;if(!c)return!1;if(c.depth>=2&&a.node(c.depth-1).type.compatibleContent(e)&&0==c.startIndex){if(0==a.index(c.depth-1))return!1;var h=n.doc.resolve(c.start-2);f=new o.NodeRange(h,h,c.depth),c.endIndex<c.parent.childCount&&(c=new o.NodeRange(a,n.doc.resolve(l.end(c.depth)),c.depth)),u=!0}var p=r.findWrapping(f,e,t,c);return!!p&&(i&&i(d(n.tr,c,p,u,e).scrollIntoView()),!0)}}},391:(e,t,n)=>{function r(e){return r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},r(e)}function o(){return o="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,n){var r=i(e,t);if(r){var o=Object.getOwnPropertyDescriptor(r,t);return o.get?o.get.call(arguments.length<3?e:n):o.value}},o.apply(this,arguments)}function i(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=u(e)););return e}function s(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&a(e,t)}function a(e,t){return a=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e},a(e,t)}function l(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=u(e);if(t){var o=u(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return c(this,n)}}function c(e,t){if(t&&("object"===r(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}function u(e){return u=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)},u(e)}function f(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function h(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function d(e,t,n){return t&&h(e.prototype,t),n&&h(e,n),Object.defineProperty(e,"prototype",{writable:!1}),e}Object.defineProperty(t,"__esModule",{value:!0});var p=n(443),v=n(843),m=Object.create(null),y=function(){function e(t,n,r){f(this,e),this.$anchor=t,this.$head=n,this.ranges=r||[new g(t.min(n),t.max(n))]}return d(e,[{key:"anchor",get:function(){return this.$anchor.pos}},{key:"head",get:function(){return this.$head.pos}},{key:"from",get:function(){return this.$from.pos}},{key:"to",get:function(){return this.$to.pos}},{key:"$from",get:function(){return this.ranges[0].$from}},{key:"$to",get:function(){return this.ranges[0].$to}},{key:"empty",get:function(){for(var e=this.ranges,t=0;t<e.length;t++)if(e[t].$from.pos!=e[t].$to.pos)return!1;return!0}},{key:"content",value:function(){return this.$from.doc.slice(this.from,this.to,!0)}},{key:"replace",value:function(e){for(var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:p.Slice.empty,n=t.content.lastChild,r=null,o=0;o<t.openEnd;o++)r=n,n=n.lastChild;for(var i=e.steps.length,s=this.ranges,a=0;a<s.length;a++){var l=s[a],c=l.$from,u=l.$to,f=e.mapping.slice(i);e.replaceRange(f.map(c.pos),f.map(u.pos),a?p.Slice.empty:t),0==a&&T(e,i,(n?n.isInline:r&&r.isTextblock)?-1:1)}}},{key:"replaceWith",value:function(e,t){for(var n=e.steps.length,r=this.ranges,o=0;o<r.length;o++){var i=r[o],s=i.$from,a=i.$to,l=e.mapping.slice(n),c=l.map(s.pos),u=l.map(a.pos);o?e.deleteRange(c,u):(e.replaceRangeWith(c,u,t),T(e,n,t.isInline?-1:1))}}},{key:"getBookmark",value:function(){return b.between(this.$anchor,this.$head).getBookmark()}}],[{key:"findFrom",value:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]&&arguments[2],r=e.parent.inlineContent?new b(e):N(e.node(0),e.parent,e.pos,e.index(),t,n);if(r)return r;for(var o=e.depth-1;o>=0;o--){var i=t<0?N(e.node(0),e.node(o),e.before(o+1),e.index(o),t,n):N(e.node(0),e.node(o),e.after(o+1),e.index(o)+1,t,n);if(i)return i}return null}},{key:"near",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1;return this.findFrom(e,t)||this.findFrom(e,-t)||new O(e.node(0))}},{key:"atStart",value:function(e){return N(e,e,0,0,1)||new O(e)}},{key:"atEnd",value:function(e){return N(e,e,e.content.size,e.childCount,-1)||new O(e)}},{key:"fromJSON",value:function(e,t){if(!t||!t.type)throw new RangeError("Invalid input for Selection.fromJSON");var n=m[t.type];if(!n)throw new RangeError("No selection type ".concat(t.type," defined"));return n.fromJSON(e,t)}},{key:"jsonID",value:function(e,t){if(e in m)throw new RangeError("Duplicate use of selection JSON ID "+e);return m[e]=t,t.prototype.jsonID=e,t}}]),e}();y.prototype.visible=!0;var g=d((function e(t,n){f(this,e),this.$from=t,this.$to=n})),k=!1;function w(e){k||e.parent.inlineContent||(k=!0,console.warn("TextSelection endpoint not pointing into a node with inline content ("+e.parent.type.name+")"))}var b=function(e){s(n,e);var t=l(n);function n(e){var r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:e;return f(this,n),w(e),w(r),t.call(this,e,r)}return d(n,[{key:"$cursor",get:function(){return this.$anchor.pos==this.$head.pos?this.$head:null}},{key:"map",value:function(e,t){var r=e.resolve(t.map(this.head));if(!r.parent.inlineContent)return y.near(r);var o=e.resolve(t.map(this.anchor));return new n(o.parent.inlineContent?o:r,r)}},{key:"replace",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:p.Slice.empty;if(o(u(n.prototype),"replace",this).call(this,e,t),t==p.Slice.empty){var r=this.$from.marksAcross(this.$to);r&&e.ensureMarks(r)}}},{key:"eq",value:function(e){return e instanceof n&&e.anchor==this.anchor&&e.head==this.head}},{key:"getBookmark",value:function(){return new S(this.anchor,this.head)}},{key:"toJSON",value:function(){return{type:"text",anchor:this.anchor,head:this.head}}}],[{key:"fromJSON",value:function(e,t){if("number"!=typeof t.anchor||"number"!=typeof t.head)throw new RangeError("Invalid input for TextSelection.fromJSON");return new n(e.resolve(t.anchor),e.resolve(t.head))}},{key:"create",value:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:t,r=e.resolve(t);return new this(r,n==t?r:e.resolve(n))}},{key:"between",value:function(e,t,r){var o=e.pos-t.pos;if(r&&!o||(r=o>=0?1:-1),!t.parent.inlineContent){var i=y.findFrom(t,r,!0)||y.findFrom(t,-r,!0);if(!i)return y.near(t,r);t=i.$head}return e.parent.inlineContent||(0==o||(e=(y.findFrom(e,-r,!0)||y.findFrom(e,r,!0)).$anchor).pos<t.pos!=o<0)&&(e=t),new n(e,t)}}]),n}(y);y.jsonID("text",b);var S=function(){function e(t,n){f(this,e),this.anchor=t,this.head=n}return d(e,[{key:"map",value:function(t){return new e(t.map(this.anchor),t.map(this.head))}},{key:"resolve",value:function(e){return b.between(e.resolve(this.anchor),e.resolve(this.head))}}]),e}(),x=function(e){s(n,e);var t=l(n);function n(e){var r;f(this,n);var o=e.nodeAfter,i=e.node(0).resolve(e.pos+o.nodeSize);return(r=t.call(this,e,i)).node=o,r}return d(n,[{key:"map",value:function(e,t){var r=t.mapResult(this.anchor),o=r.deleted,i=r.pos,s=e.resolve(i);return o?y.near(s):new n(s)}},{key:"content",value:function(){return new p.Slice(p.Fragment.from(this.node),0,0)}},{key:"eq",value:function(e){return e instanceof n&&e.anchor==this.anchor}},{key:"toJSON",value:function(){return{type:"node",anchor:this.anchor}}},{key:"getBookmark",value:function(){return new M(this.anchor)}}],[{key:"fromJSON",value:function(e,t){if("number"!=typeof t.anchor)throw new RangeError("Invalid input for NodeSelection.fromJSON");return new n(e.resolve(t.anchor))}},{key:"create",value:function(e,t){return new n(e.resolve(t))}},{key:"isSelectable",value:function(e){return!e.isText&&!1!==e.type.spec.selectable}}]),n}(y);x.prototype.visible=!1,y.jsonID("node",x);var M=function(){function e(t){f(this,e),this.anchor=t}return d(e,[{key:"map",value:function(t){var n=t.mapResult(this.anchor),r=n.deleted,o=n.pos;return r?new S(o,o):new e(o)}},{key:"resolve",value:function(e){var t=e.resolve(this.anchor),n=t.nodeAfter;return n&&x.isSelectable(n)?new x(t):y.near(t)}}]),e}(),O=function(e){s(n,e);var t=l(n);function n(e){return f(this,n),t.call(this,e.resolve(0),e.resolve(e.content.size))}return d(n,[{key:"replace",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:p.Slice.empty;if(t==p.Slice.empty){e.delete(0,e.doc.content.size);var r=y.atStart(e.doc);r.eq(e.selection)||e.setSelection(r)}else o(u(n.prototype),"replace",this).call(this,e,t)}},{key:"toJSON",value:function(){return{type:"all"}}},{key:"map",value:function(e){return new n(e)}},{key:"eq",value:function(e){return e instanceof n}},{key:"getBookmark",value:function(){return C}}],[{key:"fromJSON",value:function(e){return new n(e)}}]),n}(y);y.jsonID("all",O);var C={map:function(){return this},resolve:function(e){return new O(e)}};function N(e,t,n,r,o){var i=arguments.length>5&&void 0!==arguments[5]&&arguments[5];if(t.inlineContent)return b.create(e,n);for(var s=r-(o>0?0:1);o>0?s<t.childCount:s>=0;s+=o){var a=t.child(s);if(a.isAtom){if(!i&&x.isSelectable(a))return x.create(e,n-(o<0?a.nodeSize:0))}else{var l=N(e,a,n+o,o<0?a.childCount:0,o,i);if(l)return l}n+=a.nodeSize*o}return null}function T(e,t,n){var r=e.steps.length-1;if(!(r<t)){var o,i=e.steps[r];(i instanceof v.ReplaceStep||i instanceof v.ReplaceAroundStep)&&(e.mapping.maps[r].forEach((function(e,t,n,r){null==o&&(o=r)})),e.setSelection(y.near(e.doc.resolve(o),n)))}}var D=function(e){s(n,e);var t=l(n);function n(e){var r;return f(this,n),(r=t.call(this,e.doc)).curSelectionFor=0,r.updated=0,r.meta=Object.create(null),r.time=Date.now(),r.curSelection=e.selection,r.storedMarks=e.storedMarks,r}return d(n,[{key:"selection",get:function(){return this.curSelectionFor<this.steps.length&&(this.curSelection=this.curSelection.map(this.doc,this.mapping.slice(this.curSelectionFor)),this.curSelectionFor=this.steps.length),this.curSelection}},{key:"setSelection",value:function(e){if(e.$from.doc!=this.doc)throw new RangeError("Selection passed to setSelection must point at the current document");return this.curSelection=e,this.curSelectionFor=this.steps.length,this.updated=-3&(1|this.updated),this.storedMarks=null,this}},{key:"selectionSet",get:function(){return(1&this.updated)>0}},{key:"setStoredMarks",value:function(e){return this.storedMarks=e,this.updated|=2,this}},{key:"ensureMarks",value:function(e){return p.Mark.sameSet(this.storedMarks||this.selection.$from.marks(),e)||this.setStoredMarks(e),this}},{key:"addStoredMark",value:function(e){return this.ensureMarks(e.addToSet(this.storedMarks||this.selection.$head.marks()))}},{key:"removeStoredMark",value:function(e){return this.ensureMarks(e.removeFromSet(this.storedMarks||this.selection.$head.marks()))}},{key:"storedMarksSet",get:function(){return(2&this.updated)>0}},{key:"addStep",value:function(e,t){o(u(n.prototype),"addStep",this).call(this,e,t),this.updated=-3&this.updated,this.storedMarks=null}},{key:"setTime",value:function(e){return this.time=e,this}},{key:"replaceSelection",value:function(e){return this.selection.replace(this,e),this}},{key:"replaceSelectionWith",value:function(e){var t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],n=this.selection;return t&&(e=e.mark(this.storedMarks||(n.empty?n.$from.marks():n.$from.marksAcross(n.$to)||p.Mark.none))),n.replaceWith(this,e),this}},{key:"deleteSelection",value:function(){return this.selection.replace(this),this}},{key:"insertText",value:function(e,t,n){var r=this.doc.type.schema;if(null==t)return e?this.replaceSelectionWith(r.text(e),!0):this.deleteSelection();if(null==n&&(n=t),n=null==n?t:n,!e)return this.deleteRange(t,n);var o=this.storedMarks;if(!o){var i=this.doc.resolve(t);o=n==t?i.marks():i.marksAcross(this.doc.resolve(n))}return this.replaceRangeWith(t,n,r.text(e,o)),this.selection.empty||this.setSelection(y.near(this.selection.$to)),this}},{key:"setMeta",value:function(e,t){return this.meta["string"==typeof e?e:e.key]=t,this}},{key:"getMeta",value:function(e){return this.meta["string"==typeof e?e:e.key]}},{key:"isGeneric",get:function(){for(var e in this.meta)return!1;return!0}},{key:"scrollIntoView",value:function(){return this.updated|=4,this}},{key:"scrolledIntoView",get:function(){return(4&this.updated)>0}}]),n}(v.Transform);function E(e,t){return t&&e?e.bind(t):e}var A=d((function e(t,n,r){f(this,e),this.name=t,this.init=E(n.init,r),this.apply=E(n.apply,r)})),P=[new A("doc",{init:function(e){return e.doc||e.schema.topNodeType.createAndFill()},apply:function(e){return e.doc}}),new A("selection",{init:function(e,t){return e.selection||y.atStart(t.doc)},apply:function(e){return e.selection}}),new A("storedMarks",{init:function(e){return e.storedMarks||null},apply:function(e,t,n,r){return r.selection.$cursor?e.storedMarks:null}}),new A("scrollToSelection",{init:function(){return 0},apply:function(e,t){return e.scrolledIntoView?t+1:t}})],R=d((function e(t,n){var r=this;f(this,e),this.schema=t,this.plugins=[],this.pluginsByKey=Object.create(null),this.fields=P.slice(),n&&n.forEach((function(e){if(r.pluginsByKey[e.key])throw new RangeError("Adding different instances of a keyed plugin ("+e.key+")");r.plugins.push(e),r.pluginsByKey[e.key]=e,e.spec.state&&r.fields.push(new A(e.key,e.spec.state,e))}))})),I=function(){function e(t){f(this,e),this.config=t}return d(e,[{key:"schema",get:function(){return this.config.schema}},{key:"plugins",get:function(){return this.config.plugins}},{key:"apply",value:function(e){return this.applyTransaction(e).state}},{key:"filterTransaction",value:function(e){for(var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:-1,n=0;n<this.config.plugins.length;n++)if(n!=t){var r=this.config.plugins[n];if(r.spec.filterTransaction&&!r.spec.filterTransaction.call(r,e,this))return!1}return!0}},{key:"applyTransaction",value:function(e){if(!this.filterTransaction(e))return{state:this,transactions:[]};for(var t=[e],n=this.applyInner(e),r=null;;){for(var o=!1,i=0;i<this.config.plugins.length;i++){var s=this.config.plugins[i];if(s.spec.appendTransaction){var a=r?r[i].n:0,l=r?r[i].state:this,c=a<t.length&&s.spec.appendTransaction.call(s,a?t.slice(a):t,l,n);if(c&&n.filterTransaction(c,i)){if(c.setMeta("appendedTransaction",e),!r){r=[];for(var u=0;u<this.config.plugins.length;u++)r.push(u<i?{state:n,n:t.length}:{state:this,n:0})}t.push(c),n=n.applyInner(c),o=!0}r&&(r[i]={state:n,n:t.length})}}if(!o)return{state:n,transactions:t}}}},{key:"applyInner",value:function(t){if(!t.before.eq(this.doc))throw new RangeError("Applying a mismatched transaction");for(var n=new e(this.config),r=this.config.fields,o=0;o<r.length;o++){var i=r[o];n[i.name]=i.apply(t,this[i.name],this,n)}return n}},{key:"tr",get:function(){return new D(this)}},{key:"reconfigure",value:function(t){for(var n=new R(this.schema,t.plugins),r=n.fields,o=new e(n),i=0;i<r.length;i++){var s=r[i].name;o[s]=this.hasOwnProperty(s)?this[s]:r[i].init(t,o)}return o}},{key:"toJSON",value:function(e){var t={doc:this.doc.toJSON(),selection:this.selection.toJSON()};if(this.storedMarks&&(t.storedMarks=this.storedMarks.map((function(e){return e.toJSON()}))),e&&"object"==r(e))for(var n in e){if("doc"==n||"selection"==n)throw new RangeError("The JSON fields `doc` and `selection` are reserved");var o=e[n],i=o.spec.state;i&&i.toJSON&&(t[n]=i.toJSON.call(o,this[o.key]))}return t}}],[{key:"create",value:function(t){for(var n=new R(t.doc?t.doc.type.schema:t.schema,t.plugins),r=new e(n),o=0;o<n.fields.length;o++)r[n.fields[o].name]=n.fields[o].init(t,r);return r}},{key:"fromJSON",value:function(t,n,r){if(!n)throw new RangeError("Invalid input for EditorState.fromJSON");if(!t.schema)throw new RangeError("Required config field 'schema' missing");var o=new R(t.schema,t.plugins),i=new e(o);return o.fields.forEach((function(e){if("doc"==e.name)i.doc=p.Node.fromJSON(t.schema,n.doc);else if("selection"==e.name)i.selection=y.fromJSON(i.doc,n.selection);else if("storedMarks"==e.name)n.storedMarks&&(i.storedMarks=n.storedMarks.map(t.schema.markFromJSON));else{if(r)for(var o in r){var s=r[o],a=s.spec.state;if(s.key==e.name&&a&&a.fromJSON&&Object.prototype.hasOwnProperty.call(n,o))return void(i[e.name]=a.fromJSON.call(s,t,n[o],i))}i[e.name]=e.init(t,i)}})),i}}]),e}();function z(e,t,n){for(var r in e){var o=e[r];o instanceof Function?o=o.bind(t):"handleDOMEvents"==r&&(o=z(o,t,{})),n[r]=o}return n}var F=function(){function e(t){f(this,e),this.spec=t,this.props={},t.props&&z(t.props,this,this.props),this.key=t.key?t.key.key:V("plugin")}return d(e,[{key:"getState",value:function(e){return e[this.key]}}]),e}(),B=Object.create(null);function V(e){return e in B?e+"$"+ ++B[e]:(B[e]=0,e+"$")}var j=function(){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"key";f(this,e),this.key=V(t)}return d(e,[{key:"get",value:function(e){return e.config.pluginsByKey[this.key]}},{key:"getState",value:function(e){return e[this.key]}}]),e}();t.AllSelection=O,t.EditorState=I,t.NodeSelection=x,t.Plugin=F,t.PluginKey=j,t.Selection=y,t.SelectionRange=g,t.TextSelection=b,t.Transaction=D},843:(e,t,n)=>{function r(e){return r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},r(e)}function o(e){var t="function"==typeof Map?new Map:void 0;return o=function(e){if(null===e||(n=e,-1===Function.toString.call(n).indexOf("[native code]")))return e;var n;if("function"!=typeof e)throw new TypeError("Super expression must either be null or a function");if(void 0!==t){if(t.has(e))return t.get(e);t.set(e,r)}function r(){return i(e,arguments,f(this).constructor)}return r.prototype=Object.create(e.prototype,{constructor:{value:r,enumerable:!1,writable:!0,configurable:!0}}),a(r,e)},o(e)}function i(e,t,n){return i=u()?Reflect.construct:function(e,t,n){var r=[null];r.push.apply(r,t);var o=new(Function.bind.apply(e,r));return n&&a(o,n.prototype),o},i.apply(null,arguments)}function s(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&a(e,t)}function a(e,t){return a=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e},a(e,t)}function l(e){var t=u();return function(){var n,r=f(e);if(t){var o=f(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return c(this,n)}}function c(e,t){if(t&&("object"===r(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}function u(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}function f(e){return f=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)},f(e)}function h(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function d(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function p(e,t,n){return t&&d(e.prototype,t),n&&d(e,n),Object.defineProperty(e,"prototype",{writable:!1}),e}Object.defineProperty(t,"__esModule",{value:!0});var v=n(443),m=Math.pow(2,16);function y(e){return 65535&e}var g=function(){function e(t,n,r){h(this,e),this.pos=t,this.delInfo=n,this.recover=r}return p(e,[{key:"deleted",get:function(){return(8&this.delInfo)>0}},{key:"deletedBefore",get:function(){return(5&this.delInfo)>0}},{key:"deletedAfter",get:function(){return(6&this.delInfo)>0}},{key:"deletedAcross",get:function(){return(4&this.delInfo)>0}}]),e}(),k=function(){function e(t){var n=arguments.length>1&&void 0!==arguments[1]&&arguments[1];if(h(this,e),this.ranges=t,this.inverted=n,!t.length&&e.empty)return e.empty}return p(e,[{key:"recover",value:function(e){var t=0,n=y(e);if(!this.inverted)for(var r=0;r<n;r++)t+=this.ranges[3*r+2]-this.ranges[3*r+1];return this.ranges[3*n]+t+function(e){return(e-(65535&e))/m}(e)}},{key:"mapResult",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1;return this._map(e,t,!1)}},{key:"map",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1;return this._map(e,t,!0)}},{key:"_map",value:function(e,t,n){for(var r=0,o=this.inverted?2:1,i=this.inverted?1:2,s=0;s<this.ranges.length;s+=3){var a=this.ranges[s]-(this.inverted?r:0);if(a>e)break;var l=this.ranges[s+o],c=this.ranges[s+i],u=a+l;if(e<=u){var f=a+r+((l?e==a?-1:e==u?1:t:t)<0?0:c);if(n)return f;var h=e==a?2:e==u?1:4;return(t<0?e!=a:e!=u)&&(h|=8),new g(f,h,e==(t<0?a:u)?null:s/3+(e-a)*m)}r+=c-l}return n?e+r:new g(e+r,0,null)}},{key:"touches",value:function(e,t){for(var n=0,r=y(t),o=this.inverted?2:1,i=this.inverted?1:2,s=0;s<this.ranges.length;s+=3){var a=this.ranges[s]-(this.inverted?n:0);if(a>e)break;var l=this.ranges[s+o];if(e<=a+l&&s==3*r)return!0;n+=this.ranges[s+i]-l}return!1}},{key:"forEach",value:function(e){for(var t=this.inverted?2:1,n=this.inverted?1:2,r=0,o=0;r<this.ranges.length;r+=3){var i=this.ranges[r],s=i-(this.inverted?o:0),a=i+(this.inverted?0:o),l=this.ranges[r+t],c=this.ranges[r+n];e(s,s+l,a,a+c),o+=c-l}}},{key:"invert",value:function(){return new e(this.ranges,!this.inverted)}},{key:"toString",value:function(){return(this.inverted?"-":"")+JSON.stringify(this.ranges)}}],[{key:"offset",value:function(t){return 0==t?e.empty:new e(t<0?[0,-t,0]:[0,0,t])}}]),e}();k.empty=new k([]);var w=function(){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],n=arguments.length>1?arguments[1]:void 0,r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,o=arguments.length>3&&void 0!==arguments[3]?arguments[3]:t.length;h(this,e),this.maps=t,this.mirror=n,this.from=r,this.to=o}return p(e,[{key:"slice",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this.maps.length;return new e(this.maps,this.mirror,t,n)}},{key:"copy",value:function(){return new e(this.maps.slice(),this.mirror&&this.mirror.slice(),this.from,this.to)}},{key:"appendMap",value:function(e,t){this.to=this.maps.push(e),null!=t&&this.setMirror(this.maps.length-1,t)}},{key:"appendMapping",value:function(e){for(var t=0,n=this.maps.length;t<e.maps.length;t++){var r=e.getMirror(t);this.appendMap(e.maps[t],null!=r&&r<t?n+r:void 0)}}},{key:"getMirror",value:function(e){if(this.mirror)for(var t=0;t<this.mirror.length;t++)if(this.mirror[t]==e)return this.mirror[t+(t%2?-1:1)]}},{key:"setMirror",value:function(e,t){this.mirror||(this.mirror=[]),this.mirror.push(e,t)}},{key:"appendMappingInverted",value:function(e){for(var t=e.maps.length-1,n=this.maps.length+e.maps.length;t>=0;t--){var r=e.getMirror(t);this.appendMap(e.maps[t].invert(),null!=r&&r>t?n-r-1:void 0)}}},{key:"invert",value:function(){var t=new e;return t.appendMappingInverted(this),t}},{key:"map",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1;if(this.mirror)return this._map(e,t,!0);for(var n=this.from;n<this.to;n++)e=this.maps[n].map(e,t);return e}},{key:"mapResult",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1;return this._map(e,t,!1)}},{key:"_map",value:function(e,t,n){for(var r=0,o=this.from;o<this.to;o++){var i=this.maps[o].mapResult(e,t);if(null!=i.recover){var s=this.getMirror(o);if(null!=s&&s>o&&s<this.to){o=s,e=this.maps[s].recover(i.recover);continue}}r|=i.delInfo,e=i.pos}return n?e:new g(e,r,null)}}]),e}(),b=Object.create(null),S=function(){function e(){h(this,e)}return p(e,[{key:"getMap",value:function(){return k.empty}},{key:"merge",value:function(e){return null}}],[{key:"fromJSON",value:function(e,t){if(!t||!t.stepType)throw new RangeError("Invalid input for Step.fromJSON");var n=b[t.stepType];if(!n)throw new RangeError("No step type ".concat(t.stepType," defined"));return n.fromJSON(e,t)}},{key:"jsonID",value:function(e,t){if(e in b)throw new RangeError("Duplicate use of step JSON ID "+e);return b[e]=t,t.prototype.jsonID=e,t}}]),e}(),x=function(){function e(t,n){h(this,e),this.doc=t,this.failed=n}return p(e,null,[{key:"ok",value:function(t){return new e(t,null)}},{key:"fail",value:function(t){return new e(null,t)}},{key:"fromReplace",value:function(t,n,r,o){try{return e.ok(t.replace(n,r,o))}catch(t){if(t instanceof v.ReplaceError)return e.fail(t.message);throw t}}}]),e}();function M(e,t,n){for(var r=[],o=0;o<e.childCount;o++){var i=e.child(o);i.content.size&&(i=i.copy(M(i.content,t,i))),i.isInline&&(i=t(i,n,o)),r.push(i)}return v.Fragment.fromArray(r)}var O=function(e){s(n,e);var t=l(n);function n(e,r,o){var i;return h(this,n),(i=t.call(this)).from=e,i.to=r,i.mark=o,i}return p(n,[{key:"apply",value:function(e){var t=this,n=e.slice(this.from,this.to),r=e.resolve(this.from),o=r.node(r.sharedDepth(this.to)),i=new v.Slice(M(n.content,(function(e,n){return e.isAtom&&n.type.allowsMarkType(t.mark.type)?e.mark(t.mark.addToSet(e.marks)):e}),o),n.openStart,n.openEnd);return x.fromReplace(e,this.from,this.to,i)}},{key:"invert",value:function(){return new C(this.from,this.to,this.mark)}},{key:"map",value:function(e){var t=e.mapResult(this.from,1),r=e.mapResult(this.to,-1);return t.deleted&&r.deleted||t.pos>=r.pos?null:new n(t.pos,r.pos,this.mark)}},{key:"merge",value:function(e){return e instanceof n&&e.mark.eq(this.mark)&&this.from<=e.to&&this.to>=e.from?new n(Math.min(this.from,e.from),Math.max(this.to,e.to),this.mark):null}},{key:"toJSON",value:function(){return{stepType:"addMark",mark:this.mark.toJSON(),from:this.from,to:this.to}}}],[{key:"fromJSON",value:function(e,t){if("number"!=typeof t.from||"number"!=typeof t.to)throw new RangeError("Invalid input for AddMarkStep.fromJSON");return new n(t.from,t.to,e.markFromJSON(t.mark))}}]),n}(S);S.jsonID("addMark",O);var C=function(e){s(n,e);var t=l(n);function n(e,r,o){var i;return h(this,n),(i=t.call(this)).from=e,i.to=r,i.mark=o,i}return p(n,[{key:"apply",value:function(e){var t=this,n=e.slice(this.from,this.to),r=new v.Slice(M(n.content,(function(e){return e.mark(t.mark.removeFromSet(e.marks))}),e),n.openStart,n.openEnd);return x.fromReplace(e,this.from,this.to,r)}},{key:"invert",value:function(){return new O(this.from,this.to,this.mark)}},{key:"map",value:function(e){var t=e.mapResult(this.from,1),r=e.mapResult(this.to,-1);return t.deleted&&r.deleted||t.pos>=r.pos?null:new n(t.pos,r.pos,this.mark)}},{key:"merge",value:function(e){return e instanceof n&&e.mark.eq(this.mark)&&this.from<=e.to&&this.to>=e.from?new n(Math.min(this.from,e.from),Math.max(this.to,e.to),this.mark):null}},{key:"toJSON",value:function(){return{stepType:"removeMark",mark:this.mark.toJSON(),from:this.from,to:this.to}}}],[{key:"fromJSON",value:function(e,t){if("number"!=typeof t.from||"number"!=typeof t.to)throw new RangeError("Invalid input for RemoveMarkStep.fromJSON");return new n(t.from,t.to,e.markFromJSON(t.mark))}}]),n}(S);S.jsonID("removeMark",C);var N=function(e){s(n,e);var t=l(n);function n(e,r){var o;return h(this,n),(o=t.call(this)).pos=e,o.mark=r,o}return p(n,[{key:"apply",value:function(e){var t=e.nodeAt(this.pos);if(!t)return x.fail("No node at mark step's position");var n=t.type.create(t.attrs,null,this.mark.addToSet(t.marks));return x.fromReplace(e,this.pos,this.pos+1,new v.Slice(v.Fragment.from(n),0,t.isLeaf?0:1))}},{key:"invert",value:function(e){var t=e.nodeAt(this.pos);if(t){var r=this.mark.addToSet(t.marks);if(r.length==t.marks.length){for(var o=0;o<t.marks.length;o++)if(!t.marks[o].isInSet(r))return new n(this.pos,t.marks[o]);return new n(this.pos,this.mark)}}return new T(this.pos,this.mark)}},{key:"map",value:function(e){var t=e.mapResult(this.pos,1);return t.deletedAfter?null:new n(t.pos,this.mark)}},{key:"toJSON",value:function(){return{stepType:"addNodeMark",pos:this.pos,mark:this.mark.toJSON()}}}],[{key:"fromJSON",value:function(e,t){if("number"!=typeof t.pos)throw new RangeError("Invalid input for AddNodeMarkStep.fromJSON");return new n(t.pos,e.markFromJSON(t.mark))}}]),n}(S);S.jsonID("addNodeMark",N);var T=function(e){s(n,e);var t=l(n);function n(e,r){var o;return h(this,n),(o=t.call(this)).pos=e,o.mark=r,o}return p(n,[{key:"apply",value:function(e){var t=e.nodeAt(this.pos);if(!t)return x.fail("No node at mark step's position");var n=t.type.create(t.attrs,null,this.mark.removeFromSet(t.marks));return x.fromReplace(e,this.pos,this.pos+1,new v.Slice(v.Fragment.from(n),0,t.isLeaf?0:1))}},{key:"invert",value:function(e){var t=e.nodeAt(this.pos);return t&&this.mark.isInSet(t.marks)?new N(this.pos,this.mark):this}},{key:"map",value:function(e){var t=e.mapResult(this.pos,1);return t.deletedAfter?null:new n(t.pos,this.mark)}},{key:"toJSON",value:function(){return{stepType:"removeNodeMark",pos:this.pos,mark:this.mark.toJSON()}}}],[{key:"fromJSON",value:function(e,t){if("number"!=typeof t.pos)throw new RangeError("Invalid input for RemoveNodeMarkStep.fromJSON");return new n(t.pos,e.markFromJSON(t.mark))}}]),n}(S);S.jsonID("removeNodeMark",T);var D=function(e){s(n,e);var t=l(n);function n(e,r,o){var i,s=arguments.length>3&&void 0!==arguments[3]&&arguments[3];return h(this,n),(i=t.call(this)).from=e,i.to=r,i.slice=o,i.structure=s,i}return p(n,[{key:"apply",value:function(e){return this.structure&&A(e,this.from,this.to)?x.fail("Structure replace would overwrite content"):x.fromReplace(e,this.from,this.to,this.slice)}},{key:"getMap",value:function(){return new k([this.from,this.to-this.from,this.slice.size])}},{key:"invert",value:function(e){return new n(this.from,this.from+this.slice.size,e.slice(this.from,this.to))}},{key:"map",value:function(e){var t=e.mapResult(this.from,1),r=e.mapResult(this.to,-1);return t.deletedAcross&&r.deletedAcross?null:new n(t.pos,Math.max(t.pos,r.pos),this.slice)}},{key:"merge",value:function(e){if(!(e instanceof n)||e.structure||this.structure)return null;if(this.from+this.slice.size!=e.from||this.slice.openEnd||e.slice.openStart){if(e.to!=this.from||this.slice.openStart||e.slice.openEnd)return null;var t=this.slice.size+e.slice.size==0?v.Slice.empty:new v.Slice(e.slice.content.append(this.slice.content),e.slice.openStart,this.slice.openEnd);return new n(e.from,this.to,t,this.structure)}var r=this.slice.size+e.slice.size==0?v.Slice.empty:new v.Slice(this.slice.content.append(e.slice.content),this.slice.openStart,e.slice.openEnd);return new n(this.from,this.to+(e.to-e.from),r,this.structure)}},{key:"toJSON",value:function(){var e={stepType:"replace",from:this.from,to:this.to};return this.slice.size&&(e.slice=this.slice.toJSON()),this.structure&&(e.structure=!0),e}}],[{key:"fromJSON",value:function(e,t){if("number"!=typeof t.from||"number"!=typeof t.to)throw new RangeError("Invalid input for ReplaceStep.fromJSON");return new n(t.from,t.to,v.Slice.fromJSON(e,t.slice),!!t.structure)}}]),n}(S);S.jsonID("replace",D);var E=function(e){s(n,e);var t=l(n);function n(e,r,o,i,s,a){var l,c=arguments.length>6&&void 0!==arguments[6]&&arguments[6];return h(this,n),(l=t.call(this)).from=e,l.to=r,l.gapFrom=o,l.gapTo=i,l.slice=s,l.insert=a,l.structure=c,l}return p(n,[{key:"apply",value:function(e){if(this.structure&&(A(e,this.from,this.gapFrom)||A(e,this.gapTo,this.to)))return x.fail("Structure gap-replace would overwrite content");var t=e.slice(this.gapFrom,this.gapTo);if(t.openStart||t.openEnd)return x.fail("Gap is not a flat range");var n=this.slice.insertAt(this.insert,t.content);return n?x.fromReplace(e,this.from,this.to,n):x.fail("Content does not fit in gap")}},{key:"getMap",value:function(){return new k([this.from,this.gapFrom-this.from,this.insert,this.gapTo,this.to-this.gapTo,this.slice.size-this.insert])}},{key:"invert",value:function(e){var t=this.gapTo-this.gapFrom;return new n(this.from,this.from+this.slice.size+t,this.from+this.insert,this.from+this.insert+t,e.slice(this.from,this.to).removeBetween(this.gapFrom-this.from,this.gapTo-this.from),this.gapFrom-this.from,this.structure)}},{key:"map",value:function(e){var t=e.mapResult(this.from,1),r=e.mapResult(this.to,-1),o=e.map(this.gapFrom,-1),i=e.map(this.gapTo,1);return t.deletedAcross&&r.deletedAcross||o<t.pos||i>r.pos?null:new n(t.pos,r.pos,o,i,this.slice,this.insert,this.structure)}},{key:"toJSON",value:function(){var e={stepType:"replaceAround",from:this.from,to:this.to,gapFrom:this.gapFrom,gapTo:this.gapTo,insert:this.insert};return this.slice.size&&(e.slice=this.slice.toJSON()),this.structure&&(e.structure=!0),e}}],[{key:"fromJSON",value:function(e,t){if("number"!=typeof t.from||"number"!=typeof t.to||"number"!=typeof t.gapFrom||"number"!=typeof t.gapTo||"number"!=typeof t.insert)throw new RangeError("Invalid input for ReplaceAroundStep.fromJSON");return new n(t.from,t.to,t.gapFrom,t.gapTo,v.Slice.fromJSON(e,t.slice),t.insert,!!t.structure)}}]),n}(S);function A(e,t,n){for(var r=e.resolve(t),o=n-t,i=r.depth;o>0&&i>0&&r.indexAfter(i)==r.node(i).childCount;)i--,o--;if(o>0)for(var s=r.node(i).maybeChild(r.indexAfter(i));o>0;){if(!s||s.isLeaf)return!0;s=s.firstChild,o--}return!1}function P(e,t,n){return(0==t||e.canReplace(t,e.childCount))&&(n==e.childCount||e.canReplace(0,n))}function R(e){return{type:e,attrs:null}}function I(e,t){var n=e.parent,r=e.startIndex,o=e.endIndex,i=n.contentMatchAt(r).findWrapping(t);if(!i)return null;var s=i.length?i[0]:t;return n.canReplaceWith(r,o,s)?i:null}function z(e,t){var n=e.parent,r=e.startIndex,o=e.endIndex,i=n.child(r),s=t.contentMatch.findWrapping(i.type);if(!s)return null;for(var a=(s.length?s[s.length-1]:t).contentMatch,l=r;a&&l<o;l++)a=a.matchType(n.child(l).type);return a&&a.validEnd?s:null}function F(e,t,n,r,o){if(!r.isTextblock)throw new RangeError("Type given to setBlockType should be a textblock");var i=e.steps.length;e.doc.nodesBetween(t,n,(function(t,n){if(t.isTextblock&&!t.hasMarkup(r,o)&&function(e,t,n){var r=e.resolve(t),o=r.index();return r.parent.canReplaceWith(o,o+1,n)}(e.doc,e.mapping.slice(i).map(n),r)){e.clearIncompatible(e.mapping.slice(i).map(n,1),r);var s=e.mapping.slice(i),a=s.map(n,1),l=s.map(n+t.nodeSize,1);return e.step(new E(a,l,a+1,l-1,new v.Slice(v.Fragment.from(r.create(o,null,t.marks)),0,0),1,!0)),!1}}))}function B(e,t,n,r,o){var i=e.doc.nodeAt(t);if(!i)throw new RangeError("No node at given position");n||(n=i.type);var s=n.create(r,null,o||i.marks);if(i.isLeaf)return e.replaceWith(t,t+i.nodeSize,s);if(!n.validContent(i.content))throw new RangeError("Invalid content for node type "+n.name);e.step(new E(t,t+i.nodeSize,t+1,t+i.nodeSize-1,new v.Slice(v.Fragment.from(s),0,0),1,!0))}function V(e,t){for(var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1,r=arguments.length>3?arguments[3]:void 0,o=e.doc.resolve(t),i=v.Fragment.empty,s=v.Fragment.empty,a=o.depth,l=o.depth-n,c=n-1;a>l;a--,c--){i=v.Fragment.from(o.node(a).copy(i));var u=r&&r[c];s=v.Fragment.from(u?u.type.create(u.attrs,s):o.node(a).copy(s))}e.step(new D(t,t,new v.Slice(i.append(s),n,n),!0))}function j(e,t){return!(!e||!t||e.isLeaf||!e.canAppend(t))}function $(e,t,n){var r=new D(t-n,t+n,v.Slice.empty,!0);e.step(r)}function q(e,t,n){var r=e.resolve(t);if(r.parent.canReplaceWith(r.index(),r.index(),n))return t;if(0==r.parentOffset)for(var o=r.depth-1;o>=0;o--){var i=r.index(o);if(r.node(o).canReplaceWith(i,i,n))return r.before(o+1);if(i>0)return null}if(r.parentOffset==r.parent.content.size)for(var s=r.depth-1;s>=0;s--){var a=r.indexAfter(s);if(r.node(s).canReplaceWith(a,a,n))return r.after(s+1);if(a<r.node(s).childCount)return null}return null}function _(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:t,r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:v.Slice.empty;if(t==n&&!r.size)return null;var o=e.resolve(t),i=e.resolve(n);return L(o,i,r)?new D(t,n,r):new J(o,i,r).fit()}function L(e,t,n){return!n.openStart&&!n.openEnd&&e.start()==t.start()&&e.parent.canReplace(e.index(),t.index(),n.content)}S.jsonID("replaceAround",E);var J=function(){function e(t,n,r){h(this,e),this.$from=t,this.$to=n,this.unplaced=r,this.frontier=[],this.placed=v.Fragment.empty;for(var o=0;o<=t.depth;o++){var i=t.node(o);this.frontier.push({type:i.type,match:i.contentMatchAt(t.indexAfter(o))})}for(var s=t.depth;s>0;s--)this.placed=v.Fragment.from(t.node(s).copy(this.placed))}return p(e,[{key:"depth",get:function(){return this.frontier.length-1}},{key:"fit",value:function(){for(;this.unplaced.size;){var e=this.findFittable();e?this.placeNodes(e):this.openMore()||this.dropNode()}var t=this.mustMoveInline(),n=this.placed.size-this.depth-this.$from.depth,r=this.$from,o=this.close(t<0?this.$to:r.doc.resolve(t));if(!o)return null;for(var i=this.placed,s=r.depth,a=o.depth;s&&a&&1==i.childCount;)i=i.firstChild.content,s--,a--;var l=new v.Slice(i,s,a);return t>-1?new E(r.pos,t,this.$to.pos,this.$to.end(),l,n):l.size||r.pos!=this.$to.pos?new D(r.pos,o.pos,l):null}},{key:"findFittable",value:function(){for(var e=this.unplaced.openStart,t=this.unplaced.content,n=0,r=this.unplaced.openEnd;n<e;n++){var o=t.firstChild;if(t.childCount>1&&(r=0),o.type.spec.isolating&&r<=n){e=n;break}t=o.content}for(var i=1;i<=2;i++)for(var s=1==i?e:this.unplaced.openStart;s>=0;s--)for(var a=null,l=(s?(a=H(this.unplaced.content,s-1).firstChild).content:this.unplaced.content).firstChild,c=this.depth;c>=0;c--){var u=this.frontier[c],f=u.type,h=u.match,d=void 0,p=null;if(1==i&&(l?h.matchType(l.type)||(p=h.fillBefore(v.Fragment.from(l),!1)):a&&f.compatibleContent(a.type)))return{sliceDepth:s,frontierDepth:c,parent:a,inject:p};if(2==i&&l&&(d=h.findWrapping(l.type)))return{sliceDepth:s,frontierDepth:c,parent:a,wrap:d};if(a&&h.matchType(a.type))break}}},{key:"openMore",value:function(){var e=this.unplaced,t=e.content,n=e.openStart,r=e.openEnd,o=H(t,n);return!(!o.childCount||o.firstChild.isLeaf||(this.unplaced=new v.Slice(t,n+1,Math.max(r,o.size+n>=t.size-r?n+1:0)),0))}},{key:"dropNode",value:function(){var e=this.unplaced,t=e.content,n=e.openStart,r=e.openEnd,o=H(t,n);if(o.childCount<=1&&n>0){var i=t.size-n<=n+o.size;this.unplaced=new v.Slice(W(t,n-1,1),n-1,i?n-1:r)}else this.unplaced=new v.Slice(W(t,n,1),n,r)}},{key:"placeNodes",value:function(e){for(var t=e.sliceDepth,n=e.frontierDepth,r=e.parent,o=e.inject,i=e.wrap;this.depth>n;)this.closeFrontierNode();if(i)for(var s=0;s<i.length;s++)this.openFrontierNode(i[s]);var a=this.unplaced,l=r?r.content:a.content,c=a.openStart-t,u=0,f=[],h=this.frontier[n],d=h.match,p=h.type;if(o){for(s=0;s<o.childCount;s++)f.push(o.child(s));d=d.matchFragment(o)}for(var m=l.size+t-(a.content.size-a.openEnd);u<l.childCount;){var y=l.child(u),g=d.matchType(y.type);if(!g)break;(++u>1||0==c||y.content.size)&&(d=g,f.push(U(y.mark(p.allowedMarks(y.marks)),1==u?c:0,u==l.childCount?m:-1)))}var k=u==l.childCount;k||(m=-1),this.placed=K(this.placed,n,v.Fragment.from(f)),this.frontier[n].match=d,k&&m<0&&r&&r.type==this.frontier[this.depth].type&&this.frontier.length>1&&this.closeFrontierNode();for(var w=0,b=l;w<m;w++){var S=b.lastChild;this.frontier.push({type:S.type,match:S.contentMatchAt(S.childCount)}),b=S.content}this.unplaced=k?0==t?v.Slice.empty:new v.Slice(W(a.content,t-1,1),t-1,m<0?a.openEnd:t-1):new v.Slice(W(a.content,t,u),a.openStart,a.openEnd)}},{key:"mustMoveInline",value:function(){if(!this.$to.parent.isTextblock)return-1;var e,t=this.frontier[this.depth];if(!t.type.isTextblock||!G(this.$to,this.$to.depth,t.type,t.match,!1)||this.$to.depth==this.depth&&(e=this.findCloseLevel(this.$to))&&e.depth==this.depth)return-1;for(var n=this.$to.depth,r=this.$to.after(n);n>1&&r==this.$to.end(--n);)++r;return r}},{key:"findCloseLevel",value:function(e){e:for(var t=Math.min(this.depth,e.depth);t>=0;t--){var n=this.frontier[t],r=n.match,o=n.type,i=t<e.depth&&e.end(t+1)==e.pos+(e.depth-(t+1)),s=G(e,t,o,r,i);if(s){for(var a=t-1;a>=0;a--){var l=this.frontier[a],c=l.match,u=G(e,a,l.type,c,!0);if(!u||u.childCount)continue e}return{depth:t,fit:s,move:i?e.doc.resolve(e.after(t+1)):e}}}}},{key:"close",value:function(e){var t=this.findCloseLevel(e);if(!t)return null;for(;this.depth>t.depth;)this.closeFrontierNode();t.fit.childCount&&(this.placed=K(this.placed,t.depth,t.fit)),e=t.move;for(var n=t.depth+1;n<=e.depth;n++){var r=e.node(n),o=r.type.contentMatch.fillBefore(r.content,!0,e.index(n));this.openFrontierNode(r.type,r.attrs,o)}return e}},{key:"openFrontierNode",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,n=arguments.length>2?arguments[2]:void 0,r=this.frontier[this.depth];r.match=r.match.matchType(e),this.placed=K(this.placed,this.depth,v.Fragment.from(e.create(t,n))),this.frontier.push({type:e,match:e.contentMatch})}},{key:"closeFrontierNode",value:function(){var e=this.frontier.pop().match.fillBefore(v.Fragment.empty,!0);e.childCount&&(this.placed=K(this.placed,this.frontier.length,e))}}]),e}();function W(e,t,n){return 0==t?e.cutByIndex(n,e.childCount):e.replaceChild(0,e.firstChild.copy(W(e.firstChild.content,t-1,n)))}function K(e,t,n){return 0==t?e.append(n):e.replaceChild(e.childCount-1,e.lastChild.copy(K(e.lastChild.content,t-1,n)))}function H(e,t){for(var n=0;n<t;n++)e=e.firstChild.content;return e}function U(e,t,n){if(t<=0)return e;var r=e.content;return t>1&&(r=r.replaceChild(0,U(r.firstChild,t-1,1==r.childCount?n-1:0))),t>0&&(r=e.type.contentMatch.fillBefore(r).append(r),n<=0&&(r=r.append(e.type.contentMatch.matchFragment(r).fillBefore(v.Fragment.empty,!0)))),e.copy(r)}function G(e,t,n,r,o){var i=e.node(t),s=o?e.indexAfter(t):e.index(t);if(s==i.childCount&&!n.compatibleContent(i.type))return null;var a=r.fillBefore(i.content,!0,s);return a&&!function(e,t,n){for(var r=n;r<t.childCount;r++)if(!e.allowsMarks(t.child(r).marks))return!0;return!1}(n,i.content,s)?a:null}function Z(e){return e.spec.defining||e.spec.definingForContent}function Q(e,t,n,r,o){if(t<n){var i=e.firstChild;e=e.replaceChild(0,i.copy(Q(i.content,t+1,n,r,i)))}if(t>r){var s=o.contentMatchAt(0),a=s.fillBefore(e).append(e);e=a.append(s.matchFragment(a).fillBefore(v.Fragment.empty,!0))}return e}function X(e,t){for(var n=[],r=Math.min(e.depth,t.depth);r>=0;r--){var o=e.start(r);if(o<e.pos-(e.depth-r)||t.end(r)>t.pos+(t.depth-r)||e.node(r).type.spec.isolating||t.node(r).type.spec.isolating)break;(o==t.start(r)||r==e.depth&&r==t.depth&&e.parent.inlineContent&&t.parent.inlineContent&&r&&t.start(r-1)==o-1)&&n.push(r)}return n}var Y=function(e){s(n,e);var t=l(n);function n(e,r,o){var i;return h(this,n),(i=t.call(this)).pos=e,i.attr=r,i.value=o,i}return p(n,[{key:"apply",value:function(e){var t=e.nodeAt(this.pos);if(!t)return x.fail("No node at attribute step's position");var n=Object.create(null);for(var r in t.attrs)n[r]=t.attrs[r];n[this.attr]=this.value;var o=t.type.create(n,null,t.marks);return x.fromReplace(e,this.pos,this.pos+1,new v.Slice(v.Fragment.from(o),0,t.isLeaf?0:1))}},{key:"getMap",value:function(){return k.empty}},{key:"invert",value:function(e){return new n(this.pos,this.attr,e.nodeAt(this.pos).attrs[this.attr])}},{key:"map",value:function(e){var t=e.mapResult(this.pos,1);return t.deletedAfter?null:new n(t.pos,this.attr,this.value)}},{key:"toJSON",value:function(){return{stepType:"attr",pos:this.pos,attr:this.attr,value:this.value}}}],[{key:"fromJSON",value:function(e,t){if("number"!=typeof t.pos||"string"!=typeof t.attr)throw new RangeError("Invalid input for AttrStep.fromJSON");return new n(t.pos,t.attr,t.value)}}]),n}(S);S.jsonID("attr",Y),t.TransformError=function(e){s(n,e);var t=l(n);function n(){return h(this,n),t.apply(this,arguments)}return p(n)}(o(Error)),t.TransformError=function e(t){var n=Error.call(this,t);return n.__proto__=e.prototype,n},t.TransformError.prototype=Object.create(Error.prototype),t.TransformError.prototype.constructor=t.TransformError,t.TransformError.prototype.name="TransformError";var ee=function(){function e(t){h(this,e),this.doc=t,this.steps=[],this.docs=[],this.mapping=new w}return p(e,[{key:"before",get:function(){return this.docs.length?this.docs[0]:this.doc}},{key:"step",value:function(e){var n=this.maybeStep(e);if(n.failed)throw new t.TransformError(n.failed);return this}},{key:"maybeStep",value:function(e){var t=e.apply(this.doc);return t.failed||this.addStep(e,t.doc),t}},{key:"docChanged",get:function(){return this.steps.length>0}},{key:"addStep",value:function(e,t){this.docs.push(this.doc),this.steps.push(e),this.mapping.appendMap(e.getMap()),this.doc=t}},{key:"replace",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:e,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:v.Slice.empty,r=_(this.doc,e,t,n);return r&&this.step(r),this}},{key:"replaceWith",value:function(e,t,n){return this.replace(e,t,new v.Slice(v.Fragment.from(n),0,0))}},{key:"delete",value:function(e,t){return this.replace(e,t,v.Slice.empty)}},{key:"insert",value:function(e,t){return this.replaceWith(e,e,t)}},{key:"replaceRange",value:function(e,t,n){return function(e,t,n,r){if(!r.size)return e.deleteRange(t,n);var o=e.doc.resolve(t),i=e.doc.resolve(n);if(L(o,i,r))return e.step(new D(t,n,r));var s=X(o,e.doc.resolve(n));0==s[s.length-1]&&s.pop();var a=-(o.depth+1);s.unshift(a);for(var l=o.depth,c=o.pos-1;l>0;l--,c--){var u=o.node(l).type.spec;if(u.defining||u.definingAsContext||u.isolating)break;s.indexOf(l)>-1?a=l:o.before(l)==c&&s.splice(1,0,-l)}for(var f=s.indexOf(a),h=[],d=r.openStart,p=r.content,m=0;;m++){var y=p.firstChild;if(h.push(y),m==r.openStart)break;p=y.content}for(var g=d-1;g>=0;g--){var k=h[g].type,w=Z(k);if(w&&o.node(f).type!=k)d=g;else if(w||!k.isTextblock)break}for(var b=r.openStart;b>=0;b--){var S=(b+d+1)%(r.openStart+1),x=h[S];if(x)for(var M=0;M<s.length;M++){var O=s[(M+f)%s.length],C=!0;O<0&&(C=!1,O=-O);var N=o.node(O-1),T=o.index(O-1);if(N.canReplaceWith(T,T,x.type,x.marks))return e.replace(o.before(O),C?i.after(O):n,new v.Slice(Q(r.content,0,r.openStart,S),S,r.openEnd))}}for(var E=e.steps.length,A=s.length-1;A>=0&&(e.replace(t,n,r),!(e.steps.length>E));A--){var P=s[A];P<0||(t=o.before(P),n=i.after(P))}}(this,e,t,n),this}},{key:"replaceRangeWith",value:function(e,t,n){return function(e,t,n,r){if(!r.isInline&&t==n&&e.doc.resolve(t).parent.content.size){var o=q(e.doc,t,r.type);null!=o&&(t=n=o)}e.replaceRange(t,n,new v.Slice(v.Fragment.from(r),0,0))}(this,e,t,n),this}},{key:"deleteRange",value:function(e,t){return function(e,t,n){for(var r=e.doc.resolve(t),o=e.doc.resolve(n),i=X(r,o),s=0;s<i.length;s++){var a=i[s],l=s==i.length-1;if(l&&0==a||r.node(a).type.contentMatch.validEnd)return e.delete(r.start(a),o.end(a));if(a>0&&(l||r.node(a-1).canReplace(r.index(a-1),o.indexAfter(a-1))))return e.delete(r.before(a),o.after(a))}for(var c=1;c<=r.depth&&c<=o.depth;c++)if(t-r.start(c)==r.depth-c&&n>r.end(c)&&o.end(c)-n!=o.depth-c)return e.delete(r.before(c),n);e.delete(t,n)}(this,e,t),this}},{key:"lift",value:function(e,t){return function(e,t,n){for(var r=t.$from,o=t.$to,i=t.depth,s=r.before(i+1),a=o.after(i+1),l=s,c=a,u=v.Fragment.empty,f=0,h=i,d=!1;h>n;h--)d||r.index(h)>0?(d=!0,u=v.Fragment.from(r.node(h).copy(u)),f++):l--;for(var p=v.Fragment.empty,m=0,y=i,g=!1;y>n;y--)g||o.after(y+1)<o.end(y)?(g=!0,p=v.Fragment.from(o.node(y).copy(p)),m++):c++;e.step(new E(l,c,s,a,new v.Slice(u.append(p),f,m),u.size-f,!0))}(this,e,t),this}},{key:"join",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1;return $(this,e,t),this}},{key:"wrap",value:function(e,t){return function(e,t,n){for(var r=v.Fragment.empty,o=n.length-1;o>=0;o--){if(r.size){var i=n[o].type.contentMatch.matchFragment(r);if(!i||!i.validEnd)throw new RangeError("Wrapper type given to Transform.wrap does not form valid content of its parent wrapper")}r=v.Fragment.from(n[o].type.create(n[o].attrs,r))}var s=t.start,a=t.end;e.step(new E(s,a,s,a,new v.Slice(r,0,0),n.length,!0))}(this,e,t),this}},{key:"setBlockType",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:e,n=arguments.length>2?arguments[2]:void 0,r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null;return F(this,e,t,n,r),this}},{key:"setNodeMarkup",value:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null,r=arguments.length>3?arguments[3]:void 0;return B(this,e,t,n,r),this}},{key:"setNodeAttribute",value:function(e,t,n){return this.step(new Y(e,t,n)),this}},{key:"addNodeMark",value:function(e,t){return this.step(new N(e,t)),this}},{key:"removeNodeMark",value:function(e,t){if(!(t instanceof v.Mark)){var n=this.doc.nodeAt(e);if(!n)throw new RangeError("No node at position "+e);if(!(t=t.isInSet(n.marks)))return this}return this.step(new T(e,t)),this}},{key:"split",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1,n=arguments.length>2?arguments[2]:void 0;return V(this,e,t,n),this}},{key:"addMark",value:function(e,t,n){return function(e,t,n,r){var o,i,s=[],a=[];e.doc.nodesBetween(t,n,(function(e,l,c){if(e.isInline){var u=e.marks;if(!r.isInSet(u)&&c.type.allowsMarkType(r.type)){for(var f=Math.max(l,t),h=Math.min(l+e.nodeSize,n),d=r.addToSet(u),p=0;p<u.length;p++)u[p].isInSet(d)||(o&&o.to==f&&o.mark.eq(u[p])?o.to=h:s.push(o=new C(f,h,u[p])));i&&i.to==f?i.to=h:a.push(i=new O(f,h,r))}}})),s.forEach((function(t){return e.step(t)})),a.forEach((function(t){return e.step(t)}))}(this,e,t,n),this}},{key:"removeMark",value:function(e,t,n){return function(e,t,n,r){var o=[],i=0;e.doc.nodesBetween(t,n,(function(e,s){if(e.isInline){i++;var a=null;if(r instanceof v.MarkType)for(var l,c=e.marks;l=r.isInSet(c);)(a||(a=[])).push(l),c=l.removeFromSet(c);else r?r.isInSet(e.marks)&&(a=[r]):a=e.marks;if(a&&a.length)for(var u=Math.min(s+e.nodeSize,n),f=0;f<a.length;f++){for(var h=a[f],d=void 0,p=0;p<o.length;p++){var m=o[p];m.step==i-1&&h.eq(o[p].style)&&(d=m)}d?(d.to=u,d.step=i):o.push({style:h,from:Math.max(s,t),to:u,step:i})}}})),o.forEach((function(t){return e.step(new C(t.from,t.to,t.style))}))}(this,e,t,n),this}},{key:"clearIncompatible",value:function(e,t,n){return function(e,t,n){for(var r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:n.contentMatch,o=e.doc.nodeAt(t),i=[],s=t+1,a=0;a<o.childCount;a++){var l=o.child(a),c=s+l.nodeSize,u=r.matchType(l.type);if(u){r=u;for(var f=0;f<l.marks.length;f++)n.allowsMarkType(l.marks[f].type)||e.step(new C(s,c,l.marks[f]))}else i.push(new D(s,c,v.Slice.empty));s=c}if(!r.validEnd){var h=r.fillBefore(v.Fragment.empty,!0);e.replace(s,s,new v.Slice(h,0,0))}for(var d=i.length-1;d>=0;d--)e.step(i[d])}(this,e,t,n),this}}]),e}();t.AddMarkStep=O,t.AddNodeMarkStep=N,t.AttrStep=Y,t.MapResult=g,t.Mapping=w,t.RemoveMarkStep=C,t.RemoveNodeMarkStep=T,t.ReplaceAroundStep=E,t.ReplaceStep=D,t.Step=S,t.StepMap=k,t.StepResult=x,t.Transform=ee,t.canJoin=function(e,t){var n=e.resolve(t),r=n.index();return j(n.nodeBefore,n.nodeAfter)&&n.parent.canReplace(r,r+1)},t.canSplit=function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1,r=arguments.length>3?arguments[3]:void 0,o=e.resolve(t),i=o.depth-n,s=r&&r[r.length-1]||o.parent;if(i<0||o.parent.type.spec.isolating||!o.parent.canReplace(o.index(),o.parent.childCount)||!s.type.validContent(o.parent.content.cutByIndex(o.index(),o.parent.childCount)))return!1;for(var a=o.depth-1,l=n-2;a>i;a--,l--){var c=o.node(a),u=o.index(a);if(c.type.spec.isolating)return!1;var f=c.content.cutByIndex(u,c.childCount),h=r&&r[l]||c;if(h!=c&&(f=f.replaceChild(0,h.type.create(h.attrs))),!c.canReplace(u+1,c.childCount)||!h.type.validContent(f))return!1}var d=o.indexAfter(i),p=r&&r[0];return o.node(i).canReplaceWith(d,d,p?p.type:o.node(i+1).type)},t.dropPoint=function(e,t,n){var r=e.resolve(t);if(!n.content.size)return t;for(var o=n.content,i=0;i<n.openStart;i++)o=o.firstChild.content;for(var s=1;s<=(0==n.openStart&&n.size?2:1);s++)for(var a=r.depth;a>=0;a--){var l=a==r.depth?0:r.pos<=(r.start(a+1)+r.end(a+1))/2?-1:1,c=r.index(a)+(l>0?1:0),u=r.node(a),f=!1;if(1==s)f=u.canReplace(c,c,o);else{var h=u.contentMatchAt(c).findWrapping(o.firstChild.type);f=h&&u.canReplaceWith(c,c,h[0])}if(f)return 0==l?r.pos:l<0?r.before(a+1):r.after(a+1)}return null},t.findWrapping=function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null,r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:e,o=I(e,t),i=o&&z(r,t);return i?o.map(R).concat({type:t,attrs:n}).concat(i.map(R)):null},t.insertPoint=q,t.joinPoint=function(e,t){for(var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:-1,r=e.resolve(t),o=r.depth;;o--){var i=void 0,s=void 0,a=r.index(o);if(o==r.depth?(i=r.nodeBefore,s=r.nodeAfter):n>0?(i=r.node(o+1),a++,s=r.node(o).maybeChild(a)):(i=r.node(o).maybeChild(a-1),s=r.node(o+1)),i&&!i.isTextblock&&j(i,s)&&r.node(o).canReplace(a,a+1))return t;if(0==o)break;t=n<0?r.before(o):r.after(o)}},t.liftTarget=function(e){for(var t=e.parent.content.cutByIndex(e.startIndex,e.endIndex),n=e.depth;;--n){var r=e.$from.node(n),o=e.$from.index(n),i=e.$to.indexAfter(n);if(n<e.depth&&r.canReplace(o,i,t))return n;if(0==n||r.type.spec.isolating||!P(r,o,i))break}return null},t.replaceStep=_},222:(e,t,n)=>{function r(e){return r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},r(e)}function o(){return o="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,n){var r=i(e,t);if(r){var o=Object.getOwnPropertyDescriptor(r,t);return o.get?o.get.call(arguments.length<3?e:n):o.value}},o.apply(this,arguments)}function i(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=f(e)););return e}function s(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&a(e,t)}function a(e,t){return a=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e},a(e,t)}function l(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=f(e);if(t){var o=f(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return c(this,n)}}function c(e,t){if(t&&("object"===r(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return u(e)}function u(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function f(e){return f=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)},f(e)}function h(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function d(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function p(e,t,n){return t&&d(e.prototype,t),n&&d(e,n),Object.defineProperty(e,"prototype",{writable:!1}),e}Object.defineProperty(t,"__esModule",{value:!0});var v=n(391),m=n(443),y=n(843),g=function(e){for(var t=0;;t++)if(!(e=e.previousSibling))return t},k=function(e){var t=e.assignedSlot||e.parentNode;return t&&11==t.nodeType?t.host:t},w=null,b=function(e,t,n){var r=w||(w=document.createRange());return r.setEnd(e,null==n?e.nodeValue.length:n),r.setStart(e,t||0),r},S=function(e,t,n,r){return n&&(M(e,t,n,r,-1)||M(e,t,n,r,1))},x=/^(img|br|input|textarea|hr)$/i;function M(e,t,n,r,o){for(;;){if(e==n&&t==r)return!0;if(t==(o<0?0:O(e))){var i=e.parentNode;if(!i||1!=i.nodeType||N(e)||x.test(e.nodeName)||"false"==e.contentEditable)return!1;t=g(e)+(o<0?0:1),e=i}else{if(1!=e.nodeType)return!1;if("false"==(e=e.childNodes[t+(o<0?-1:0)]).contentEditable)return!1;t=o<0?O(e):0}}}function O(e){return 3==e.nodeType?e.nodeValue.length:e.childNodes.length}function C(e,t,n){for(var r=0==t,o=t==O(e);r||o;){if(e==n)return!0;var i=g(e);if(!(e=e.parentNode))return!1;r=r&&0==i,o=o&&i==O(e)}}function N(e){for(var t,n=e;n&&!(t=n.pmViewDesc);n=n.parentNode);return t&&t.node&&t.node.isBlock&&(t.dom==e||t.contentDOM==e)}var T=function(e){return e.focusNode&&S(e.focusNode,e.focusOffset,e.anchorNode,e.anchorOffset)};function D(e,t){var n=document.createEvent("Event");return n.initEvent("keydown",!0,!0),n.keyCode=e,n.key=n.code=t,n}var E="undefined"!=typeof navigator?navigator:null,A="undefined"!=typeof document?document:null,P=E&&E.userAgent||"",R=/Edge\/(\d+)/.exec(P),I=/MSIE \d/.exec(P),z=/Trident\/(?:[7-9]|\d{2,})\..*rv:(\d+)/.exec(P),F=!!(I||z||R),B=I?document.documentMode:z?+z[1]:R?+R[1]:0,V=!F&&/gecko\/(\d+)/i.test(P);V&&(/Firefox\/(\d+)/.exec(P)||[0,0])[1];var j=!F&&/Chrome\/(\d+)/.exec(P),$=!!j,q=j?+j[1]:0,_=!F&&!!E&&/Apple Computer/.test(E.vendor),L=_&&(/Mobile\/\w+/.test(P)||!!E&&E.maxTouchPoints>2),J=L||!!E&&/Mac/.test(E.platform),W=/Android \d/.test(P),K=!!A&&"webkitFontSmoothing"in A.documentElement.style,H=K?+(/\bAppleWebKit\/(\d+)/.exec(navigator.userAgent)||[0,0])[1]:0;function U(e){return{left:0,right:e.documentElement.clientWidth,top:0,bottom:e.documentElement.clientHeight}}function G(e,t){return"number"==typeof e?e:e[t]}function Z(e){var t=e.getBoundingClientRect(),n=t.width/e.offsetWidth||1,r=t.height/e.offsetHeight||1;return{left:t.left,right:t.left+e.clientWidth*n,top:t.top,bottom:t.top+e.clientHeight*r}}function Q(e,t,n){for(var r=e.someProp("scrollThreshold")||0,o=e.someProp("scrollMargin")||5,i=e.dom.ownerDocument,s=n||e.dom;s;s=k(s))if(1==s.nodeType){var a=s,l=a==i.body,c=l?U(i):Z(a),u=0,f=0;if(t.top<c.top+G(r,"top")?f=-(c.top-t.top+G(o,"top")):t.bottom>c.bottom-G(r,"bottom")&&(f=t.bottom-c.bottom+G(o,"bottom")),t.left<c.left+G(r,"left")?u=-(c.left-t.left+G(o,"left")):t.right>c.right-G(r,"right")&&(u=t.right-c.right+G(o,"right")),u||f)if(l)i.defaultView.scrollBy(u,f);else{var h=a.scrollLeft,d=a.scrollTop;f&&(a.scrollTop+=f),u&&(a.scrollLeft+=u);var p=a.scrollLeft-h,v=a.scrollTop-d;t={left:t.left-p,top:t.top-v,right:t.right-p,bottom:t.bottom-v}}if(l)break}}function X(e){for(var t=[],n=e.ownerDocument,r=e;r&&(t.push({dom:r,top:r.scrollTop,left:r.scrollLeft}),e!=n);r=k(r));return t}function Y(e,t){for(var n=0;n<e.length;n++){var r=e[n],o=r.dom,i=r.top,s=r.left;o.scrollTop!=i+t&&(o.scrollTop=i+t),o.scrollLeft!=s&&(o.scrollLeft=s)}}var ee=null;function te(e,t){for(var n,r,o=2e8,i=0,s=t.top,a=t.top,l=e.firstChild,c=0;l;l=l.nextSibling,c++){var u=void 0;if(1==l.nodeType)u=l.getClientRects();else{if(3!=l.nodeType)continue;u=b(l).getClientRects()}for(var f=0;f<u.length;f++){var h=u[f];if(h.top<=s&&h.bottom>=a){s=Math.max(h.bottom,s),a=Math.min(h.top,a);var d=h.left>t.left?h.left-t.left:h.right<t.left?t.left-h.right:0;if(d<o){n=l,o=d,r=d&&3==n.nodeType?{left:h.right<t.left?h.right:h.left,top:t.top}:t,1==l.nodeType&&d&&(i=c+(t.left>=(h.left+h.right)/2?1:0));continue}}!n&&(t.left>=h.right&&t.top>=h.top||t.left>=h.left&&t.top>=h.bottom)&&(i=c+1)}}return n&&3==n.nodeType?function(e,t){for(var n=e.nodeValue.length,r=document.createRange(),o=0;o<n;o++){r.setEnd(e,o+1),r.setStart(e,o);var i=ie(r,1);if(i.top!=i.bottom&&ne(t,i))return{node:e,offset:o+(t.left>=(i.left+i.right)/2?1:0)}}return{node:e,offset:0}}(n,r):!n||o&&1==n.nodeType?{node:e,offset:i}:te(n,r)}function ne(e,t){return e.left>=t.left-1&&e.left<=t.right+1&&e.top>=t.top-1&&e.top<=t.bottom+1}function re(e,t,n){var r=e.childNodes.length;if(r&&n.top<n.bottom)for(var o=Math.max(0,Math.min(r-1,Math.floor(r*(t.top-n.top)/(n.bottom-n.top))-2)),i=o;;){var s=e.childNodes[i];if(1==s.nodeType)for(var a=s.getClientRects(),l=0;l<a.length;l++){var c=a[l];if(ne(t,c))return re(s,t,c)}if((i=(i+1)%r)==o)break}return e}function oe(e,t){var n,r=e.dom.ownerDocument,o=0;if(r.caretPositionFromPoint)try{var i=r.caretPositionFromPoint(t.left,t.top);i&&(n=i.offsetNode,o=i.offset)}catch(e){}if(!n&&r.caretRangeFromPoint){var s=r.caretRangeFromPoint(t.left,t.top);s&&(n=s.startContainer,o=s.startOffset)}var a,l=(e.root.elementFromPoint?e.root:r).elementFromPoint(t.left,t.top);if(!l||!e.dom.contains(1!=l.nodeType?l.parentNode:l)){var c=e.dom.getBoundingClientRect();if(!ne(t,c))return null;if(!(l=re(e.dom,t,c)))return null}if(_)for(var u=l;n&&u;u=k(u))u.draggable&&(n=void 0);if(l=function(e,t){var n=e.parentNode;return n&&/^li$/i.test(n.nodeName)&&t.left<e.getBoundingClientRect().left?n:e}(l,t),n){if(V&&1==n.nodeType&&(o=Math.min(o,n.childNodes.length))<n.childNodes.length){var f,h=n.childNodes[o];"IMG"==h.nodeName&&(f=h.getBoundingClientRect()).right<=t.left&&f.bottom>t.top&&o++}n==e.dom&&o==n.childNodes.length-1&&1==n.lastChild.nodeType&&t.top>n.lastChild.getBoundingClientRect().bottom?a=e.state.doc.content.size:0!=o&&1==n.nodeType&&"BR"==n.childNodes[o-1].nodeName||(a=function(e,t,n,r){for(var o=-1,i=t;i!=e.dom;){var s=e.docView.nearestDesc(i,!0);if(!s)return null;if(s.node.isBlock&&s.parent){var a=s.dom.getBoundingClientRect();if(a.left>r.left||a.top>r.top)o=s.posBefore;else{if(!(a.right<r.left||a.bottom<r.top))break;o=s.posAfter}}i=s.dom.parentNode}return o>-1?o:e.docView.posFromDOM(t,n,1)}(e,n,o,t))}null==a&&(a=function(e,t,n){var r=te(t,n),o=r.node,i=r.offset,s=-1;if(1==o.nodeType&&!o.firstChild){var a=o.getBoundingClientRect();s=a.left!=a.right&&n.left>(a.left+a.right)/2?1:-1}return e.docView.posFromDOM(o,i,s)}(e,l,t));var d=e.docView.nearestDesc(l,!0);return{pos:a,inside:d?d.posAtStart-d.border:-1}}function ie(e,t){var n=e.getClientRects();return n.length?n[t<0?0:n.length-1]:e.getBoundingClientRect()}var se=/[\u0590-\u05f4\u0600-\u06ff\u0700-\u08ac]/;function ae(e,t,n){var r=e.docView.domFromPos(t,n<0?-1:1),o=r.node,i=r.offset,s=r.atom,a=K||V;if(3==o.nodeType){if(!a||!se.test(o.nodeValue)&&(n<0?i:i!=o.nodeValue.length)){var l=i,c=i,u=n<0?1:-1;return n<0&&!i?(c++,u=-1):n>=0&&i==o.nodeValue.length?(l--,u=1):n<0?l--:c++,le(ie(b(o,l,c),1),u<0)}var f=ie(b(o,i,i),n);if(V&&i&&/\s/.test(o.nodeValue[i-1])&&i<o.nodeValue.length){var h=ie(b(o,i-1,i-1),-1);if(h.top==f.top){var d=ie(b(o,i,i+1),-1);if(d.top!=f.top)return le(d,d.left<h.left)}}return f}if(!e.state.doc.resolve(t-(s||0)).parent.inlineContent){if(null==s&&i&&(n<0||i==O(o))){var p=o.childNodes[i-1];if(1==p.nodeType)return ce(p.getBoundingClientRect(),!1)}if(null==s&&i<O(o)){var v=o.childNodes[i];if(1==v.nodeType)return ce(v.getBoundingClientRect(),!0)}return ce(o.getBoundingClientRect(),n>=0)}if(null==s&&i&&(n<0||i==O(o))){var m=o.childNodes[i-1],y=3==m.nodeType?b(m,O(m)-(a?0:1)):1!=m.nodeType||"BR"==m.nodeName&&m.nextSibling?null:m;if(y)return le(ie(y,1),!1)}if(null==s&&i<O(o)){for(var g=o.childNodes[i];g.pmViewDesc&&g.pmViewDesc.ignoreForCoords;)g=g.nextSibling;var k=g?3==g.nodeType?b(g,0,a?0:1):1==g.nodeType?g:null:null;if(k)return le(ie(k,-1),!0)}return le(ie(3==o.nodeType?b(o):o,-n),n>=0)}function le(e,t){if(0==e.width)return e;var n=t?e.left:e.right;return{top:e.top,bottom:e.bottom,left:n,right:n}}function ce(e,t){if(0==e.height)return e;var n=t?e.top:e.bottom;return{top:n,bottom:n,left:e.left,right:e.right}}function ue(e,t,n){var r=e.state,o=e.root.activeElement;r!=t&&e.updateState(t),o!=e.dom&&e.focus();try{return n()}finally{r!=t&&e.updateState(r),o!=e.dom&&o&&o.focus()}}var fe=/[\u0590-\u08ac]/,he=null,de=null,pe=!1;var ve=function(){function e(t,n,r,o){h(this,e),this.parent=t,this.children=n,this.dom=r,this.contentDOM=o,this.dirty=0,r.pmViewDesc=this}return p(e,[{key:"matchesWidget",value:function(e){return!1}},{key:"matchesMark",value:function(e){return!1}},{key:"matchesNode",value:function(e,t,n){return!1}},{key:"matchesHack",value:function(e){return!1}},{key:"parseRule",value:function(){return null}},{key:"stopEvent",value:function(e){return!1}},{key:"size",get:function(){for(var e=0,t=0;t<this.children.length;t++)e+=this.children[t].size;return e}},{key:"border",get:function(){return 0}},{key:"destroy",value:function(){this.parent=void 0,this.dom.pmViewDesc==this&&(this.dom.pmViewDesc=void 0);for(var e=0;e<this.children.length;e++)this.children[e].destroy()}},{key:"posBeforeChild",value:function(e){for(var t=0,n=this.posAtStart;;t++){var r=this.children[t];if(r==e)return n;n+=r.size}}},{key:"posBefore",get:function(){return this.parent.posBeforeChild(this)}},{key:"posAtStart",get:function(){return this.parent?this.parent.posBeforeChild(this)+this.border:0}},{key:"posAfter",get:function(){return this.posBefore+this.size}},{key:"posAtEnd",get:function(){return this.posAtStart+this.size-2*this.border}},{key:"localPosFromDOM",value:function(e,t,n){if(this.contentDOM&&this.contentDOM.contains(1==e.nodeType?e:e.parentNode)){if(n<0){var r,o;if(e==this.contentDOM)r=e.childNodes[t-1];else{for(;e.parentNode!=this.contentDOM;)e=e.parentNode;r=e.previousSibling}for(;r&&(!(o=r.pmViewDesc)||o.parent!=this);)r=r.previousSibling;return r?this.posBeforeChild(o)+o.size:this.posAtStart}var i,s;if(e==this.contentDOM)i=e.childNodes[t];else{for(;e.parentNode!=this.contentDOM;)e=e.parentNode;i=e.nextSibling}for(;i&&(!(s=i.pmViewDesc)||s.parent!=this);)i=i.nextSibling;return i?this.posBeforeChild(s):this.posAtEnd}var a;if(e==this.dom&&this.contentDOM)a=t>g(this.contentDOM);else if(this.contentDOM&&this.contentDOM!=this.dom&&this.dom.contains(this.contentDOM))a=2&e.compareDocumentPosition(this.contentDOM);else if(this.dom.firstChild){if(0==t)for(var l=e;;l=l.parentNode){if(l==this.dom){a=!1;break}if(l.previousSibling)break}if(null==a&&t==e.childNodes.length)for(var c=e;;c=c.parentNode){if(c==this.dom){a=!0;break}if(c.nextSibling)break}}return(null==a?n>0:a)?this.posAtEnd:this.posAtStart}},{key:"nearestDesc",value:function(e){for(var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],n=!0,r=e;r;r=r.parentNode){var o=this.getDesc(r),i=void 0;if(o&&(!t||o.node)){if(!n||!(i=o.nodeDOM)||(1==i.nodeType?i.contains(1==e.nodeType?e:e.parentNode):i==e))return o;n=!1}}}},{key:"getDesc",value:function(e){for(var t=e.pmViewDesc,n=t;n;n=n.parent)if(n==this)return t}},{key:"posFromDOM",value:function(e,t,n){for(var r=e;r;r=r.parentNode){var o=this.getDesc(r);if(o)return o.localPosFromDOM(e,t,n)}return-1}},{key:"descAt",value:function(e){for(var t=0,n=0;t<this.children.length;t++){var r=this.children[t],o=n+r.size;if(n==e&&o!=n){for(;!r.border&&r.children.length;)r=r.children[0];return r}if(e<o)return r.descAt(e-n-r.border);n=o}}},{key:"domFromPos",value:function(e,t){if(!this.contentDOM)return{node:this.dom,offset:0,atom:e+1};for(var n,r=0,o=0,i=0;r<this.children.length;r++){var s=this.children[r],a=i+s.size;if(a>e||s instanceof Se){o=e-i;break}i=a}if(o)return this.children[r].domFromPos(o-this.children[r].border,t);for(;r&&!(n=this.children[r-1]).size&&n instanceof me&&n.side>=0;r--);if(t<=0){for(var l,c=!0;(l=r?this.children[r-1]:null)&&l.dom.parentNode!=this.contentDOM;r--,c=!1);return l&&t&&c&&!l.border&&!l.domAtom?l.domFromPos(l.size,t):{node:this.contentDOM,offset:l?g(l.dom)+1:0}}for(var u,f=!0;(u=r<this.children.length?this.children[r]:null)&&u.dom.parentNode!=this.contentDOM;r++,f=!1);return u&&f&&!u.border&&!u.domAtom?u.domFromPos(0,t):{node:this.contentDOM,offset:u?g(u.dom):this.contentDOM.childNodes.length}}},{key:"parseRange",value:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;if(0==this.children.length)return{node:this.contentDOM,from:e,to:t,fromOffset:0,toOffset:this.contentDOM.childNodes.length};for(var r=-1,o=-1,i=n,s=0;;s++){var a=this.children[s],l=i+a.size;if(-1==r&&e<=l){var c=i+a.border;if(e>=c&&t<=l-a.border&&a.node&&a.contentDOM&&this.contentDOM.contains(a.contentDOM))return a.parseRange(e,t,c);e=i;for(var u=s;u>0;u--){var f=this.children[u-1];if(f.size&&f.dom.parentNode==this.contentDOM&&!f.emptyChildAt(1)){r=g(f.dom)+1;break}e-=f.size}-1==r&&(r=0)}if(r>-1&&(l>t||s==this.children.length-1)){t=l;for(var h=s+1;h<this.children.length;h++){var d=this.children[h];if(d.size&&d.dom.parentNode==this.contentDOM&&!d.emptyChildAt(-1)){o=g(d.dom);break}t+=d.size}-1==o&&(o=this.contentDOM.childNodes.length);break}i=l}return{node:this.contentDOM,from:e,to:t,fromOffset:r,toOffset:o}}},{key:"emptyChildAt",value:function(e){if(this.border||!this.contentDOM||!this.children.length)return!1;var t=this.children[e<0?0:this.children.length-1];return 0==t.size||t.emptyChildAt(e)}},{key:"domAfterPos",value:function(e){var t=this.domFromPos(e,0),n=t.node,r=t.offset;if(1!=n.nodeType||r==n.childNodes.length)throw new RangeError("No node after pos "+e);return n.childNodes[r]}},{key:"setSelection",value:function(e,t,n){for(var r=arguments.length>3&&void 0!==arguments[3]&&arguments[3],o=Math.min(e,t),i=Math.max(e,t),s=0,a=0;s<this.children.length;s++){var l=this.children[s],c=a+l.size;if(o>a&&i<c)return l.setSelection(e-a-l.border,t-a-l.border,n,r);a=c}var u=this.domFromPos(e,e?-1:1),f=t==e?u:this.domFromPos(t,t?-1:1),h=n.getSelection(),d=!1;if((V||_)&&e==t){var p=u,v=p.node,m=p.offset;if(3==v.nodeType){if((d=!(!m||"\n"!=v.nodeValue[m-1]))&&m==v.nodeValue.length)for(var y,k=v;k;k=k.parentNode){if(y=k.nextSibling){"BR"==y.nodeName&&(u=f={node:y.parentNode,offset:g(y)+1});break}var w=k.pmViewDesc;if(w&&w.node&&w.node.isBlock)break}}else{var b=v.childNodes[m-1];d=b&&("BR"==b.nodeName||"false"==b.contentEditable)}}if(V&&h.focusNode&&h.focusNode!=f.node&&1==h.focusNode.nodeType){var x=h.focusNode.childNodes[h.focusOffset];x&&"false"==x.contentEditable&&(r=!0)}if(r||d&&_||!S(u.node,u.offset,h.anchorNode,h.anchorOffset)||!S(f.node,f.offset,h.focusNode,h.focusOffset)){var M=!1;if((h.extend||e==t)&&!d){h.collapse(u.node,u.offset);try{e!=t&&h.extend(f.node,f.offset),M=!0}catch(e){}}if(!M){if(e>t){var O=u;u=f,f=O}var C=document.createRange();C.setEnd(f.node,f.offset),C.setStart(u.node,u.offset),h.removeAllRanges(),h.addRange(C)}}}},{key:"ignoreMutation",value:function(e){return!this.contentDOM&&"selection"!=e.type}},{key:"contentLost",get:function(){return this.contentDOM&&this.contentDOM!=this.dom&&!this.dom.contains(this.contentDOM)}},{key:"markDirty",value:function(e,t){for(var n=0,r=0;r<this.children.length;r++){var o=this.children[r],i=n+o.size;if(n==i?e<=i&&t>=n:e<i&&t>n){var s=n+o.border,a=i-o.border;if(e>=s&&t<=a)return this.dirty=e==n||t==i?2:1,void(e!=s||t!=a||!o.contentLost&&o.dom.parentNode==this.contentDOM?o.markDirty(e-s,t-s):o.dirty=3);o.dirty=o.dom!=o.contentDOM||o.dom.parentNode!=this.contentDOM||o.children.length?3:2}n=i}this.dirty=2}},{key:"markParentsDirty",value:function(){for(var e=1,t=this.parent;t;t=t.parent,e++){var n=1==e?2:1;t.dirty<n&&(t.dirty=n)}}},{key:"domAtom",get:function(){return!1}},{key:"ignoreForCoords",get:function(){return!1}}]),e}(),me=function(e){s(n,e);var t=l(n);function n(e,r,o,i){var s;h(this,n);var a,l=r.type.toDOM;if("function"==typeof l&&(l=l(o,(function(){return a?a.parent?a.parent.posBeforeChild(a):void 0:i}))),!r.type.spec.raw){if(1!=l.nodeType){var c=document.createElement("span");c.appendChild(l),l=c}l.contentEditable="false",l.classList.add("ProseMirror-widget")}return(s=t.call(this,e,[],l,null)).widget=r,s.widget=r,a=u(s),s}return p(n,[{key:"matchesWidget",value:function(e){return 0==this.dirty&&e.type.eq(this.widget.type)}},{key:"parseRule",value:function(){return{ignore:!0}}},{key:"stopEvent",value:function(e){var t=this.widget.spec.stopEvent;return!!t&&t(e)}},{key:"ignoreMutation",value:function(e){return"selection"!=e.type||this.widget.spec.ignoreSelection}},{key:"destroy",value:function(){this.widget.type.destroy(this.dom),o(f(n.prototype),"destroy",this).call(this)}},{key:"domAtom",get:function(){return!0}},{key:"side",get:function(){return this.widget.type.side}}]),n}(ve),ye=function(e){s(n,e);var t=l(n);function n(e,r,o,i){var s;return h(this,n),(s=t.call(this,e,[],r,null)).textDOM=o,s.text=i,s}return p(n,[{key:"size",get:function(){return this.text.length}},{key:"localPosFromDOM",value:function(e,t){return e!=this.textDOM?this.posAtStart+(t?this.size:0):this.posAtStart+t}},{key:"domFromPos",value:function(e){return{node:this.textDOM,offset:e}}},{key:"ignoreMutation",value:function(e){return"characterData"===e.type&&e.target.nodeValue==e.oldValue}}]),n}(ve),ge=function(e){s(n,e);var t=l(n);function n(e,r,o,i){var s;return h(this,n),(s=t.call(this,e,[],o,i)).mark=r,s}return p(n,[{key:"parseRule",value:function(){return 3&this.dirty||this.mark.type.spec.reparseInView?null:{mark:this.mark.type.name,attrs:this.mark.attrs,contentElement:this.contentDOM||void 0}}},{key:"matchesMark",value:function(e){return 3!=this.dirty&&this.mark.eq(e)}},{key:"markDirty",value:function(e,t){if(o(f(n.prototype),"markDirty",this).call(this,e,t),0!=this.dirty){for(var r=this.parent;!r.node;)r=r.parent;r.dirty<this.dirty&&(r.dirty=this.dirty),this.dirty=0}}},{key:"slice",value:function(e,t,r){var o=n.create(this.parent,this.mark,!0,r),i=this.children,s=this.size;t<s&&(i=ze(i,t,s,r)),e>0&&(i=ze(i,0,e,r));for(var a=0;a<i.length;a++)i[a].parent=o;return o.children=i,o}}],[{key:"create",value:function(e,t,r,o){var i=o.nodeViews[t.type.name],s=i&&i(t,o,r);return s&&s.dom||(s=m.DOMSerializer.renderSpec(document,t.type.spec.toDOM(t,r))),new n(e,t,s.dom,s.contentDOM||s.dom)}}]),n}(ve),ke=function(e){s(n,e);var t=l(n);function n(e,r,o,i,s,a,l,c,u){var f;return h(this,n),(f=t.call(this,e,[],s,a)).node=r,f.outerDeco=o,f.innerDeco=i,f.nodeDOM=l,a&&f.updateChildren(c,u),f}return p(n,[{key:"parseRule",value:function(){var e=this;if(this.node.type.spec.reparseInView)return null;var t={node:this.node.type.name,attrs:this.node.attrs};if("pre"==this.node.type.whitespace&&(t.preserveWhitespace="full"),this.contentDOM)if(this.contentLost){for(var n=this.children.length-1;n>=0;n--){var r=this.children[n];if(this.dom.contains(r.dom.parentNode)){t.contentElement=r.dom.parentNode;break}}t.contentElement||(t.getContent=function(){return m.Fragment.empty})}else t.contentElement=this.contentDOM;else t.getContent=function(){return e.node.content};return t}},{key:"matchesNode",value:function(e,t,n){return 0==this.dirty&&e.eq(this.node)&&Ae(t,this.outerDeco)&&n.eq(this.innerDeco)}},{key:"size",get:function(){return this.node.nodeSize}},{key:"border",get:function(){return this.node.isLeaf?0:1}},{key:"updateChildren",value:function(e,t){var n=this,r=this.node.inlineContent,o=t,i=e.composing?this.localCompositionInfo(e,t):null,s=i&&i.pos>-1?i:null,a=i&&i.pos<0,l=new Re(this,s&&s.node,e);!function(e,t,n,r){var o=t.locals(e),i=0;if(0!=o.length)for(var s=0,a=[],l=null,c=0;;){if(s<o.length&&o[s].to==i){for(var u=o[s++],f=void 0;s<o.length&&o[s].to==i;)(f||(f=[u])).push(o[s++]);if(f){f.sort(Ie);for(var h=0;h<f.length;h++)n(f[h],c,!!l)}else n(u,c,!!l)}var d=void 0,p=void 0;if(l)p=-1,d=l,l=null;else{if(!(c<e.childCount))break;p=c,d=e.child(c++)}for(var v=0;v<a.length;v++)a[v].to<=i&&a.splice(v--,1);for(;s<o.length&&o[s].from<=i&&o[s].to>i;)a.push(o[s++]);var m=i+d.nodeSize;if(d.isText){var y=m;s<o.length&&o[s].from<y&&(y=o[s].from);for(var g=0;g<a.length;g++)a[g].to<y&&(y=a[g].to);y<m&&(l=d.cut(y-i),d=d.cut(0,y-i),m=y,p=-1)}r(d,d.isInline&&!d.isLeaf?a.filter((function(e){return!e.inline})):a.slice(),t.forChild(i,d),p),i=m}else for(var k=0;k<e.childCount;k++){var w=e.child(k);r(w,o,t.forChild(i,w),k),i+=w.nodeSize}}(this.node,this.innerDeco,(function(t,i,s){t.spec.marks?l.syncToMarks(t.spec.marks,r,e):t.type.side>=0&&!s&&l.syncToMarks(i==n.node.childCount?m.Mark.none:n.node.child(i).marks,r,e),l.placeWidget(t,e,o)}),(function(t,n,s,c){var u;l.syncToMarks(t.marks,r,e),l.findNodeMatch(t,n,s,c)||a&&e.state.selection.from>o&&e.state.selection.to<o+t.nodeSize&&(u=l.findIndexWithChild(i.node))>-1&&l.updateNodeAt(t,n,s,u,e)||l.updateNextNode(t,n,s,e,c)||l.addNode(t,n,s,e,o),o+=t.nodeSize})),l.syncToMarks([],r,e),this.node.isTextblock&&l.addTextblockHacks(),l.destroyRest(),(l.changed||2==this.dirty)&&(s&&this.protectLocalComposition(e,s),Me(this.contentDOM,this.children,e),L&&function(e){if("UL"==e.nodeName||"OL"==e.nodeName){var t=e.style.cssText;e.style.cssText=t+"; list-style: square !important",window.getComputedStyle(e).listStyle,e.style.cssText=t}}(this.dom))}},{key:"localCompositionInfo",value:function(e,t){var n=e.state.selection,r=n.from,o=n.to;if(!(e.state.selection instanceof v.TextSelection)||r<t||o>t+this.node.content.size)return null;var i=e.domSelectionRange(),s=function(e,t){for(;;){if(3==e.nodeType)return e;if(1==e.nodeType&&t>0){if(e.childNodes.length>t&&3==e.childNodes[t].nodeType)return e.childNodes[t];t=O(e=e.childNodes[t-1])}else{if(!(1==e.nodeType&&t<e.childNodes.length))return null;e=e.childNodes[t],t=0}}}(i.focusNode,i.focusOffset);if(!s||!this.dom.contains(s.parentNode))return null;if(this.node.inlineContent){var a=s.nodeValue,l=function(e,t,n,r){for(var o=0,i=0;o<e.childCount&&i<=r;){var s=e.child(o++),a=i;if(i+=s.nodeSize,s.isText){for(var l=s.text;o<e.childCount;){var c=e.child(o++);if(i+=c.nodeSize,!c.isText)break;l+=c.text}if(i>=n){var u=a<r?l.lastIndexOf(t,r-a-1):-1;if(u>=0&&u+t.length+a>=n)return a+u;if(n==r&&l.length>=r+t.length-a&&l.slice(r-a,r-a+t.length)==t)return r}}}return-1}(this.node.content,a,r-t,o-t);return l<0?null:{node:s,pos:l,text:a}}return{node:s,pos:-1,text:""}}},{key:"protectLocalComposition",value:function(e,t){var n=t.node,r=t.pos,o=t.text;if(!this.getDesc(n)){for(var i=n;i.parentNode!=this.contentDOM;i=i.parentNode){for(;i.previousSibling;)i.parentNode.removeChild(i.previousSibling);for(;i.nextSibling;)i.parentNode.removeChild(i.nextSibling);i.pmViewDesc&&(i.pmViewDesc=void 0)}var s=new ye(this,i,n,o);e.input.compositionNodes.push(s),this.children=ze(this.children,r,r+o.length,e,s)}}},{key:"update",value:function(e,t,n,r){return!(3==this.dirty||!e.sameMarkup(this.node)||(this.updateInner(e,t,n,r),0))}},{key:"updateInner",value:function(e,t,n,r){this.updateOuterDeco(t),this.node=e,this.innerDeco=n,this.contentDOM&&this.updateChildren(r,this.posAtStart),this.dirty=0}},{key:"updateOuterDeco",value:function(e){if(!Ae(e,this.outerDeco)){var t=1!=this.nodeDOM.nodeType,n=this.dom;this.dom=Te(this.dom,this.nodeDOM,Ne(this.outerDeco,this.node,t),Ne(e,this.node,t)),this.dom!=n&&(n.pmViewDesc=void 0,this.dom.pmViewDesc=this),this.outerDeco=e}}},{key:"selectNode",value:function(){1==this.nodeDOM.nodeType&&this.nodeDOM.classList.add("ProseMirror-selectednode"),!this.contentDOM&&this.node.type.spec.draggable||(this.dom.draggable=!0)}},{key:"deselectNode",value:function(){1==this.nodeDOM.nodeType&&this.nodeDOM.classList.remove("ProseMirror-selectednode"),!this.contentDOM&&this.node.type.spec.draggable||this.dom.removeAttribute("draggable")}},{key:"domAtom",get:function(){return this.node.isAtom}}],[{key:"create",value:function(e,t,r,o,i,s){var a,l=i.nodeViews[t.type.name],c=l&&l(t,i,(function(){return a?a.parent?a.parent.posBeforeChild(a):void 0:s}),r,o),u=c&&c.dom,f=c&&c.contentDOM;if(t.isText)if(u){if(3!=u.nodeType)throw new RangeError("Text must be rendered as a DOM text node")}else u=document.createTextNode(t.text);else if(!u){var h=m.DOMSerializer.renderSpec(document,t.type.spec.toDOM(t));u=h.dom,f=h.contentDOM}f||t.isText||"BR"==u.nodeName||(u.hasAttribute("contenteditable")||(u.contentEditable="false"),t.type.spec.draggable&&(u.draggable=!0));var d=u;return u=Ee(u,r,t),c?a=new xe(e,t,r,o,u,f||null,d,c,i,s+1):t.isText?new be(e,t,r,o,u,d,i):new n(e,t,r,o,u,f||null,d,i,s+1)}}]),n}(ve);function we(e,t,n,r,o){return Ee(r,t,e),new ke(void 0,e,t,n,r,r,r,o,0)}var be=function(e){s(n,e);var t=l(n);function n(e,r,o,i,s,a,l){return h(this,n),t.call(this,e,r,o,i,s,null,a,l,0)}return p(n,[{key:"parseRule",value:function(){for(var e=this.nodeDOM.parentNode;e&&e!=this.dom&&!e.pmIsDeco;)e=e.parentNode;return{skip:e||!0}}},{key:"update",value:function(e,t,n,r){return!(3==this.dirty||0!=this.dirty&&!this.inParent()||!e.sameMarkup(this.node)||(this.updateOuterDeco(t),0==this.dirty&&e.text==this.node.text||e.text==this.nodeDOM.nodeValue||(this.nodeDOM.nodeValue=e.text,r.trackWrites==this.nodeDOM&&(r.trackWrites=null)),this.node=e,this.dirty=0,0))}},{key:"inParent",value:function(){for(var e=this.parent.contentDOM,t=this.nodeDOM;t;t=t.parentNode)if(t==e)return!0;return!1}},{key:"domFromPos",value:function(e){return{node:this.nodeDOM,offset:e}}},{key:"localPosFromDOM",value:function(e,t,r){return e==this.nodeDOM?this.posAtStart+Math.min(t,this.node.text.length):o(f(n.prototype),"localPosFromDOM",this).call(this,e,t,r)}},{key:"ignoreMutation",value:function(e){return"characterData"!=e.type&&"selection"!=e.type}},{key:"slice",value:function(e,t,r){var o=this.node.cut(e,t),i=document.createTextNode(o.text);return new n(this.parent,o,this.outerDeco,this.innerDeco,i,i,r)}},{key:"markDirty",value:function(e,t){o(f(n.prototype),"markDirty",this).call(this,e,t),this.dom==this.nodeDOM||0!=e&&t!=this.nodeDOM.nodeValue.length||(this.dirty=3)}},{key:"domAtom",get:function(){return!1}}]),n}(ke),Se=function(e){s(n,e);var t=l(n);function n(){return h(this,n),t.apply(this,arguments)}return p(n,[{key:"parseRule",value:function(){return{ignore:!0}}},{key:"matchesHack",value:function(e){return 0==this.dirty&&this.dom.nodeName==e}},{key:"domAtom",get:function(){return!0}},{key:"ignoreForCoords",get:function(){return"IMG"==this.dom.nodeName}}]),n}(ve),xe=function(e){s(n,e);var t=l(n);function n(e,r,o,i,s,a,l,c,u,f){var d;return h(this,n),(d=t.call(this,e,r,o,i,s,a,l,u,f)).spec=c,d}return p(n,[{key:"update",value:function(e,t,r,i){if(3==this.dirty)return!1;if(this.spec.update){var s=this.spec.update(e,t,r);return s&&this.updateInner(e,t,r,i),s}return!(!this.contentDOM&&!e.isLeaf)&&o(f(n.prototype),"update",this).call(this,e,t,r,i)}},{key:"selectNode",value:function(){this.spec.selectNode?this.spec.selectNode():o(f(n.prototype),"selectNode",this).call(this)}},{key:"deselectNode",value:function(){this.spec.deselectNode?this.spec.deselectNode():o(f(n.prototype),"deselectNode",this).call(this)}},{key:"setSelection",value:function(e,t,r,i){this.spec.setSelection?this.spec.setSelection(e,t,r):o(f(n.prototype),"setSelection",this).call(this,e,t,r,i)}},{key:"destroy",value:function(){this.spec.destroy&&this.spec.destroy(),o(f(n.prototype),"destroy",this).call(this)}},{key:"stopEvent",value:function(e){return!!this.spec.stopEvent&&this.spec.stopEvent(e)}},{key:"ignoreMutation",value:function(e){return this.spec.ignoreMutation?this.spec.ignoreMutation(e):o(f(n.prototype),"ignoreMutation",this).call(this,e)}}]),n}(ke);function Me(e,t,n){for(var r=e.firstChild,o=!1,i=0;i<t.length;i++){var s=t[i],a=s.dom;if(a.parentNode==e){for(;a!=r;)r=Pe(r),o=!0;r=r.nextSibling}else o=!0,e.insertBefore(a,r);if(s instanceof ge){var l=r?r.previousSibling:e.lastChild;Me(s.contentDOM,s.children,n),r=l?l.nextSibling:e.firstChild}}for(;r;)r=Pe(r),o=!0;o&&n.trackWrites==e&&(n.trackWrites=null)}var Oe=function(e){e&&(this.nodeName=e)};Oe.prototype=Object.create(null);var Ce=[new Oe];function Ne(e,t,n){if(0==e.length)return Ce;for(var r=n?Ce[0]:new Oe,o=[r],i=0;i<e.length;i++){var s=e[i].type.attrs;if(s)for(var a in s.nodeName&&o.push(r=new Oe(s.nodeName)),s){var l=s[a];null!=l&&(n&&1==o.length&&o.push(r=new Oe(t.isInline?"span":"div")),"class"==a?r.class=(r.class?r.class+" ":"")+l:"style"==a?r.style=(r.style?r.style+";":"")+l:"nodeName"!=a&&(r[a]=l))}}return o}function Te(e,t,n,r){if(n==Ce&&r==Ce)return t;for(var o=t,i=0;i<r.length;i++){var s=r[i],a=n[i];if(i){var l=void 0;a&&a.nodeName==s.nodeName&&o!=e&&(l=o.parentNode)&&l.nodeName.toLowerCase()==s.nodeName||((l=document.createElement(s.nodeName)).pmIsDeco=!0,l.appendChild(o),a=Ce[0]),o=l}De(o,a||Ce[0],s)}return o}function De(e,t,n){for(var r in t)"class"==r||"style"==r||"nodeName"==r||r in n||e.removeAttribute(r);for(var o in n)"class"!=o&&"style"!=o&&"nodeName"!=o&&n[o]!=t[o]&&e.setAttribute(o,n[o]);if(t.class!=n.class){for(var i=t.class?t.class.split(" ").filter(Boolean):[],s=n.class?n.class.split(" ").filter(Boolean):[],a=0;a<i.length;a++)-1==s.indexOf(i[a])&&e.classList.remove(i[a]);for(var l=0;l<s.length;l++)-1==i.indexOf(s[l])&&e.classList.add(s[l]);0==e.classList.length&&e.removeAttribute("class")}if(t.style!=n.style){if(t.style)for(var c,u=/\s*([\w\-\xa1-\uffff]+)\s*:(?:"(?:\\.|[^"])*"|'(?:\\.|[^'])*'|\(.*?\)|[^;])*/g;c=u.exec(t.style);)e.style.removeProperty(c[1]);n.style&&(e.style.cssText+=n.style)}}function Ee(e,t,n){return Te(e,e,Ce,Ne(t,n,1!=e.nodeType))}function Ae(e,t){if(e.length!=t.length)return!1;for(var n=0;n<e.length;n++)if(!e[n].type.eq(t[n].type))return!1;return!0}function Pe(e){var t=e.nextSibling;return e.parentNode.removeChild(e),t}var Re=function(){function e(t,n,r){h(this,e),this.lock=n,this.view=r,this.index=0,this.stack=[],this.changed=!1,this.top=t,this.preMatch=function(e,t){var n=t,r=n.children.length,o=e.childCount,i=new Map,s=[];e:for(;o>0;){for(var a=void 0;;)if(r){var l=n.children[r-1];if(!(l instanceof ge)){a=l,r--;break}n=l,r=l.children.length}else{if(n==t)break e;r=n.parent.children.indexOf(n),n=n.parent}var c=a.node;if(c){if(c!=e.child(o-1))break;--o,i.set(a,o),s.push(a)}}return{index:o,matched:i,matches:s.reverse()}}(t.node.content,t)}return p(e,[{key:"destroyBetween",value:function(e,t){if(e!=t){for(var n=e;n<t;n++)this.top.children[n].destroy();this.top.children.splice(e,t-e),this.changed=!0}}},{key:"destroyRest",value:function(){this.destroyBetween(this.index,this.top.children.length)}},{key:"syncToMarks",value:function(e,t,n){for(var r=0,o=this.stack.length>>1,i=Math.min(o,e.length);r<i&&(r==o-1?this.top:this.stack[r+1<<1]).matchesMark(e[r])&&!1!==e[r].type.spec.spanning;)r++;for(;r<o;)this.destroyRest(),this.top.dirty=0,this.index=this.stack.pop(),this.top=this.stack.pop(),o--;for(;o<e.length;){this.stack.push(this.top,this.index+1);for(var s=-1,a=this.index;a<Math.min(this.index+3,this.top.children.length);a++){var l=this.top.children[a];if(l.matchesMark(e[o])&&!this.isLocked(l.dom)){s=a;break}}if(s>-1)s>this.index&&(this.changed=!0,this.destroyBetween(this.index,s)),this.top=this.top.children[this.index];else{var c=ge.create(this.top,e[o],t,n);this.top.children.splice(this.index,0,c),this.top=c,this.changed=!0}this.index=0,o++}}},{key:"findNodeMatch",value:function(e,t,n,r){var o,i=-1;if(r>=this.preMatch.index&&(o=this.preMatch.matches[r-this.preMatch.index]).parent==this.top&&o.matchesNode(e,t,n))i=this.top.children.indexOf(o,this.index);else for(var s=this.index,a=Math.min(this.top.children.length,s+5);s<a;s++){var l=this.top.children[s];if(l.matchesNode(e,t,n)&&!this.preMatch.matched.has(l)){i=s;break}}return!(i<0||(this.destroyBetween(this.index,i),this.index++,0))}},{key:"updateNodeAt",value:function(e,t,n,r,o){var i=this.top.children[r];return 3==i.dirty&&i.dom==i.contentDOM&&(i.dirty=2),!!i.update(e,t,n,o)&&(this.destroyBetween(this.index,r),this.index++,!0)}},{key:"findIndexWithChild",value:function(e){for(;;){var t=e.parentNode;if(!t)return-1;if(t==this.top.contentDOM){var n=e.pmViewDesc;if(n)for(var r=this.index;r<this.top.children.length;r++)if(this.top.children[r]==n)return r;return-1}e=t}}},{key:"updateNextNode",value:function(e,t,n,r,o){for(var i=this.index;i<this.top.children.length;i++){var s=this.top.children[i];if(s instanceof ke){var a=this.preMatch.matched.get(s);if(null!=a&&a!=o)return!1;var l=s.dom;if((!this.isLocked(l)||e.isText&&s.node&&s.node.isText&&s.nodeDOM.nodeValue==e.text&&3!=s.dirty&&Ae(t,s.outerDeco))&&s.update(e,t,n,r))return this.destroyBetween(this.index,i),s.dom!=l&&(this.changed=!0),this.index++,!0;break}}return!1}},{key:"addNode",value:function(e,t,n,r,o){this.top.children.splice(this.index++,0,ke.create(this.top,e,t,n,r,o)),this.changed=!0}},{key:"placeWidget",value:function(e,t,n){var r=this.index<this.top.children.length?this.top.children[this.index]:null;if(!r||!r.matchesWidget(e)||e!=r.widget&&r.widget.type.toDOM.parentNode){var o=new me(this.top,e,t,n);this.top.children.splice(this.index++,0,o),this.changed=!0}else this.index++}},{key:"addTextblockHacks",value:function(){for(var e=this.top.children[this.index-1],t=this.top;e instanceof ge;)e=(t=e).children[t.children.length-1];(!e||!(e instanceof be)||/\n$/.test(e.node.text)||this.view.requiresGeckoHackNode&&/\s$/.test(e.node.text))&&((_||$)&&e&&"false"==e.dom.contentEditable&&this.addHackNode("IMG",t),this.addHackNode("BR",this.top))}},{key:"addHackNode",value:function(e,t){if(t==this.top&&this.index<t.children.length&&t.children[this.index].matchesHack(e))this.index++;else{var n=document.createElement(e);"IMG"==e&&(n.className="ProseMirror-separator",n.alt=""),"BR"==e&&(n.className="ProseMirror-trailingBreak");var r=new Se(this.top,[],n,null);t!=this.top?t.children.push(r):t.children.splice(this.index++,0,r),this.changed=!0}}},{key:"isLocked",value:function(e){return this.lock&&(e==this.lock||1==e.nodeType&&e.contains(this.lock.parentNode))}}]),e}();function Ie(e,t){return e.type.side-t.type.side}function ze(e,t,n,r,o){for(var i=[],s=0,a=0;s<e.length;s++){var l=e[s],c=a,u=a+=l.size;c>=n||u<=t?i.push(l):(c<t&&i.push(l.slice(0,t-c,r)),o&&(i.push(o),o=void 0),u>n&&i.push(l.slice(n-c,l.size,r)))}return i}function Fe(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,n=e.domSelectionRange(),r=e.state.doc;if(!n.focusNode)return null;var o=e.docView.nearestDesc(n.focusNode),i=o&&0==o.size,s=e.docView.posFromDOM(n.focusNode,n.focusOffset,1);if(s<0)return null;var a,l,c=r.resolve(s);if(T(n)){for(a=c;o&&!o.node;)o=o.parent;var u=o.node;if(o&&u.isAtom&&v.NodeSelection.isSelectable(u)&&o.parent&&(!u.isInline||!C(n.focusNode,n.focusOffset,o.dom))){var f=o.posBefore;l=new v.NodeSelection(s==f?c:r.resolve(f))}}else{var h=e.docView.posFromDOM(n.anchorNode,n.anchorOffset,1);if(h<0)return null;a=r.resolve(h)}if(!l){var d="pointer"==t||e.state.selection.head<c.pos&&!i?1:-1;l=He(e,a,c,d)}return l}function Be(e){return e.editable?e.hasFocus():Ge(e)&&document.activeElement&&document.activeElement.contains(e.dom)}function Ve(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],n=e.state.selection;if(We(e,n),Be(e)){if(!t&&e.input.mouseDown&&e.input.mouseDown.allowDefault&&$){var r=e.domSelectionRange(),o=e.domObserver.currentSelection;if(r.anchorNode&&o.anchorNode&&S(r.anchorNode,r.anchorOffset,o.anchorNode,o.anchorOffset))return e.input.mouseDown.delayedSelectionSync=!0,void e.domObserver.setCurSelection()}if(e.domObserver.disconnectSelection(),e.cursorWrapper)Je(e);else{var i,s,a=n.anchor,l=n.head;!je||n instanceof v.TextSelection||(n.$from.parent.inlineContent||(i=$e(e,n.from)),n.empty||n.$from.parent.inlineContent||(s=$e(e,n.to))),e.docView.setSelection(a,l,e.root,t),je&&(i&&_e(i),s&&_e(s)),n.visible?e.dom.classList.remove("ProseMirror-hideselection"):(e.dom.classList.add("ProseMirror-hideselection"),"onselectionchange"in document&&Le(e))}e.domObserver.setCurSelection(),e.domObserver.connectSelection()}}var je=_||$&&q<63;function $e(e,t){var n=e.docView.domFromPos(t,0),r=n.node,o=n.offset,i=o<r.childNodes.length?r.childNodes[o]:null,s=o?r.childNodes[o-1]:null;if(_&&i&&"false"==i.contentEditable)return qe(i);if(!(i&&"false"!=i.contentEditable||s&&"false"!=s.contentEditable)){if(i)return qe(i);if(s)return qe(s)}}function qe(e){return e.contentEditable="true",_&&e.draggable&&(e.draggable=!1,e.wasDraggable=!0),e}function _e(e){e.contentEditable="false",e.wasDraggable&&(e.draggable=!0,e.wasDraggable=null)}function Le(e){var t=e.dom.ownerDocument;t.removeEventListener("selectionchange",e.input.hideSelectionGuard);var n=e.domSelectionRange(),r=n.anchorNode,o=n.anchorOffset;t.addEventListener("selectionchange",e.input.hideSelectionGuard=function(){n.anchorNode==r&&n.anchorOffset==o||(t.removeEventListener("selectionchange",e.input.hideSelectionGuard),setTimeout((function(){Be(e)&&!e.state.selection.visible||e.dom.classList.remove("ProseMirror-hideselection")}),20))})}function Je(e){var t=e.domSelection(),n=document.createRange(),r=e.cursorWrapper.dom,o="IMG"==r.nodeName;o?n.setEnd(r.parentNode,g(r)+1):n.setEnd(r,0),n.collapse(!1),t.removeAllRanges(),t.addRange(n),!o&&!e.state.selection.visible&&F&&B<=11&&(r.disabled=!0,r.disabled=!1)}function We(e,t){if(t instanceof v.NodeSelection){var n=e.docView.descAt(t.from);n!=e.lastSelectedViewDesc&&(Ke(e),n&&n.selectNode(),e.lastSelectedViewDesc=n)}else Ke(e)}function Ke(e){e.lastSelectedViewDesc&&(e.lastSelectedViewDesc.parent&&e.lastSelectedViewDesc.deselectNode(),e.lastSelectedViewDesc=void 0)}function He(e,t,n,r){return e.someProp("createSelectionBetween",(function(r){return r(e,t,n)}))||v.TextSelection.between(t,n,r)}function Ue(e){return!(e.editable&&!e.hasFocus())&&Ge(e)}function Ge(e){var t=e.domSelectionRange();if(!t.anchorNode)return!1;try{return e.dom.contains(3==t.anchorNode.nodeType?t.anchorNode.parentNode:t.anchorNode)&&(e.editable||e.dom.contains(3==t.focusNode.nodeType?t.focusNode.parentNode:t.focusNode))}catch(e){return!1}}function Ze(e,t){var n=e.selection,r=n.$anchor,o=n.$head,i=t>0?r.max(o):r.min(o),s=i.parent.inlineContent?i.depth?e.doc.resolve(t>0?i.after():i.before()):null:i;return s&&v.Selection.findFrom(s,t)}function Qe(e,t){return e.dispatch(e.state.tr.setSelection(t).scrollIntoView()),!0}function Xe(e,t,n){var r=e.state.selection;if(!(r instanceof v.TextSelection)){if(r instanceof v.NodeSelection&&r.node.isInline)return Qe(e,new v.TextSelection(t>0?r.$to:r.$from));var o=Ze(e.state,t);return!!o&&Qe(e,o)}if(!r.empty||n.indexOf("s")>-1)return!1;if(e.endOfTextblock(t>0?"right":"left")){var i=Ze(e.state,t);return!!(i&&i instanceof v.NodeSelection)&&Qe(e,i)}if(!(J&&n.indexOf("m")>-1)){var s,a=r.$head,l=a.textOffset?null:t<0?a.nodeBefore:a.nodeAfter;if(!l||l.isText)return!1;var c=t<0?a.pos-l.nodeSize:a.pos;return!!(l.isAtom||(s=e.docView.descAt(c))&&!s.contentDOM)&&(v.NodeSelection.isSelectable(l)?Qe(e,new v.NodeSelection(t<0?e.state.doc.resolve(a.pos-l.nodeSize):a)):!!K&&Qe(e,new v.TextSelection(e.state.doc.resolve(t<0?c:c+l.nodeSize))))}}function Ye(e){return 3==e.nodeType?e.nodeValue.length:e.childNodes.length}function et(e){var t=e.pmViewDesc;return t&&0==t.size&&(e.nextSibling||"BR"!=e.nodeName)}function tt(e){var t=e.domSelectionRange(),n=t.focusNode,r=t.focusOffset;if(n){var o,i,s=!1;for(V&&1==n.nodeType&&r<Ye(n)&&et(n.childNodes[r])&&(s=!0);;)if(r>0){if(1!=n.nodeType)break;var a=n.childNodes[r-1];if(et(a))o=n,i=--r;else{if(3!=a.nodeType)break;r=(n=a).nodeValue.length}}else{if(rt(n))break;for(var l=n.previousSibling;l&&et(l);)o=n.parentNode,i=g(l),l=l.previousSibling;if(l)r=Ye(n=l);else{if((n=n.parentNode)==e.dom)break;r=0}}s?ot(e,n,r):o&&ot(e,o,i)}}function nt(e){var t=e.domSelectionRange(),n=t.focusNode,r=t.focusOffset;if(n){for(var o,i,s=Ye(n);;)if(r<s){if(1!=n.nodeType)break;if(!et(n.childNodes[r]))break;o=n,i=++r}else{if(rt(n))break;for(var a=n.nextSibling;a&&et(a);)o=a.parentNode,i=g(a)+1,a=a.nextSibling;if(a)r=0,s=Ye(n=a);else{if((n=n.parentNode)==e.dom)break;r=s=0}}o&&ot(e,o,i)}}function rt(e){var t=e.pmViewDesc;return t&&t.node&&t.node.isBlock}function ot(e,t,n){var r=e.domSelection();if(T(r)){var o=document.createRange();o.setEnd(t,n),o.setStart(t,n),r.removeAllRanges(),r.addRange(o)}else r.extend&&r.extend(t,n);e.domObserver.setCurSelection();var i=e.state;setTimeout((function(){e.state==i&&Ve(e)}),50)}function it(e,t,n){var r=e.state.selection;if(r instanceof v.TextSelection&&!r.empty||n.indexOf("s")>-1)return!1;if(J&&n.indexOf("m")>-1)return!1;var o=r.$from,i=r.$to;if(!o.parent.inlineContent||e.endOfTextblock(t<0?"up":"down")){var s=Ze(e.state,t);if(s&&s instanceof v.NodeSelection)return Qe(e,s)}if(!o.parent.inlineContent){var a=t<0?o:i,l=r instanceof v.AllSelection?v.Selection.near(a,t):v.Selection.findFrom(a,t);return!!l&&Qe(e,l)}return!1}function st(e,t){if(!(e.state.selection instanceof v.TextSelection))return!0;var n=e.state.selection,r=n.$head,o=n.$anchor,i=n.empty;if(!r.sameParent(o))return!0;if(!i)return!1;if(e.endOfTextblock(t>0?"forward":"backward"))return!0;var s=!r.textOffset&&(t<0?r.nodeBefore:r.nodeAfter);if(s&&!s.isText){var a=e.state.tr;return t<0?a.delete(r.pos-s.nodeSize,r.pos):a.delete(r.pos,r.pos+s.nodeSize),e.dispatch(a),!0}return!1}function at(e,t,n){e.domObserver.stop(),t.contentEditable=n,e.domObserver.start()}function lt(e,t){e.someProp("transformCopied",(function(n){t=n(t,e)}));for(var n=[],r=t,o=r.content,i=r.openStart,s=r.openEnd;i>1&&s>1&&1==o.childCount&&1==o.firstChild.childCount;){i--,s--;var a=o.firstChild;n.push(a.type.name,a.attrs!=a.type.defaultAttrs?a.attrs:null),o=a.content}var l=e.someProp("clipboardSerializer")||m.DOMSerializer.fromSchema(e.state.schema),c=gt(),u=c.createElement("div");u.appendChild(l.serializeFragment(o,{document:c}));for(var f,h=u.firstChild,d=0;h&&1==h.nodeType&&(f=mt[h.nodeName.toLowerCase()]);){for(var p=f.length-1;p>=0;p--){for(var v=c.createElement(f[p]);u.firstChild;)v.appendChild(u.firstChild);u.appendChild(v),d++}h=u.firstChild}return h&&1==h.nodeType&&h.setAttribute("data-pm-slice","".concat(i," ").concat(s).concat(d?" -".concat(d):""," ").concat(JSON.stringify(n))),{dom:u,text:e.someProp("clipboardTextSerializer",(function(n){return n(t,e)}))||t.content.textBetween(0,t.content.size,"\n\n")}}function ct(e,t,n,o,i){var s,a,l=i.parent.type.spec.code;if(!n&&!t)return null;var c=t&&(o||l||!n);if(c){if(e.someProp("transformPastedText",(function(n){t=n(t,l||o,e)})),l)return t?new m.Slice(m.Fragment.from(e.state.schema.text(t.replace(/\r\n?/g,"\n"))),0,0):m.Slice.empty;var u=e.someProp("clipboardTextParser",(function(n){return n(t,i,o,e)}));if(u)a=u;else{var f=i.marks(),h=e.state.schema,d=m.DOMSerializer.fromSchema(h);s=document.createElement("div"),t.split(/(?:\r\n?|\n)+/).forEach((function(e){var t=s.appendChild(document.createElement("p"));e&&t.appendChild(d.serializeNode(h.text(e,f)))}))}}else e.someProp("transformPastedHTML",(function(t){n=t(n,e)})),s=function(e){var t=/^(\s*<meta [^>]*>)*/.exec(e);t&&(e=e.slice(t[0].length));var n,r=gt().createElement("div"),o=/<([a-z][^>\s]+)/i.exec(e);if((n=o&&mt[o[1].toLowerCase()])&&(e=n.map((function(e){return"<"+e+">"})).join("")+e+n.map((function(e){return"</"+e+">"})).reverse().join("")),r.innerHTML=e,n)for(var i=0;i<n.length;i++)r=r.querySelector(n[i])||r;return r}(n),K&&function(e){for(var t=e.querySelectorAll($?"span:not([class]):not([style])":"span.Apple-converted-space"),n=0;n<t.length;n++){var r=t[n];1==r.childNodes.length&&" "==r.textContent&&r.parentNode&&r.parentNode.replaceChild(e.ownerDocument.createTextNode(" "),r)}}(s);var p=s&&s.querySelector("[data-pm-slice]"),v=p&&/^(\d+) (\d+)(?: -(\d+))? (.*)/.exec(p.getAttribute("data-pm-slice")||"");if(v&&v[3])for(var y=+v[3];y>0;y--){for(var g=s.firstChild;g&&1!=g.nodeType;)g=g.nextSibling;if(!g)break;s=g}if(!a){var k=e.someProp("clipboardParser")||e.someProp("domParser")||m.DOMParser.fromSchema(e.state.schema);a=k.parseSlice(s,{preserveWhitespace:!(!c&&!v),context:i,ruleFromNode:function(e){return"BR"!=e.nodeName||e.nextSibling||!e.parentNode||ut.test(e.parentNode.nodeName)?null:{ignore:!0}}})}if(v)a=function(e,t){if(!e.size)return e;var n,r=e.content.firstChild.type.schema;try{n=JSON.parse(t)}catch(t){return e}for(var o=e.content,i=e.openStart,s=e.openEnd,a=n.length-2;a>=0;a-=2){var l=r.nodes[n[a]];if(!l||l.hasRequiredAttrs())break;o=m.Fragment.from(l.create(n[a+1],o)),i++,s++}return new m.Slice(o,i,s)}(vt(a,+v[1],+v[2]),v[4]);else if(a=m.Slice.maxOpen(function(e,t){if(e.childCount<2)return e;for(var n=function(n){var r=t.node(n).contentMatchAt(t.index(n)),o=void 0,i=[];if(e.forEach((function(e){if(i){var t,n=r.findWrapping(e.type);if(!n)return i=null;if(t=i.length&&o.length&&ht(n,o,e,i[i.length-1],0))i[i.length-1]=t;else{i.length&&(i[i.length-1]=dt(i[i.length-1],o.length));var s=ft(e,n);i.push(s),r=r.matchType(s.type),o=n}}})),i)return{v:m.Fragment.from(i)}},o=t.depth;o>=0;o--){var i=n(o);if("object"===r(i))return i.v}return e}(a.content,i),!0),a.openStart||a.openEnd){for(var w=0,b=0,S=a.content.firstChild;w<a.openStart&&!S.type.spec.isolating;w++,S=S.firstChild);for(var x=a.content.lastChild;b<a.openEnd&&!x.type.spec.isolating;b++,x=x.lastChild);a=vt(a,w,b)}return e.someProp("transformPasted",(function(t){a=t(a,e)})),a}var ut=/^(a|abbr|acronym|b|cite|code|del|em|i|ins|kbd|label|output|q|ruby|s|samp|span|strong|sub|sup|time|u|tt|var)$/i;function ft(e,t){for(var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,r=t.length-1;r>=n;r--)e=t[r].create(null,m.Fragment.from(e));return e}function ht(e,t,n,r,o){if(o<e.length&&o<t.length&&e[o]==t[o]){var i=ht(e,t,n,r.lastChild,o+1);if(i)return r.copy(r.content.replaceChild(r.childCount-1,i));if(r.contentMatchAt(r.childCount).matchType(o==e.length-1?n.type:e[o+1]))return r.copy(r.content.append(m.Fragment.from(ft(n,e,o+1))))}}function dt(e,t){if(0==t)return e;var n=e.content.replaceChild(e.childCount-1,dt(e.lastChild,t-1)),r=e.contentMatchAt(e.childCount).fillBefore(m.Fragment.empty,!0);return e.copy(n.append(r))}function pt(e,t,n,r,o,i){var s=t<0?e.firstChild:e.lastChild,a=s.content;return o<r-1&&(a=pt(a,t,n,r,o+1,i)),o>=n&&(a=t<0?s.contentMatchAt(0).fillBefore(a,e.childCount>1||i<=o).append(a):a.append(s.contentMatchAt(s.childCount).fillBefore(m.Fragment.empty,!0))),e.replaceChild(t<0?0:e.childCount-1,s.copy(a))}function vt(e,t,n){return t<e.openStart&&(e=new m.Slice(pt(e.content,-1,t,e.openStart,0,e.openEnd),t,e.openEnd)),n<e.openEnd&&(e=new m.Slice(pt(e.content,1,n,e.openEnd,0,0),e.openStart,n)),e}var mt={thead:["table"],tbody:["table"],tfoot:["table"],caption:["table"],colgroup:["table"],col:["table","colgroup"],tr:["table","tbody"],td:["table","tbody","tr"],th:["table","tbody","tr"]},yt=null;function gt(){return yt||(yt=document.implementation.createHTMLDocument("title"))}var kt={},wt={},bt={touchstart:!0,touchmove:!0},St=p((function e(){h(this,e),this.shiftKey=!1,this.mouseDown=null,this.lastKeyCode=null,this.lastKeyCodeTime=0,this.lastClick={time:0,x:0,y:0,type:""},this.lastSelectionOrigin=null,this.lastSelectionTime=0,this.lastIOSEnter=0,this.lastIOSEnterFallbackTimeout=-1,this.lastFocus=0,this.lastTouch=0,this.lastAndroidDelete=0,this.composing=!1,this.composingTimeout=-1,this.compositionNodes=[],this.compositionEndedAt=-2e8,this.domChangeCount=0,this.eventHandlers=Object.create(null),this.hideSelectionGuard=null}));function xt(e,t){e.input.lastSelectionOrigin=t,e.input.lastSelectionTime=Date.now()}function Mt(e){e.someProp("handleDOMEvents",(function(t){for(var n in t)e.input.eventHandlers[n]||e.dom.addEventListener(n,e.input.eventHandlers[n]=function(t){return Ot(e,t)})}))}function Ot(e,t){return e.someProp("handleDOMEvents",(function(n){var r=n[t.type];return!!r&&(r(e,t)||t.defaultPrevented)}))}function Ct(e){return{left:e.clientX,top:e.clientY}}function Nt(e,t,n,o,i){if(-1==o)return!1;for(var s=e.state.doc.resolve(o),a=function(r){if(e.someProp(t,(function(t){return r>s.depth?t(e,n,s.nodeAfter,s.before(r),i,!0):t(e,n,s.node(r),s.before(r),i,!1)})))return{v:!0}},l=s.depth+1;l>0;l--){var c=a(l);if("object"===r(c))return c.v}return!1}function Tt(e,t,n){e.focused||e.focus();var r=e.state.tr.setSelection(t);"pointer"==n&&r.setMeta("pointer",!0),e.dispatch(r)}function Dt(e,t,n,r){return Nt(e,"handleDoubleClickOn",t,n,r)||e.someProp("handleDoubleClick",(function(n){return n(e,t,r)}))}function Et(e,t,n,r){return Nt(e,"handleTripleClickOn",t,n,r)||e.someProp("handleTripleClick",(function(n){return n(e,t,r)}))||function(e,t,n){if(0!=n.button)return!1;var r=e.state.doc;if(-1==t)return!!r.inlineContent&&(Tt(e,v.TextSelection.create(r,0,r.content.size),"pointer"),!0);for(var o=r.resolve(t),i=o.depth+1;i>0;i--){var s=i>o.depth?o.nodeAfter:o.node(i),a=o.before(i);if(s.inlineContent)Tt(e,v.TextSelection.create(r,a+1,a+1+s.content.size),"pointer");else{if(!v.NodeSelection.isSelectable(s))continue;Tt(e,v.NodeSelection.create(r,a),"pointer")}return!0}}(e,n,r)}function At(e){return Vt(e)}wt.keydown=function(e,t){var n=t;if(e.input.shiftKey=16==n.keyCode||n.shiftKey,!It(e,n)&&(e.input.lastKeyCode=n.keyCode,e.input.lastKeyCodeTime=Date.now(),!W||!$||13!=n.keyCode))if(229!=n.keyCode&&e.domObserver.forceFlush(),!L||13!=n.keyCode||n.ctrlKey||n.altKey||n.metaKey)e.someProp("handleKeyDown",(function(t){return t(e,n)}))||function(e,t){var n=t.keyCode,r=function(e){var t="";return e.ctrlKey&&(t+="c"),e.metaKey&&(t+="m"),e.altKey&&(t+="a"),e.shiftKey&&(t+="s"),t}(t);return 8==n||J&&72==n&&"c"==r?st(e,-1)||tt(e):46==n||J&&68==n&&"c"==r?st(e,1)||nt(e):13==n||27==n||(37==n||J&&66==n&&"c"==r?Xe(e,-1,r)||tt(e):39==n||J&&70==n&&"c"==r?Xe(e,1,r)||nt(e):38==n||J&&80==n&&"c"==r?it(e,-1,r)||tt(e):40==n||J&&78==n&&"c"==r?function(e){if(!_||e.state.selection.$head.parentOffset>0)return!1;var t=e.domSelectionRange(),n=t.focusNode,r=t.focusOffset;if(n&&1==n.nodeType&&0==r&&n.firstChild&&"false"==n.firstChild.contentEditable){var o=n.firstChild;at(e,o,"true"),setTimeout((function(){return at(e,o,"false")}),20)}return!1}(e)||it(e,1,r)||nt(e):r==(J?"m":"c")&&(66==n||73==n||89==n||90==n))}(e,n)?n.preventDefault():xt(e,"key");else{var r=Date.now();e.input.lastIOSEnter=r,e.input.lastIOSEnterFallbackTimeout=setTimeout((function(){e.input.lastIOSEnter==r&&(e.someProp("handleKeyDown",(function(t){return t(e,D(13,"Enter"))})),e.input.lastIOSEnter=0)}),200)}},wt.keyup=function(e,t){16==t.keyCode&&(e.input.shiftKey=!1)},wt.keypress=function(e,t){var n=t;if(!(It(e,n)||!n.charCode||n.ctrlKey&&!n.altKey||J&&n.metaKey))if(e.someProp("handleKeyPress",(function(t){return t(e,n)})))n.preventDefault();else{var r=e.state.selection;if(!(r instanceof v.TextSelection&&r.$from.sameParent(r.$to))){var o=String.fromCharCode(n.charCode);/[\r\n]/.test(o)||e.someProp("handleTextInput",(function(t){return t(e,r.$from.pos,r.$to.pos,o)}))||e.dispatch(e.state.tr.insertText(o).scrollIntoView()),n.preventDefault()}}};var Pt=J?"metaKey":"ctrlKey";kt.mousedown=function(e,t){var n=t;e.input.shiftKey=n.shiftKey;var r=At(e),o=Date.now(),i="singleClick";o-e.input.lastClick.time<500&&function(e,t){var n=t.x-e.clientX,r=t.y-e.clientY;return n*n+r*r<100}(n,e.input.lastClick)&&!n[Pt]&&("singleClick"==e.input.lastClick.type?i="doubleClick":"doubleClick"==e.input.lastClick.type&&(i="tripleClick")),e.input.lastClick={time:o,x:n.clientX,y:n.clientY,type:i};var s=e.posAtCoords(Ct(n));s&&("singleClick"==i?(e.input.mouseDown&&e.input.mouseDown.done(),e.input.mouseDown=new Rt(e,s,n,!!r)):("doubleClick"==i?Dt:Et)(e,s.pos,s.inside,n)?n.preventDefault():xt(e,"pointer"))};var Rt=function(){function e(t,n,r,o){var i,s,a=this;if(h(this,e),this.view=t,this.pos=n,this.event=r,this.flushed=o,this.delayedSelectionSync=!1,this.mightDrag=null,this.startDoc=t.state.doc,this.selectNode=!!r[Pt],this.allowDefault=r.shiftKey,n.inside>-1)i=t.state.doc.nodeAt(n.inside),s=n.inside;else{var l=t.state.doc.resolve(n.pos);i=l.parent,s=l.depth?l.before():0}var c=o?null:r.target,u=c?t.docView.nearestDesc(c,!0):null;this.target=u?u.dom:null;var f=t.state.selection;(0==r.button&&i.type.spec.draggable&&!1!==i.type.spec.selectable||f instanceof v.NodeSelection&&f.from<=s&&f.to>s)&&(this.mightDrag={node:i,pos:s,addAttr:!(!this.target||this.target.draggable),setUneditable:!(!this.target||!V||this.target.hasAttribute("contentEditable"))}),this.target&&this.mightDrag&&(this.mightDrag.addAttr||this.mightDrag.setUneditable)&&(this.view.domObserver.stop(),this.mightDrag.addAttr&&(this.target.draggable=!0),this.mightDrag.setUneditable&&setTimeout((function(){a.view.input.mouseDown==a&&a.target.setAttribute("contentEditable","false")}),20),this.view.domObserver.start()),t.root.addEventListener("mouseup",this.up=this.up.bind(this)),t.root.addEventListener("mousemove",this.move=this.move.bind(this)),xt(t,"pointer")}return p(e,[{key:"done",value:function(){var e=this;this.view.root.removeEventListener("mouseup",this.up),this.view.root.removeEventListener("mousemove",this.move),this.mightDrag&&this.target&&(this.view.domObserver.stop(),this.mightDrag.addAttr&&this.target.removeAttribute("draggable"),this.mightDrag.setUneditable&&this.target.removeAttribute("contentEditable"),this.view.domObserver.start()),this.delayedSelectionSync&&setTimeout((function(){return Ve(e.view)})),this.view.input.mouseDown=null}},{key:"up",value:function(e){if(this.done(),this.view.dom.contains(e.target)){var t=this.pos;this.view.state.doc!=this.startDoc&&(t=this.view.posAtCoords(Ct(e))),this.updateAllowDefault(e),this.allowDefault||!t?xt(this.view,"pointer"):function(e,t,n,r,o){return Nt(e,"handleClickOn",t,n,r)||e.someProp("handleClick",(function(n){return n(e,t,r)}))||(o?function(e,t){if(-1==t)return!1;var n,r,o=e.state.selection;o instanceof v.NodeSelection&&(n=o.node);for(var i=e.state.doc.resolve(t),s=i.depth+1;s>0;s--){var a=s>i.depth?i.nodeAfter:i.node(s);if(v.NodeSelection.isSelectable(a)){r=n&&o.$from.depth>0&&s>=o.$from.depth&&i.before(o.$from.depth+1)==o.$from.pos?i.before(o.$from.depth):i.before(s);break}}return null!=r&&(Tt(e,v.NodeSelection.create(e.state.doc,r),"pointer"),!0)}(e,n):function(e,t){if(-1==t)return!1;var n=e.state.doc.resolve(t),r=n.nodeAfter;return!!(r&&r.isAtom&&v.NodeSelection.isSelectable(r))&&(Tt(e,new v.NodeSelection(n),"pointer"),!0)}(e,n))}(this.view,t.pos,t.inside,e,this.selectNode)?e.preventDefault():0==e.button&&(this.flushed||_&&this.mightDrag&&!this.mightDrag.node.isAtom||$&&!this.view.state.selection.visible&&Math.min(Math.abs(t.pos-this.view.state.selection.from),Math.abs(t.pos-this.view.state.selection.to))<=2)?(Tt(this.view,v.Selection.near(this.view.state.doc.resolve(t.pos)),"pointer"),e.preventDefault()):xt(this.view,"pointer")}}},{key:"move",value:function(e){this.updateAllowDefault(e),xt(this.view,"pointer"),0==e.buttons&&this.done()}},{key:"updateAllowDefault",value:function(e){!this.allowDefault&&(Math.abs(this.event.x-e.clientX)>4||Math.abs(this.event.y-e.clientY)>4)&&(this.allowDefault=!0)}}]),e}();function It(e,t){return!!e.composing||!!(_&&Math.abs(t.timeStamp-e.input.compositionEndedAt)<500)&&(e.input.compositionEndedAt=-2e8,!0)}kt.touchstart=function(e){e.input.lastTouch=Date.now(),At(e),xt(e,"pointer")},kt.touchmove=function(e){e.input.lastTouch=Date.now(),xt(e,"pointer")},kt.contextmenu=function(e){return At(e)};var zt=W?5e3:-1;function Ft(e,t){clearTimeout(e.input.composingTimeout),t>-1&&(e.input.composingTimeout=setTimeout((function(){return Vt(e)}),t))}function Bt(e){var t;for(e.composing&&(e.input.composing=!1,e.input.compositionEndedAt=((t=document.createEvent("Event")).initEvent("event",!0,!0),t.timeStamp));e.input.compositionNodes.length>0;)e.input.compositionNodes.pop().markParentsDirty()}function Vt(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];if(!(W&&e.domObserver.flushingSoon>=0)){if(e.domObserver.forceFlush(),Bt(e),t||e.docView&&e.docView.dirty){var n=Fe(e);return n&&!n.eq(e.state.selection)?e.dispatch(e.state.tr.setSelection(n)):e.updateState(e.state),!0}return!1}}wt.compositionstart=wt.compositionupdate=function(e){if(!e.composing){e.domObserver.flush();var t=e.state,n=t.selection.$from;if(t.selection.empty&&(t.storedMarks||!n.textOffset&&n.parentOffset&&n.nodeBefore.marks.some((function(e){return!1===e.type.spec.inclusive}))))e.markCursor=e.state.storedMarks||n.marks(),Vt(e,!0),e.markCursor=null;else if(Vt(e),V&&t.selection.empty&&n.parentOffset&&!n.textOffset&&n.nodeBefore.marks.length)for(var r=e.domSelectionRange(),o=r.focusNode,i=r.focusOffset;o&&1==o.nodeType&&0!=i;){var s=i<0?o.lastChild:o.childNodes[i-1];if(!s)break;if(3==s.nodeType){e.domSelection().collapse(s,s.nodeValue.length);break}o=s,i=-1}e.input.composing=!0}Ft(e,zt)},wt.compositionend=function(e,t){e.composing&&(e.input.composing=!1,e.input.compositionEndedAt=t.timeStamp,Ft(e,20))};var jt=F&&B<15||L&&H<604;function $t(e,t,n,r,o){var i=ct(e,t,n,r,e.state.selection.$from);if(e.someProp("handlePaste",(function(t){return t(e,o,i||m.Slice.empty)})))return!0;if(!i)return!1;var s=function(e){return 0==e.openStart&&0==e.openEnd&&1==e.content.childCount?e.content.firstChild:null}(i),a=s?e.state.tr.replaceSelectionWith(s,e.input.shiftKey):e.state.tr.replaceSelection(i);return e.dispatch(a.scrollIntoView().setMeta("paste",!0).setMeta("uiEvent","paste")),!0}kt.copy=wt.cut=function(e,t){var n=t,r=e.state.selection,o="cut"==n.type;if(!r.empty){var i=jt?null:n.clipboardData,s=lt(e,r.content()),a=s.dom,l=s.text;i?(n.preventDefault(),i.clearData(),i.setData("text/html",a.innerHTML),i.setData("text/plain",l)):function(e,t){if(e.dom.parentNode){var n=e.dom.parentNode.appendChild(document.createElement("div"));n.appendChild(t),n.style.cssText="position: fixed; left: -10000px; top: 10px";var r=getSelection(),o=document.createRange();o.selectNodeContents(t),e.dom.blur(),r.removeAllRanges(),r.addRange(o),setTimeout((function(){n.parentNode&&n.parentNode.removeChild(n),e.focus()}),50)}}(e,a),o&&e.dispatch(e.state.tr.deleteSelection().scrollIntoView().setMeta("uiEvent","cut"))}},wt.paste=function(e,t){var n=t;if(!e.composing||W){var r=jt?null:n.clipboardData;r&&$t(e,r.getData("text/plain"),r.getData("text/html"),e.input.shiftKey,n)?n.preventDefault():function(e,t){if(e.dom.parentNode){var n=e.input.shiftKey||e.state.selection.$from.parent.type.spec.code,r=e.dom.parentNode.appendChild(document.createElement(n?"textarea":"div"));n||(r.contentEditable="true"),r.style.cssText="position: fixed; left: -10000px; top: 10px",r.focus(),setTimeout((function(){e.focus(),r.parentNode&&r.parentNode.removeChild(r),n?$t(e,r.value,null,e.input.shiftKey,t):$t(e,r.textContent,r.innerHTML,e.input.shiftKey,t)}),50)}}(e,n)}};var qt=p((function e(t,n){h(this,e),this.slice=t,this.move=n})),_t=J?"altKey":"ctrlKey";for(var Lt in kt.dragstart=function(e,t){var n=t,r=e.input.mouseDown;if(r&&r.done(),n.dataTransfer){var o=e.state.selection,i=o.empty?null:e.posAtCoords(Ct(n));if(i&&i.pos>=o.from&&i.pos<=(o instanceof v.NodeSelection?o.to-1:o.to));else if(r&&r.mightDrag)e.dispatch(e.state.tr.setSelection(v.NodeSelection.create(e.state.doc,r.mightDrag.pos)));else if(n.target&&1==n.target.nodeType){var s=e.docView.nearestDesc(n.target,!0);s&&s.node.type.spec.draggable&&s!=e.docView&&e.dispatch(e.state.tr.setSelection(v.NodeSelection.create(e.state.doc,s.posBefore)))}var a=e.state.selection.content(),l=lt(e,a),c=l.dom,u=l.text;n.dataTransfer.clearData(),n.dataTransfer.setData(jt?"Text":"text/html",c.innerHTML),n.dataTransfer.effectAllowed="copyMove",jt||n.dataTransfer.setData("text/plain",u),e.dragging=new qt(a,!n[_t])}},kt.dragend=function(e){var t=e.dragging;window.setTimeout((function(){e.dragging==t&&(e.dragging=null)}),50)},wt.dragover=wt.dragenter=function(e,t){return t.preventDefault()},wt.drop=function(e,t){var n=t,r=e.dragging;if(e.dragging=null,n.dataTransfer){var o=e.posAtCoords(Ct(n));if(o){var i=e.state.doc.resolve(o.pos),s=r&&r.slice;s?e.someProp("transformPasted",(function(t){s=t(s,e)})):s=ct(e,n.dataTransfer.getData(jt?"Text":"text/plain"),jt?null:n.dataTransfer.getData("text/html"),!1,i);var a=!(!r||n[_t]);if(e.someProp("handleDrop",(function(t){return t(e,n,s||m.Slice.empty,a)})))n.preventDefault();else if(s){n.preventDefault();var l=s?y.dropPoint(e.state.doc,i.pos,s):i.pos;null==l&&(l=i.pos);var c=e.state.tr;a&&c.deleteSelection();var u=c.mapping.map(l),f=0==s.openStart&&0==s.openEnd&&1==s.content.childCount,h=c.doc;if(f?c.replaceRangeWith(u,u,s.content.firstChild):c.replaceRange(u,u,s),!c.doc.eq(h)){var d=c.doc.resolve(u);if(f&&v.NodeSelection.isSelectable(s.content.firstChild)&&d.nodeAfter&&d.nodeAfter.sameMarkup(s.content.firstChild))c.setSelection(new v.NodeSelection(d));else{var p=c.mapping.map(l);c.mapping.maps[c.mapping.maps.length-1].forEach((function(e,t,n,r){return p=r})),c.setSelection(He(e,d,c.doc.resolve(p)))}e.focus(),e.dispatch(c.setMeta("uiEvent","drop"))}}}}},kt.focus=function(e){e.input.lastFocus=Date.now(),e.focused||(e.domObserver.stop(),e.dom.classList.add("ProseMirror-focused"),e.domObserver.start(),e.focused=!0,setTimeout((function(){e.docView&&e.hasFocus()&&!e.domObserver.currentSelection.eq(e.domSelectionRange())&&Ve(e)}),20))},kt.blur=function(e,t){var n=t;e.focused&&(e.domObserver.stop(),e.dom.classList.remove("ProseMirror-focused"),e.domObserver.start(),n.relatedTarget&&e.dom.contains(n.relatedTarget)&&e.domObserver.currentSelection.clear(),e.focused=!1)},kt.beforeinput=function(e,t){if($&&W&&"deleteContentBackward"==t.inputType){e.domObserver.flushSoon();var n=e.input.domChangeCount;setTimeout((function(){if(e.input.domChangeCount==n&&(e.dom.blur(),e.focus(),!e.someProp("handleKeyDown",(function(t){return t(e,D(8,"Backspace"))})))){var t=e.state.selection.$cursor;t&&t.pos>0&&e.dispatch(e.state.tr.delete(t.pos-1,t.pos).scrollIntoView())}}),50)}},wt)kt[Lt]=wt[Lt];function Jt(e,t){if(e==t)return!0;for(var n in e)if(e[n]!==t[n])return!1;for(var r in t)if(!(r in e))return!1;return!0}var Wt=function(){function e(t,n){h(this,e),this.toDOM=t,this.spec=n||Zt,this.side=this.spec.side||0}return p(e,[{key:"map",value:function(e,t,n,r){var o=e.mapResult(t.from+r,this.side<0?-1:1),i=o.pos;return o.deleted?null:new Ut(i-n,i-n,this)}},{key:"valid",value:function(){return!0}},{key:"eq",value:function(t){return this==t||t instanceof e&&(this.spec.key&&this.spec.key==t.spec.key||this.toDOM==t.toDOM&&Jt(this.spec,t.spec))}},{key:"destroy",value:function(e){this.spec.destroy&&this.spec.destroy(e)}}]),e}(),Kt=function(){function e(t,n){h(this,e),this.attrs=t,this.spec=n||Zt}return p(e,[{key:"map",value:function(e,t,n,r){var o=e.map(t.from+r,this.spec.inclusiveStart?-1:1)-n,i=e.map(t.to+r,this.spec.inclusiveEnd?1:-1)-n;return o>=i?null:new Ut(o,i,this)}},{key:"valid",value:function(e,t){return t.from<t.to}},{key:"eq",value:function(t){return this==t||t instanceof e&&Jt(this.attrs,t.attrs)&&Jt(this.spec,t.spec)}},{key:"destroy",value:function(){}}],[{key:"is",value:function(t){return t.type instanceof e}}]),e}(),Ht=function(){function e(t,n){h(this,e),this.attrs=t,this.spec=n||Zt}return p(e,[{key:"map",value:function(e,t,n,r){var o=e.mapResult(t.from+r,1);if(o.deleted)return null;var i=e.mapResult(t.to+r,-1);return i.deleted||i.pos<=o.pos?null:new Ut(o.pos-n,i.pos-n,this)}},{key:"valid",value:function(e,t){var n,r=e.content.findIndex(t.from),o=r.index,i=r.offset;return i==t.from&&!(n=e.child(o)).isText&&i+n.nodeSize==t.to}},{key:"eq",value:function(t){return this==t||t instanceof e&&Jt(this.attrs,t.attrs)&&Jt(this.spec,t.spec)}},{key:"destroy",value:function(){}}]),e}(),Ut=function(){function e(t,n,r){h(this,e),this.from=t,this.to=n,this.type=r}return p(e,[{key:"copy",value:function(t,n){return new e(t,n,this.type)}},{key:"eq",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;return this.type.eq(e.type)&&this.from+t==e.from&&this.to+t==e.to}},{key:"map",value:function(e,t,n){return this.type.map(e,this,t,n)}},{key:"spec",get:function(){return this.type.spec}},{key:"inline",get:function(){return this.type instanceof Kt}}],[{key:"widget",value:function(t,n,r){return new e(t,t,new Wt(n,r))}},{key:"inline",value:function(t,n,r,o){return new e(t,n,new Kt(r,o))}},{key:"node",value:function(t,n,r,o){return new e(t,n,new Ht(r,o))}}]),e}(),Gt=[],Zt={},Qt=function(){function e(t,n){h(this,e),this.local=t.length?t:Gt,this.children=n.length?n:Gt}return p(e,[{key:"find",value:function(e,t,n){var r=[];return this.findInner(null==e?0:e,null==t?1e9:t,r,0,n),r}},{key:"findInner",value:function(e,t,n,r,o){for(var i=0;i<this.local.length;i++){var s=this.local[i];s.from<=t&&s.to>=e&&(!o||o(s.spec))&&n.push(s.copy(s.from+r,s.to+r))}for(var a=0;a<this.children.length;a+=3)if(this.children[a]<t&&this.children[a+1]>e){var l=this.children[a]+1;this.children[a+2].findInner(e-l,t-l,n,r+l,o)}}},{key:"map",value:function(e,t,n){return this==Xt||0==e.maps.length?this:this.mapInner(e,t,0,0,n||Zt)}},{key:"mapInner",value:function(t,n,r,o,i){for(var s,a=0;a<this.local.length;a++){var l=this.local[a].map(t,r,o);l&&l.type.valid(n,l)?(s||(s=[])).push(l):i.onRemove&&i.onRemove(this.local[a].spec)}return this.children.length?en(this.children,s||[],t,n,r,o,i):s?new e(s.sort(sn),Gt):Xt}},{key:"add",value:function(t,n){return n.length?this==Xt?e.create(t,n):this.addInner(t,n,0):this}},{key:"addInner",value:function(t,n,r){var o,i=this,s=0;t.forEach((function(e,t){var a,l=t+r;if(a=nn(n,e,l)){for(o||(o=i.children.slice());s<o.length&&o[s]<t;)s+=3;o[s]==t?o[s+2]=o[s+2].addInner(e,a,l+1):o.splice(s,0,t,t+e.nodeSize,on(a,e,l+1,Zt)),s+=3}}));for(var a=tn(s?rn(n):n,-r),l=0;l<a.length;l++)a[l].type.valid(t,a[l])||a.splice(l--,1);return new e(a.length?this.local.concat(a).sort(sn):this.local,o||this.children)}},{key:"remove",value:function(e){return 0==e.length||this==Xt?this:this.removeInner(e,0)}},{key:"removeInner",value:function(t,n){for(var r=this.children,o=this.local,i=0;i<r.length;i+=3){for(var s,a=void 0,l=r[i]+n,c=r[i+1]+n,u=0;u<t.length;u++)(s=t[u])&&s.from>l&&s.to<c&&(t[u]=null,(a||(a=[])).push(s));if(a){r==this.children&&(r=this.children.slice());var f=r[i+2].removeInner(a,l+1);f!=Xt?r[i+2]=f:(r.splice(i,3),i-=3)}}if(o.length)for(var h,d=0;d<t.length;d++)if(h=t[d])for(var p=0;p<o.length;p++)o[p].eq(h,n)&&(o==this.local&&(o=this.local.slice()),o.splice(p--,1));return r==this.children&&o==this.local?this:o.length||r.length?new e(o,r):Xt}},{key:"forChild",value:function(t,n){if(this==Xt)return this;if(n.isLeaf)return e.empty;for(var r,o,i=0;i<this.children.length;i+=3)if(this.children[i]>=t){this.children[i]==t&&(r=this.children[i+2]);break}for(var s=t+1,a=s+n.content.size,l=0;l<this.local.length;l++){var c=this.local[l];if(c.from<a&&c.to>s&&c.type instanceof Kt){var u=Math.max(s,c.from)-s,f=Math.min(a,c.to)-s;u<f&&(o||(o=[])).push(c.copy(u,f))}}if(o){var h=new e(o.sort(sn),Gt);return r?new Yt([h,r]):h}return r||Xt}},{key:"eq",value:function(t){if(this==t)return!0;if(!(t instanceof e)||this.local.length!=t.local.length||this.children.length!=t.children.length)return!1;for(var n=0;n<this.local.length;n++)if(!this.local[n].eq(t.local[n]))return!1;for(var r=0;r<this.children.length;r+=3)if(this.children[r]!=t.children[r]||this.children[r+1]!=t.children[r+1]||!this.children[r+2].eq(t.children[r+2]))return!1;return!0}},{key:"locals",value:function(e){return an(this.localsInner(e))}},{key:"localsInner",value:function(e){if(this==Xt)return Gt;if(e.inlineContent||!this.local.some(Kt.is))return this.local;for(var t=[],n=0;n<this.local.length;n++)this.local[n].type instanceof Kt||t.push(this.local[n]);return t}}],[{key:"create",value:function(e,t){return t.length?on(t,e,0,Zt):Xt}}]),e}();Qt.empty=new Qt([],[]),Qt.removeOverlap=an;var Xt=Qt.empty,Yt=function(){function e(t){h(this,e),this.members=t}return p(e,[{key:"map",value:function(t,n){var r=this.members.map((function(e){return e.map(t,n,Zt)}));return e.from(r)}},{key:"forChild",value:function(t,n){if(n.isLeaf)return Qt.empty;for(var r=[],o=0;o<this.members.length;o++){var i=this.members[o].forChild(t,n);i!=Xt&&(i instanceof e?r=r.concat(i.members):r.push(i))}return e.from(r)}},{key:"eq",value:function(t){if(!(t instanceof e)||t.members.length!=this.members.length)return!1;for(var n=0;n<this.members.length;n++)if(!this.members[n].eq(t.members[n]))return!1;return!0}},{key:"locals",value:function(e){for(var t,n=!0,r=0;r<this.members.length;r++){var o=this.members[r].localsInner(e);if(o.length)if(t){n&&(t=t.slice(),n=!1);for(var i=0;i<o.length;i++)t.push(o[i])}else t=o}return t?an(n?t:t.sort(sn)):Gt}}],[{key:"from",value:function(t){switch(t.length){case 0:return Xt;case 1:return t[0];default:return new e(t.every((function(e){return e instanceof Qt}))?t:t.reduce((function(e,t){return e.concat(t instanceof Qt?t:t.members)}),[]))}}}]),e}();function en(e,t,n,r,o,i,s){for(var a=e.slice(),l=function(e,t){var r=0;n.maps[e].forEach((function(e,n,i,s){for(var l=s-i-(n-e),c=0;c<a.length;c+=3){var u=a[c+1];if(!(u<0||e>u+t-r)){var f=a[c]+t-r;n>=f?a[c+1]=e<=f?-2:-1:i>=o&&l&&(a[c]+=l,a[c+1]+=l)}}r+=l})),t=n.maps[e].map(t,-1),u=t},c=0,u=i;c<n.maps.length;c++)l(c,u);for(var f=!1,h=0;h<a.length;h+=3)if(a[h+1]<0){if(-2==a[h+1]){f=!0,a[h+1]=-1;continue}var d=n.map(e[h]+i),p=d-o;if(p<0||p>=r.content.size){f=!0;continue}var v=n.map(e[h+1]+i,-1)-o,m=r.content.findIndex(p),y=m.index,g=m.offset,k=r.maybeChild(y);if(k&&g==p&&g+k.nodeSize==v){var w=a[h+2].mapInner(n,k,d+1,e[h]+i+1,s);w!=Xt?(a[h]=p,a[h+1]=v,a[h+2]=w):(a[h+1]=-2,f=!0)}else f=!0}if(f){var b=function(e,t,n,r,o,i,s){function a(e,t){for(var i=0;i<e.local.length;i++){var l=e.local[i].map(r,o,t);l?n.push(l):s.onRemove&&s.onRemove(e.local[i].spec)}for(var c=0;c<e.children.length;c+=3)a(e.children[c+2],e.children[c]+t+1)}for(var l=0;l<e.length;l+=3)-1==e[l+1]&&a(e[l+2],t[l]+i+1);return n}(a,e,t,n,o,i,s),S=on(b,r,0,s);t=S.local;for(var x=0;x<a.length;x+=3)a[x+1]<0&&(a.splice(x,3),x-=3);for(var M=0,O=0;M<S.children.length;M+=3){for(var C=S.children[M];O<a.length&&a[O]<C;)O+=3;a.splice(O,0,S.children[M],S.children[M+1],S.children[M+2])}}return new Qt(t.sort(sn),a)}function tn(e,t){if(!t||!e.length)return e;for(var n=[],r=0;r<e.length;r++){var o=e[r];n.push(new Ut(o.from+t,o.to+t,o.type))}return n}function nn(e,t,n){if(t.isLeaf)return null;for(var r,o=n+t.nodeSize,i=null,s=0;s<e.length;s++)(r=e[s])&&r.from>n&&r.to<o&&((i||(i=[])).push(r),e[s]=null);return i}function rn(e){for(var t=[],n=0;n<e.length;n++)null!=e[n]&&t.push(e[n]);return t}function on(e,t,n,r){var o=[],i=!1;t.forEach((function(t,s){var a=nn(e,t,s+n);if(a){i=!0;var l=on(a,t,n+s+1,r);l!=Xt&&o.push(s,s+t.nodeSize,l)}}));for(var s=tn(i?rn(e):e,-n).sort(sn),a=0;a<s.length;a++)s[a].type.valid(t,s[a])||(r.onRemove&&r.onRemove(s[a].spec),s.splice(a--,1));return s.length||o.length?new Qt(s,o):Xt}function sn(e,t){return e.from-t.from||e.to-t.to}function an(e){for(var t=e,n=0;n<t.length-1;n++){var r=t[n];if(r.from!=r.to)for(var o=n+1;o<t.length;o++){var i=t[o];if(i.from!=r.from){i.from<r.to&&(t==e&&(t=e.slice()),t[n]=r.copy(r.from,i.from),ln(t,o,r.copy(i.from,r.to)));break}i.to!=r.to&&(t==e&&(t=e.slice()),t[o]=i.copy(i.from,r.to),ln(t,o+1,i.copy(r.to,i.to)))}}return t}function ln(e,t,n){for(;t<e.length&&sn(n,e[t])>0;)t++;e.splice(t,0,n)}function cn(e){var t=[];return e.someProp("decorations",(function(n){var r=n(e.state);r&&r!=Xt&&t.push(r)})),e.cursorWrapper&&t.push(Qt.create(e.state.doc,[e.cursorWrapper.deco])),Yt.from(t)}var un={childList:!0,characterData:!0,characterDataOldValue:!0,attributes:!0,attributeOldValue:!0,subtree:!0},fn=F&&B<=11,hn=function(){function e(){h(this,e),this.anchorNode=null,this.anchorOffset=0,this.focusNode=null,this.focusOffset=0}return p(e,[{key:"set",value:function(e){this.anchorNode=e.anchorNode,this.anchorOffset=e.anchorOffset,this.focusNode=e.focusNode,this.focusOffset=e.focusOffset}},{key:"clear",value:function(){this.anchorNode=this.focusNode=null}},{key:"eq",value:function(e){return e.anchorNode==this.anchorNode&&e.anchorOffset==this.anchorOffset&&e.focusNode==this.focusNode&&e.focusOffset==this.focusOffset}}]),e}(),dn=function(){function e(t,n){var r=this;h(this,e),this.view=t,this.handleDOMChange=n,this.queue=[],this.flushingSoon=-1,this.observer=null,this.currentSelection=new hn,this.onCharData=null,this.suppressingSelectionUpdates=!1,this.observer=window.MutationObserver&&new window.MutationObserver((function(e){for(var t=0;t<e.length;t++)r.queue.push(e[t]);F&&B<=11&&e.some((function(e){return"childList"==e.type&&e.removedNodes.length||"characterData"==e.type&&e.oldValue.length>e.target.nodeValue.length}))?r.flushSoon():r.flush()})),fn&&(this.onCharData=function(e){r.queue.push({target:e.target,type:"characterData",oldValue:e.prevValue}),r.flushSoon()}),this.onSelectionChange=this.onSelectionChange.bind(this)}return p(e,[{key:"flushSoon",value:function(){var e=this;this.flushingSoon<0&&(this.flushingSoon=window.setTimeout((function(){e.flushingSoon=-1,e.flush()}),20))}},{key:"forceFlush",value:function(){this.flushingSoon>-1&&(window.clearTimeout(this.flushingSoon),this.flushingSoon=-1,this.flush())}},{key:"start",value:function(){this.observer&&(this.observer.takeRecords(),this.observer.observe(this.view.dom,un)),this.onCharData&&this.view.dom.addEventListener("DOMCharacterDataModified",this.onCharData),this.connectSelection()}},{key:"stop",value:function(){var e=this;if(this.observer){var t=this.observer.takeRecords();if(t.length){for(var n=0;n<t.length;n++)this.queue.push(t[n]);window.setTimeout((function(){return e.flush()}),20)}this.observer.disconnect()}this.onCharData&&this.view.dom.removeEventListener("DOMCharacterDataModified",this.onCharData),this.disconnectSelection()}},{key:"connectSelection",value:function(){this.view.dom.ownerDocument.addEventListener("selectionchange",this.onSelectionChange)}},{key:"disconnectSelection",value:function(){this.view.dom.ownerDocument.removeEventListener("selectionchange",this.onSelectionChange)}},{key:"suppressSelectionUpdates",value:function(){var e=this;this.suppressingSelectionUpdates=!0,setTimeout((function(){return e.suppressingSelectionUpdates=!1}),50)}},{key:"onSelectionChange",value:function(){if(Ue(this.view)){if(this.suppressingSelectionUpdates)return Ve(this.view);if(F&&B<=11&&!this.view.state.selection.empty){var e=this.view.domSelectionRange();if(e.focusNode&&S(e.focusNode,e.focusOffset,e.anchorNode,e.anchorOffset))return this.flushSoon()}this.flush()}}},{key:"setCurSelection",value:function(){this.currentSelection.set(this.view.domSelectionRange())}},{key:"ignoreSelectionChange",value:function(e){if(!e.focusNode)return!0;for(var t,n=new Set,r=e.focusNode;r;r=k(r))n.add(r);for(var o=e.anchorNode;o;o=k(o))if(n.has(o)){t=o;break}var i=t&&this.view.docView.nearestDesc(t);return i&&i.ignoreMutation({type:"selection",target:3==t.nodeType?t.parentNode:t})?(this.setCurSelection(),!0):void 0}},{key:"flush",value:function(){var e=this.view;if(e.docView&&!(this.flushingSoon>-1)){var t=this.observer?this.observer.takeRecords():[];this.queue.length&&(t=this.queue.concat(t),this.queue.length=0);var n=e.domSelectionRange(),r=!this.suppressingSelectionUpdates&&!this.currentSelection.eq(n)&&Ue(e)&&!this.ignoreSelectionChange(n),o=-1,i=-1,s=!1,a=[];if(e.editable)for(var l=0;l<t.length;l++){var c=this.registerMutation(t[l],a);c&&(o=o<0?c.from:Math.min(c.from,o),i=i<0?c.to:Math.max(c.to,i),c.typeOver&&(s=!0))}if(V&&a.length>1){var u=a.filter((function(e){return"BR"==e.nodeName}));if(2==u.length){var f=u[0],h=u[1];f.parentNode&&f.parentNode.parentNode==h.parentNode?h.remove():f.remove()}}var d=null;o<0&&r&&e.input.lastFocus>Date.now()-200&&e.input.lastTouch<Date.now()-300&&T(n)&&(d=Fe(e))&&d.eq(v.Selection.near(e.state.doc.resolve(0),1))?(e.input.lastFocus=0,Ve(e),this.currentSelection.set(n),e.scrollToSelection()):(o>-1||r)&&(o>-1&&(e.docView.markDirty(o,i),function(e){if(!pn.has(e)&&(pn.set(e,null),-1!==["normal","nowrap","pre-line"].indexOf(getComputedStyle(e.dom).whiteSpace))){if(e.requiresGeckoHackNode=V,vn)return;console.warn("ProseMirror expects the CSS white-space property to be set, preferably to 'pre-wrap'. It is recommended to load style/prosemirror.css from the prosemirror-view package."),vn=!0}}(e)),this.handleDOMChange(o,i,s,a),e.docView&&e.docView.dirty?e.updateState(e.state):this.currentSelection.eq(n)||Ve(e),this.currentSelection.set(n))}}},{key:"registerMutation",value:function(e,t){if(t.indexOf(e.target)>-1)return null;var n=this.view.docView.nearestDesc(e.target);if("attributes"==e.type&&(n==this.view.docView||"contenteditable"==e.attributeName||"style"==e.attributeName&&!e.oldValue&&!e.target.getAttribute("style")))return null;if(!n||n.ignoreMutation(e))return null;if("childList"==e.type){for(var r=0;r<e.addedNodes.length;r++)t.push(e.addedNodes[r]);if(n.contentDOM&&n.contentDOM!=n.dom&&!n.contentDOM.contains(e.target))return{from:n.posBefore,to:n.posAfter};var o=e.previousSibling,i=e.nextSibling;if(F&&B<=11&&e.addedNodes.length)for(var s=0;s<e.addedNodes.length;s++){var a=e.addedNodes[s],l=a.previousSibling,c=a.nextSibling;(!l||Array.prototype.indexOf.call(e.addedNodes,l)<0)&&(o=l),(!c||Array.prototype.indexOf.call(e.addedNodes,c)<0)&&(i=c)}var u=o&&o.parentNode==e.target?g(o)+1:0,f=n.localPosFromDOM(e.target,u,-1),h=i&&i.parentNode==e.target?g(i):e.target.childNodes.length;return{from:f,to:n.localPosFromDOM(e.target,h,1)}}return"attributes"==e.type?{from:n.posAtStart-n.border,to:n.posAtEnd+n.border}:{from:n.posAtStart,to:n.posAtEnd,typeOver:e.target.nodeValue==e.oldValue}}}]),e}(),pn=new WeakMap,vn=!1;function mn(e){var t=e.pmViewDesc;if(t)return t.parseRule();if("BR"==e.nodeName&&e.parentNode){if(_&&/^(ul|ol)$/i.test(e.parentNode.nodeName)){var n=document.createElement("div");return n.appendChild(document.createElement("li")),{skip:n}}if(e.parentNode.lastChild==e||_&&/^(tr|table)$/i.test(e.parentNode.nodeName))return{ignore:!0}}else if("IMG"==e.nodeName&&e.getAttribute("mark-placeholder"))return{ignore:!0};return null}function yn(e,t,n){return Math.max(n.anchor,n.head)>t.content.size?null:He(e,t.resolve(n.anchor),t.resolve(n.head))}function gn(e,t,n){for(var r=e.depth,o=t?e.end():e.pos;r>0&&(t||e.indexAfter(r)==e.node(r).childCount);)r--,o++,t=!1;if(n)for(var i=e.node(r).maybeChild(e.indexAfter(r));i&&!i.isLeaf;)i=i.firstChild,o++;return o}var kn=lt,wn=ct,bn=Vt,Sn=function(){function e(t,n){var r=this;h(this,e),this._root=null,this.focused=!1,this.trackWrites=null,this.mounted=!1,this.markCursor=null,this.cursorWrapper=null,this.lastSelectedViewDesc=void 0,this.input=new St,this.prevDirectPlugins=[],this.pluginViews=[],this.requiresGeckoHackNode=!1,this.dragging=null,this._props=n,this.state=n.state,this.directPlugins=n.plugins||[],this.directPlugins.forEach(Nn),this.dispatch=this.dispatch.bind(this),this.dom=t&&t.mount||document.createElement("div"),t&&(t.appendChild?t.appendChild(this.dom):"function"==typeof t?t(this.dom):t.mount&&(this.mounted=!0)),this.editable=On(this),Mn(this),this.nodeViews=Cn(this),this.docView=we(this.state.doc,xn(this),cn(this),this.dom,this),this.domObserver=new dn(this,(function(e,t,n,o){return function(e,t,n,r,o){if(t<0){var i=e.input.lastSelectionTime>Date.now()-50?e.input.lastSelectionOrigin:null,s=Fe(e,i);if(s&&!e.state.selection.eq(s)){if($&&W&&13===e.input.lastKeyCode&&Date.now()-100<e.input.lastKeyCodeTime&&e.someProp("handleKeyDown",(function(t){return t(e,D(13,"Enter"))})))return;var a=e.state.tr.setSelection(s);"pointer"==i?a.setMeta("pointer",!0):"key"==i&&a.scrollIntoView(),e.dispatch(a)}}else{var l=e.state.doc.resolve(t),c=l.sharedDepth(n);t=l.before(c+1),n=e.state.doc.resolve(n).after(c+1);var u,f,h=e.state.selection,d=function(e,t,n){var r,o=e.docView.parseRange(t,n),i=o.node,s=o.fromOffset,a=o.toOffset,l=o.from,c=o.to,u=e.domSelectionRange(),f=u.anchorNode;if(f&&e.dom.contains(1==f.nodeType?f:f.parentNode)&&(r=[{node:f,offset:u.anchorOffset}],T(u)||r.push({node:u.focusNode,offset:u.focusOffset})),$&&8===e.input.lastKeyCode)for(var h=a;h>s;h--){var d=i.childNodes[h-1],p=d.pmViewDesc;if("BR"==d.nodeName&&!p){a=h;break}if(!p||p.size)break}var v=e.state.doc,y=e.someProp("domParser")||m.DOMParser.fromSchema(e.state.schema),g=v.resolve(l),k=null,w=y.parse(i,{topNode:g.parent,topMatch:g.parent.contentMatchAt(g.index()),topOpen:!0,from:s,to:a,preserveWhitespace:"pre"!=g.parent.type.whitespace||"full",findPositions:r,ruleFromNode:mn,context:g});if(r&&null!=r[0].pos){var b=r[0].pos,S=r[1]&&r[1].pos;null==S&&(S=b),k={anchor:b+l,head:S+l}}return{doc:w,sel:k,from:l,to:c}}(e,t,n),p=e.state.doc,y=p.slice(d.from,d.to);8===e.input.lastKeyCode&&Date.now()-100<e.input.lastKeyCodeTime?(u=e.state.selection.to,f="end"):(u=e.state.selection.from,f="start"),e.input.lastKeyCode=null;var g=function(e,t,n,r,o){var i=e.findDiffStart(t,n);if(null==i)return null;var s=e.findDiffEnd(t,n+e.size,n+t.size),a=s.a,l=s.b;return"end"==o&&(r-=a+Math.max(0,i-Math.min(a,l))-i),a<i&&e.size<t.size?(l=(i-=r<=i&&r>=a?i-r:0)+(l-a),a=i):l<i&&(a=(i-=r<=i&&r>=l?i-r:0)+(a-l),l=i),{start:i,endA:a,endB:l}}(y.content,d.doc.content,d.from,u,f);if((L&&e.input.lastIOSEnter>Date.now()-225||W)&&o.some((function(e){return"DIV"==e.nodeName||"P"==e.nodeName||"LI"==e.nodeName}))&&(!g||g.endA>=g.endB)&&e.someProp("handleKeyDown",(function(t){return t(e,D(13,"Enter"))})))e.input.lastIOSEnter=0;else{if(!g){if(!(r&&h instanceof v.TextSelection&&!h.empty&&h.$head.sameParent(h.$anchor))||e.composing||d.sel&&d.sel.anchor!=d.sel.head){if(d.sel){var k=yn(e,e.state.doc,d.sel);k&&!k.eq(e.state.selection)&&e.dispatch(e.state.tr.setSelection(k))}return}g={start:h.from,endA:h.to,endB:h.to}}if($&&e.cursorWrapper&&d.sel&&d.sel.anchor==e.cursorWrapper.deco.from&&d.sel.head==d.sel.anchor){var w=g.endB-g.start;d.sel={anchor:d.sel.anchor+w,head:d.sel.anchor+w}}e.input.domChangeCount++,e.state.selection.from<e.state.selection.to&&g.start==g.endB&&e.state.selection instanceof v.TextSelection&&(g.start>e.state.selection.from&&g.start<=e.state.selection.from+2&&e.state.selection.from>=d.from?g.start=e.state.selection.from:g.endA<e.state.selection.to&&g.endA>=e.state.selection.to-2&&e.state.selection.to<=d.to&&(g.endB+=e.state.selection.to-g.endA,g.endA=e.state.selection.to)),F&&B<=11&&g.endB==g.start+1&&g.endA==g.start&&g.start>d.from&&"  "==d.doc.textBetween(g.start-d.from-1,g.start-d.from+1)&&(g.start--,g.endA--,g.endB--);var b,S=d.doc.resolveNoCache(g.start-d.from),x=d.doc.resolveNoCache(g.endB-d.from),M=p.resolve(g.start),O=S.sameParent(x)&&S.parent.inlineContent&&M.end()>=g.endA;if((L&&e.input.lastIOSEnter>Date.now()-225&&(!O||o.some((function(e){return"DIV"==e.nodeName||"P"==e.nodeName})))||!O&&S.pos<d.doc.content.size&&(b=v.Selection.findFrom(d.doc.resolve(S.pos+1),1,!0))&&b.head==x.pos)&&e.someProp("handleKeyDown",(function(t){return t(e,D(13,"Enter"))})))e.input.lastIOSEnter=0;else if(e.state.selection.anchor>g.start&&function(e,t,n,r,o){if(!r.parent.isTextblock||n-t<=o.pos-r.pos||gn(r,!0,!1)<o.pos)return!1;var i=e.resolve(t);if(i.parentOffset<i.parent.content.size||!i.parent.isTextblock)return!1;var s=e.resolve(gn(i,!0,!0));return!(!s.parent.isTextblock||s.pos>n||gn(s,!0,!1)<n)&&r.parent.content.cut(r.parentOffset).eq(s.parent.content)}(p,g.start,g.endA,S,x)&&e.someProp("handleKeyDown",(function(t){return t(e,D(8,"Backspace"))})))W&&$&&e.domObserver.suppressSelectionUpdates();else{$&&W&&g.endB==g.start&&(e.input.lastAndroidDelete=Date.now()),W&&!O&&S.start()!=x.start()&&0==x.parentOffset&&S.depth==x.depth&&d.sel&&d.sel.anchor==d.sel.head&&d.sel.head==g.endA&&(g.endB-=2,x=d.doc.resolveNoCache(g.endB-d.from),setTimeout((function(){e.someProp("handleKeyDown",(function(t){return t(e,D(13,"Enter"))}))}),20));var C,N,E,A=g.start,P=g.endA;if(O)if(S.pos==x.pos)F&&B<=11&&0==S.parentOffset&&(e.domObserver.suppressSelectionUpdates(),setTimeout((function(){return Ve(e)}),20)),C=e.state.tr.delete(A,P),N=p.resolve(g.start).marksAcross(p.resolve(g.endA));else if(g.endA==g.endB&&(E=function(e,t){for(var n,r,o,i=e.firstChild.marks,s=t.firstChild.marks,a=i,l=s,c=0;c<s.length;c++)a=s[c].removeFromSet(a);for(var u=0;u<i.length;u++)l=i[u].removeFromSet(l);if(1==a.length&&0==l.length)r=a[0],n="add",o=function(e){return e.mark(r.addToSet(e.marks))};else{if(0!=a.length||1!=l.length)return null;r=l[0],n="remove",o=function(e){return e.mark(r.removeFromSet(e.marks))}}for(var f=[],h=0;h<t.childCount;h++)f.push(o(t.child(h)));if(m.Fragment.from(f).eq(e))return{mark:r,type:n}}(S.parent.content.cut(S.parentOffset,x.parentOffset),M.parent.content.cut(M.parentOffset,g.endA-M.start()))))C=e.state.tr,"add"==E.type?C.addMark(A,P,E.mark):C.removeMark(A,P,E.mark);else if(S.parent.child(S.index()).isText&&S.index()==x.index()-(x.textOffset?0:1)){var R=S.parent.textBetween(S.parentOffset,x.parentOffset);if(e.someProp("handleTextInput",(function(t){return t(e,A,P,R)})))return;C=e.state.tr.insertText(R,A,P)}if(C||(C=e.state.tr.replace(A,P,d.doc.slice(g.start-d.from,g.endB-d.from))),d.sel){var I=yn(e,C.doc,d.sel);I&&!($&&W&&e.composing&&I.empty&&(g.start!=g.endB||e.input.lastAndroidDelete<Date.now()-100)&&(I.head==A||I.head==C.mapping.map(P)-1)||F&&I.empty&&I.head==A)&&C.setSelection(I)}N&&C.ensureMarks(N),e.dispatch(C.scrollIntoView())}}}}(r,e,t,n,o)})),this.domObserver.start(),function(e){var t=function(t){var n=kt[t];e.dom.addEventListener(t,e.input.eventHandlers[t]=function(t){!function(e,t){if(!t.bubbles)return!0;if(t.defaultPrevented)return!1;for(var n=t.target;n!=e.dom;n=n.parentNode)if(!n||11==n.nodeType||n.pmViewDesc&&n.pmViewDesc.stopEvent(t))return!1;return!0}(e,t)||Ot(e,t)||!e.editable&&t.type in wt||n(e,t)},bt[t]?{passive:!0}:void 0)};for(var n in kt)t(n);_&&e.dom.addEventListener("input",(function(){return null})),Mt(e)}(this),this.updatePluginViews()}return p(e,[{key:"composing",get:function(){return this.input.composing}},{key:"props",get:function(){if(this._props.state!=this.state){var e=this._props;for(var t in this._props={},e)this._props[t]=e[t];this._props.state=this.state}return this._props}},{key:"update",value:function(e){e.handleDOMEvents!=this._props.handleDOMEvents&&Mt(this);var t=this._props;this._props=e,e.plugins&&(e.plugins.forEach(Nn),this.directPlugins=e.plugins),this.updateStateInner(e.state,t)}},{key:"setProps",value:function(e){var t={};for(var n in this._props)t[n]=this._props[n];for(var r in t.state=this.state,e)t[r]=e[r];this.update(t)}},{key:"updateState",value:function(e){this.updateStateInner(e,this._props)}},{key:"updateStateInner",value:function(e,t){var n=this.state,r=!1,o=!1;e.storedMarks&&this.composing&&(Bt(this),o=!0),this.state=e;var i=n.plugins!=e.plugins||this._props.plugins!=t.plugins;if(i||this._props.plugins!=t.plugins||this._props.nodeViews!=t.nodeViews){var s=Cn(this);(function(e,t){var n=0,r=0;for(var o in e){if(e[o]!=t[o])return!0;n++}for(var i in t)r++;return n!=r})(s,this.nodeViews)&&(this.nodeViews=s,r=!0)}(i||t.handleDOMEvents!=this._props.handleDOMEvents)&&Mt(this),this.editable=On(this),Mn(this);var a=cn(this),l=xn(this),c=n.plugins==e.plugins||n.doc.eq(e.doc)?e.scrollToSelection>n.scrollToSelection?"to selection":"preserve":"reset",u=r||!this.docView.matchesNode(e.doc,l,a);!u&&e.selection.eq(n.selection)||(o=!0);var f,h,d,p,v,m,y,g,k,w,b="preserve"==c&&o&&null==this.dom.style.overflowAnchor&&function(e){for(var t,n,r=e.dom.getBoundingClientRect(),o=Math.max(0,r.top),i=(r.left+r.right)/2,s=o+1;s<Math.min(innerHeight,r.bottom);s+=5){var a=e.root.elementFromPoint(i,s);if(a&&a!=e.dom&&e.dom.contains(a)){var l=a.getBoundingClientRect();if(l.top>=o-20){t=a,n=l.top;break}}}return{refDOM:t,refTop:n,stack:X(e.dom)}}(this);if(o){this.domObserver.stop();var x=u&&(F||$)&&!this.composing&&!n.selection.empty&&!e.selection.empty&&(p=n.selection,v=e.selection,m=Math.min(p.$anchor.sharedDepth(p.head),v.$anchor.sharedDepth(v.head)),p.$anchor.start(m)!=v.$anchor.start(m));if(u){var M=$?this.trackWrites=this.domSelectionRange().focusNode:null;!r&&this.docView.update(e.doc,l,a,this)||(this.docView.updateOuterDeco([]),this.docView.destroy(),this.docView=we(e.doc,l,a,this.dom,this)),M&&!this.trackWrites&&(x=!0)}x||!(this.input.mouseDown&&this.domObserver.currentSelection.eq(this.domSelectionRange())&&(f=this,h=f.docView.domFromPos(f.state.selection.anchor,0),d=f.domSelectionRange(),S(h.node,h.offset,d.anchorNode,d.anchorOffset)))?Ve(this,x):(We(this,e.selection),this.domObserver.setCurSelection()),this.domObserver.start()}this.updatePluginViews(n),"reset"==c?this.dom.scrollTop=0:"to selection"==c?this.scrollToSelection():b&&(g=(y=b).refDOM,k=y.refTop,Y(y.stack,0==(w=g?g.getBoundingClientRect().top:0)?0:w-k))}},{key:"scrollToSelection",value:function(){var e=this,t=this.domSelectionRange().focusNode;if(this.someProp("handleScrollToSelection",(function(t){return t(e)})));else if(this.state.selection instanceof v.NodeSelection){var n=this.docView.domAfterPos(this.state.selection.from);1==n.nodeType&&Q(this,n.getBoundingClientRect(),t)}else Q(this,this.coordsAtPos(this.state.selection.head,1),t)}},{key:"destroyPluginViews",value:function(){for(var e;e=this.pluginViews.pop();)e.destroy&&e.destroy()}},{key:"updatePluginViews",value:function(e){if(e&&e.plugins==this.state.plugins&&this.directPlugins==this.prevDirectPlugins)for(var t=0;t<this.pluginViews.length;t++){var n=this.pluginViews[t];n.update&&n.update(this,e)}else{this.prevDirectPlugins=this.directPlugins,this.destroyPluginViews();for(var r=0;r<this.directPlugins.length;r++){var o=this.directPlugins[r];o.spec.view&&this.pluginViews.push(o.spec.view(this))}for(var i=0;i<this.state.plugins.length;i++){var s=this.state.plugins[i];s.spec.view&&this.pluginViews.push(s.spec.view(this))}}}},{key:"someProp",value:function(e,t){var n,r=this._props&&this._props[e];if(null!=r&&(n=t?t(r):r))return n;for(var o=0;o<this.directPlugins.length;o++){var i=this.directPlugins[o].props[e];if(null!=i&&(n=t?t(i):i))return n}var s=this.state.plugins;if(s)for(var a=0;a<s.length;a++){var l=s[a].props[e];if(null!=l&&(n=t?t(l):l))return n}}},{key:"hasFocus",value:function(){if(F){var e=this.root.activeElement;if(e==this.dom)return!0;if(!e||!this.dom.contains(e))return!1;for(;e&&this.dom!=e&&this.dom.contains(e);){if("false"==e.contentEditable)return!1;e=e.parentElement}return!0}return this.root.activeElement==this.dom}},{key:"focus",value:function(){this.domObserver.stop(),this.editable&&function(e){if(e.setActive)return e.setActive();if(ee)return e.focus(ee);var t=X(e);e.focus(null==ee?{get preventScroll(){return ee={preventScroll:!0},!0}}:void 0),ee||(ee=!1,Y(t,0))}(this.dom),Ve(this),this.domObserver.start()}},{key:"root",get:function(){var e=this,t=this._root;if(null==t)for(var n=function(t){if(9==t.nodeType||11==t.nodeType&&t.host)return t.getSelection||(Object.getPrototypeOf(t).getSelection=function(){return t.ownerDocument.getSelection()}),{v:e._root=t}},o=this.dom.parentNode;o;o=o.parentNode){var i=n(o);if("object"===r(i))return i.v}return t||document}},{key:"posAtCoords",value:function(e){return oe(this,e)}},{key:"coordsAtPos",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1;return ae(this,e,t)}},{key:"domAtPos",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;return this.docView.domFromPos(e,t)}},{key:"nodeDOM",value:function(e){var t=this.docView.descAt(e);return t?t.nodeDOM:null}},{key:"posAtDOM",value:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:-1,r=this.docView.posFromDOM(e,t,n);if(null==r)throw new RangeError("DOM position not inside the editor");return r}},{key:"endOfTextblock",value:function(e,t){return function(e,t,n){return he==t&&de==n?pe:(he=t,de=n,pe="up"==n||"down"==n?function(e,t,n){var r=t.selection,o="up"==n?r.$from:r.$to;return ue(e,t,(function(){for(var t=e.docView.domFromPos(o.pos,"up"==n?-1:1).node;;){var r=e.docView.nearestDesc(t,!0);if(!r)break;if(r.node.isBlock){t=r.contentDOM||r.dom;break}t=r.dom.parentNode}for(var i=ae(e,o.pos,1),s=t.firstChild;s;s=s.nextSibling){var a=void 0;if(1==s.nodeType)a=s.getClientRects();else{if(3!=s.nodeType)continue;a=b(s,0,s.nodeValue.length).getClientRects()}for(var l=0;l<a.length;l++){var c=a[l];if(c.bottom>c.top+1&&("up"==n?i.top-c.top>2*(c.bottom-i.top):c.bottom-i.bottom>2*(i.bottom-c.top)))return!1}}return!0}))}(e,t,n):function(e,t,n){var r=t.selection.$head;if(!r.parent.isTextblock)return!1;var o=r.parentOffset,i=!o,s=o==r.parent.content.size,a=e.domSelection();return fe.test(r.parent.textContent)&&a.modify?ue(e,t,(function(){var t=e.domSelectionRange(),o=t.focusNode,i=t.focusOffset,s=t.anchorNode,l=t.anchorOffset,c=a.caretBidiLevel;a.modify("move",n,"character");var u=r.depth?e.docView.domAfterPos(r.before()):e.dom,f=e.domSelectionRange(),h=f.focusNode,d=f.focusOffset,p=h&&!u.contains(1==h.nodeType?h:h.parentNode)||o==h&&i==d;try{a.collapse(s,l),o&&(o!=s||i!=l)&&a.extend&&a.extend(o,i)}catch(e){}return null!=c&&(a.caretBidiLevel=c),p})):"left"==n||"backward"==n?i:s}(e,t,n))}(this,t||this.state,e)}},{key:"pasteHTML",value:function(e,t){return $t(this,"",e,!1,t||new ClipboardEvent("paste"))}},{key:"pasteText",value:function(e,t){return $t(this,e,null,!0,t||new ClipboardEvent("paste"))}},{key:"destroy",value:function(){this.docView&&(function(e){for(var t in e.domObserver.stop(),e.input.eventHandlers)e.dom.removeEventListener(t,e.input.eventHandlers[t]);clearTimeout(e.input.composingTimeout),clearTimeout(e.input.lastIOSEnterFallbackTimeout)}(this),this.destroyPluginViews(),this.mounted?(this.docView.update(this.state.doc,[],cn(this),this),this.dom.textContent=""):this.dom.parentNode&&this.dom.parentNode.removeChild(this.dom),this.docView.destroy(),this.docView=null)}},{key:"isDestroyed",get:function(){return null==this.docView}},{key:"dispatchEvent",value:function(e){return function(e,t){Ot(e,t)||!kt[t.type]||!e.editable&&t.type in wt||kt[t.type](e,t)}(this,e)}},{key:"dispatch",value:function(e){var t=this._props.dispatchTransaction;t?t.call(this,e):this.updateState(this.state.apply(e))}},{key:"domSelectionRange",value:function(){return _&&11===this.root.nodeType&&function(e){for(var t=e.activeElement;t&&t.shadowRoot;)t=t.shadowRoot.activeElement;return t}(this.dom.ownerDocument)==this.dom?function(e){var t;function n(e){e.preventDefault(),e.stopImmediatePropagation(),t=e.getTargetRanges()[0]}e.dom.addEventListener("beforeinput",n,!0),document.execCommand("indent"),e.dom.removeEventListener("beforeinput",n,!0);var r=t.startContainer,o=t.startOffset,i=t.endContainer,s=t.endOffset,a=e.domAtPos(e.state.selection.anchor);if(S(a.node,a.offset,i,s)){var l=[i,s,r,o];r=l[0],o=l[1],i=l[2],s=l[3]}return{anchorNode:r,anchorOffset:o,focusNode:i,focusOffset:s}}(this):this.domSelection()}},{key:"domSelection",value:function(){return this.root.getSelection()}}]),e}();function xn(e){var t=Object.create(null);return t.class="ProseMirror",t.contenteditable=String(e.editable),t.translate="no",e.someProp("attributes",(function(n){if("function"==typeof n&&(n=n(e.state)),n)for(var r in n)"class"==r&&(t.class+=" "+n[r]),"style"==r?t.style=(t.style?t.style+";":"")+n[r]:t[r]||"contenteditable"==r||"nodeName"==r||(t[r]=String(n[r]))})),[Ut.node(0,e.state.doc.content.size,t)]}function Mn(e){if(e.markCursor){var t=document.createElement("img");t.className="ProseMirror-separator",t.setAttribute("mark-placeholder","true"),t.setAttribute("alt",""),e.cursorWrapper={dom:t,deco:Ut.widget(e.state.selection.head,t,{raw:!0,marks:e.markCursor})}}else e.cursorWrapper=null}function On(e){return!e.someProp("editable",(function(t){return!1===t(e.state)}))}function Cn(e){var t=Object.create(null);function n(e){for(var n in e)Object.prototype.hasOwnProperty.call(t,n)||(t[n]=e[n])}return e.someProp("nodeViews",n),e.someProp("markViews",n),t}function Nn(e){if(e.spec.state||e.spec.filterTransaction||e.spec.appendTransaction)throw new RangeError("Plugins passed directly to the view must not have a state component")}t.Decoration=Ut,t.DecorationSet=Qt,t.EditorView=Sn,t.__endComposition=bn,t.__parseFromClipboard=wn,t.__serializeForClipboard=kn},691:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0});for(var n={8:"Backspace",9:"Tab",10:"Enter",12:"NumLock",13:"Enter",16:"Shift",17:"Control",18:"Alt",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",44:"PrintScreen",45:"Insert",46:"Delete",59:";",61:"=",91:"Meta",92:"Meta",106:"*",107:"+",108:",",109:"-",110:".",111:"/",144:"NumLock",145:"ScrollLock",160:"Shift",161:"Shift",162:"Control",163:"Control",164:"Alt",165:"Alt",173:"-",186:";",187:"=",188:",",189:"-",190:".",191:"/",192:"`",219:"[",220:"\\",221:"]",222:"'"},r={48:")",49:"!",50:"@",51:"#",52:"$",53:"%",54:"^",55:"&",56:"*",57:"(",59:":",61:"+",173:"_",186:":",187:"+",188:"<",189:"_",190:">",191:"?",192:"~",219:"{",220:"|",221:"}",222:'"'},o="undefined"!=typeof navigator&&/Chrome\/(\d+)/.exec(navigator.userAgent),i=("undefined"!=typeof navigator&&/Gecko\/\d+/.test(navigator.userAgent),"undefined"!=typeof navigator&&/Mac/.test(navigator.platform)),s="undefined"!=typeof navigator&&/MSIE \d|Trident\/(?:[7-9]|\d{2,})\..*rv:(\d+)/.exec(navigator.userAgent),a=i||o&&+o[1]<57,l=0;l<10;l++)n[48+l]=n[96+l]=String(l);for(l=1;l<=24;l++)n[l+111]="F"+l;for(l=65;l<=90;l++)n[l]=String.fromCharCode(l+32),r[l]=String.fromCharCode(l);for(var c in n)r.hasOwnProperty(c)||(r[c]=n[c]);t.base=n,t.keyName=function(e){var t=!(a&&(e.ctrlKey||e.altKey||e.metaKey)||s&&e.shiftKey&&e.key&&1==e.key.length||"Unidentified"==e.key)&&e.key||(e.shiftKey?r:n)[e.keyCode]||e.key||"Unidentified";return"Esc"==t&&(t="Escape"),"Del"==t&&(t="Delete"),"Left"==t&&(t="ArrowLeft"),"Up"==t&&(t="ArrowUp"),"Right"==t&&(t="ArrowRight"),"Down"==t&&(t="ArrowDown"),t},t.shift=r}},t={};function n(r){var o=t[r];if(void 0!==o)return o.exports;var i=t[r]={id:r,exports:{}};return e[r](i,i.exports,n),i.exports}n.n=e=>{var t=e&&e.__esModule?()=>e.default:()=>e;return n.d(t,{a:t}),t},n.d=(e,t)=>{for(var r in t)n.o(t,r)&&!n.o(e,r)&&Object.defineProperty(e,r,{enumerable:!0,get:t[r]})},n.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),n.r=e=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},n.nc=void 0,(()=>{var e=n(190),t=n(391),r=n(222),o=n(568);n(662),n(340),n(611);var i=t.EditorState.create({schema:e.schema,plugins:(0,o.exampleSetup)({schema:e.schema})});new r.EditorView(document.body,{state:i})})()})();